"use strict";exports.id=5373,exports.ids=[5373],exports.modules={5373:(e,t,r)=>{r.r(t),r.d(t,{fromHttp:()=>ie});var n=r(174),o=r(3585);const s=e=>encodeURIComponent(e).replace(/[!'()*]/g,i),i=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;var a=r(3685),c=r(5687);const f=["ECONNRESET","EPIPE","ETIMEDOUT"],u=e=>{const t={};for(const r of Object.keys(e)){const n=e[r];t[r]=Array.isArray(n)?n.join(","):n}return t},l=(e,t)=>setTimeout(e,t),h=e=>clearTimeout(e);var p=r(2781);class d{static create(e){return"function"==typeof e?.handle?e:new d(e)}static checkSocketUsage(e,t,r=console){const{sockets:n,requests:o,maxSockets:s}=e;if("number"!=typeof s||s===1/0)return t;if(Date.now()-15e3<t)return t;if(n&&o)for(const e in n){const t=n[e]?.length??0,i=o[e]?.length??0;if(t>=s&&i>=2*s)return r?.warn?.(`@smithy/node-http-handler:WARN - socket usage at capacity=${t} and ${i} additional requests are enqueued.\nSee https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/node-configuring-maxsockets.html\nor increase socketAcquisitionWarningTimeout=(millis) in the NodeHttpHandler config.`),Date.now()}return t}constructor(e){this.socketWarningTimestamp=0,this.metadata={handlerProtocol:"http/1.1"},this.configProvider=new Promise(((t,r)=>{"function"==typeof e?e().then((e=>{t(this.resolveDefaultConfig(e))})).catch(r):t(this.resolveDefaultConfig(e))}))}resolveDefaultConfig(e){const{requestTimeout:t,connectionTimeout:r,socketTimeout:n,socketAcquisitionWarningTimeout:o,httpAgent:s,httpsAgent:i}=e||{};return{connectionTimeout:r,requestTimeout:t??n,socketAcquisitionWarningTimeout:o,httpAgent:s instanceof a.Agent||"function"==typeof s?.destroy?s:new a.Agent({keepAlive:!0,maxSockets:50,...s}),httpsAgent:i instanceof c.Agent||"function"==typeof i?.destroy?i:new c.Agent({keepAlive:!0,maxSockets:50,...i}),logger:console}}destroy(){this.config?.httpAgent?.destroy(),this.config?.httpsAgent?.destroy()}async handle(e,{abortSignal:t}={}){return this.config||(this.config=await this.configProvider),new Promise(((r,n)=>{let i;const y=[],g=async e=>{await i,y.forEach(h),n(e)};if(!this.config)throw new Error("Node HTTP request handler config is not resolved");if(t?.aborted){const e=new Error("Request aborted");return e.name="AbortError",void g(e)}const m="https:"===e.protocol,b=m?this.config.httpsAgent:this.config.httpAgent;y.push(l((()=>{this.socketWarningTimestamp=d.checkSocketUsage(b,this.socketWarningTimestamp,this.config.logger)}),this.config.socketAcquisitionWarningTimeout??(this.config.requestTimeout??2e3)+(this.config.connectionTimeout??1e3)));const w=function(e){const t=[];for(let r of Object.keys(e).sort()){const n=e[r];if(r=s(r),Array.isArray(n))for(let e=0,o=n.length;e<o;e++)t.push(`${r}=${s(n[e])}`);else{let e=r;(n||"string"==typeof n)&&(e+=`=${s(n)}`),t.push(e)}}return t.join("&")}(e.query||{});let E;null==e.username&&null==e.password||(E=`${e.username??""}:${e.password??""}`);let T=e.path;w&&(T+=`?${w}`),e.fragment&&(T+=`#${e.fragment}`);let A=e.hostname??"";A="["===A[0]&&A.endsWith("]")?e.hostname.slice(1,-1):e.hostname;const S={headers:e.headers,host:A,method:e.method,path:T,port:e.port,agent:b,auth:E},v=(m?c.request:a.request)(S,(e=>{(async e=>{await i,y.forEach(h),r(e)})({response:new o.Zn({statusCode:e.statusCode||-1,reason:e.statusMessage,headers:u(e.headers),body:e})})}));if(v.on("error",(e=>{f.includes(e.code)?g(Object.assign(e,{name:"TimeoutError"})):g(e)})),t){const e=()=>{v.destroy();const e=new Error("Request aborted");e.name="AbortError",g(e)};if("function"==typeof t.addEventListener){const r=t;r.addEventListener("abort",e,{once:!0}),v.once("close",(()=>r.removeEventListener("abort",e)))}else t.onabort=e}y.push(((e,t,r=0)=>{if(!r)return-1;const n=n=>{const o=l((()=>{e.destroy(),t(Object.assign(new Error(`Socket timed out without establishing a connection within ${r} ms`),{name:"TimeoutError"}))}),r-n),s=e=>{e?.connecting?e.on("connect",(()=>{h(o)})):h(o)};e.socket?s(e.socket):e.on("socket",s)};return r<2e3?(n(0),0):l(n.bind(null,1e3),1e3)})(v,g,this.config.connectionTimeout)),y.push(((e,t,r=0)=>{const n=n=>{const o=r-n,s=()=>{e.destroy(),t(Object.assign(new Error(`Connection timed out after ${r} ms`),{name:"TimeoutError"}))};e.socket?(e.socket.setTimeout(o,s),e.on("close",(()=>e.socket?.removeListener("timeout",s)))):e.setTimeout(o,s)};return 0<r&&r<6e3?(n(0),0):l(n.bind(null,0===r?0:3e3),3e3)})(v,g,this.config.requestTimeout));const R=S.agent;"object"==typeof R&&"keepAlive"in R&&y.push(((e,{keepAlive:t,keepAliveMsecs:r},n=3e3)=>{if(!0!==t)return-1;const o=()=>{e.socket?e.socket.setKeepAlive(t,r||0):e.on("socket",(e=>{e.setKeepAlive(t,r||0)}))};return 0===n?(o(),0):l(o,n)})(v,{keepAlive:R.keepAlive,keepAliveMsecs:R.keepAliveMsecs})),i=async function(e,t,r=6e3){const n=t.headers??{},o=n.Expect||n.expect;let s=-1,i=!0;"100-continue"===o&&(i=await Promise.race([new Promise((e=>{s=Number(l((()=>e(!0)),Math.max(6e3,r)))})),new Promise((t=>{e.on("continue",(()=>{h(s),t(!0)})),e.on("response",(()=>{h(s),t(!1)})),e.on("error",(()=>{h(s),t(!1)}))}))])),i&&function(e,t){if(t instanceof p.Readable)t.pipe(e);else{if(t){if(Buffer.isBuffer(t)||"string"==typeof t)return void e.end(t);const r=t;return"object"==typeof r&&r.buffer&&"number"==typeof r.byteOffset&&"number"==typeof r.byteLength?void e.end(Buffer.from(r.buffer,r.byteOffset,r.byteLength)):void e.end(Buffer.from(t))}e.end()}}(e,t.body)}(v,e,this.config.requestTimeout).catch((e=>(y.forEach(h),n(e))))}))}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then((r=>({...r,[e]:t})))}httpHandlerConfigs(){return this.config??{}}}r(5158);class y{constructor(e){this.sessions=[],this.sessions=e??[]}poll(){if(this.sessions.length>0)return this.sessions.shift()}offerLast(e){this.sessions.push(e)}contains(e){return this.sessions.includes(e)}remove(e){this.sessions=this.sessions.filter((t=>t!==e))}[Symbol.iterator](){return this.sessions[Symbol.iterator]()}destroy(e){for(const t of this.sessions)t===e&&(t.destroyed||t.destroy())}}class g extends p.Writable{constructor(){super(...arguments),this.bufferedBytes=[]}_write(e,t,r){this.bufferedBytes.push(e),r()}}const m=e=>b(e)?async function(e){const t=[],r=e.getReader();let n=!1,o=0;for(;!n;){const{done:e,value:s}=await r.read();s&&(t.push(s),o+=s.length),n=e}const s=new Uint8Array(o);let i=0;for(const e of t)s.set(e,i),i+=e.length;return s}(e):new Promise(((t,r)=>{const n=new g;e.pipe(n),e.on("error",(e=>{n.end(),r(e)})),n.on("error",r),n.on("finish",(function(){const e=new Uint8Array(Buffer.concat(this.bufferedBytes));t(e)}))})),b=e=>"function"==typeof ReadableStream&&e instanceof ReadableStream;class w extends Error{constructor(e,t=!0){let r,n=!0;"boolean"==typeof t?(r=void 0,n=t):null!=t&&"object"==typeof t&&(r=t.logger,n=t.tryNextLink??!0),super(e),this.name="ProviderError",this.tryNextLink=n,Object.setPrototypeOf(this,w.prototype),r?.debug?.(`@smithy/property-provider ${n?"->":"(!)"} ${e}`)}static from(e,t=!0){return Object.assign(new this(e.message,t),e)}}class E extends w{constructor(e,t=!0){super(e,t),this.name="CredentialsProviderError",Object.setPrototypeOf(this,E.prototype)}}var T=r(3292),A=r.n(T),S=r(4300);const v=(e,t=0,r=e.byteLength-t)=>{if(n=e,!("function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(n)))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);var n;return S.Buffer.from(e,t,r)},R=(e,t)=>{if("string"!=typeof e)throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?S.Buffer.from(e,t):S.Buffer.from(e)},O=/^[A-Za-z0-9+/]*={0,2}$/;class k extends Uint8Array{static fromString(e,t="utf-8"){if("string"==typeof e)return transformFromString(e,t);throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,k.prototype),e}transformToString(e="utf-8"){return transformToString(this,e)}}"function"==typeof ReadableStream&&ReadableStream,r(4492);const C={},N={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),C[e]=t,N[t]=e}const I=e=>"function"==typeof ReadableStream&&(e?.constructor?.name===ReadableStream.name||e instanceof ReadableStream),$="The stream has already been transformed.",x=e=>"function"==typeof Blob&&e instanceof Blob,P="The stream has already been transformed.";var _,U,L,B,j,D,q,H;!function(e){e.HEADER="header",e.QUERY="query"}(_||(_={})),function(e){e.HEADER="header",e.QUERY="query"}(U||(U={})),function(e){e.HTTP="http",e.HTTPS="https"}(L||(L={})),(j=B||(B={})).MD5="md5",j.CRC32="crc32",j.CRC32C="crc32c",j.SHA1="sha1",j.SHA256="sha256",function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"}(D||(D={})),function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"}(q||(q={})),function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"}(H||(H={}));const W=Math.ceil(2**127*(2-2**-23)),F=(e,t)=>{const r=(e=>{if(null!=e){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}})(e);if(void 0!==r&&M(r,t)!==r)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return r},M=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},z=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,K=e=>{const t=e.match(z);if(null===t||t[0].length!==e.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(e)},J={warn:console.warn},Z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],V=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?[zZ]$/),Y=e=>{if(null==e)return;if("string"!=typeof e)throw new TypeError("RFC-3339 date-times must be expressed as strings");const t=V.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");const[r,n,o,s,i,a,c,f]=t,u=(e=>(e=>F(e,16))("string"==typeof e?K(e):e))(ne(n)),l=te(o,"month",1,12),h=te(s,"day",1,31);return Q(u,l,h,{hours:i,minutes:a,seconds:c,fractionalMilliseconds:f})},Q=(e,t,r,n)=>{const o=t-1;return X(e,o,r),new Date(Date.UTC(e,o,r,te(n.hours,"hour",0,23),te(n.minutes,"minute",0,59),te(n.seconds,"seconds",0,60),re(n.fractionalMilliseconds)))},G=[31,28,31,30,31,30,31,31,30,31,30,31],X=(e,t,r)=>{let n=G[t];if(1===t&&ee(e)&&(n=29),r>n)throw new TypeError(`Invalid day for ${Z[t]} in ${e}: ${r}`)},ee=e=>e%4==0&&(e%100!=0||e%400==0),te=(e,t,r,n)=>{const o=(e=>(e=>F(e,8))("string"==typeof e?K(e):e))(ne(e));if(o<r||o>n)throw new TypeError(`${t} must be between ${r} and ${n}, inclusive`);return o},re=e=>null==e?0:1e3*(e=>(e=>{const t=(e=>{if(null!=e){if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&J.warn((e=>String(new TypeError(e).stack||e).split("\n").slice(0,5).filter((e=>!e.includes("stackTraceWarning"))).join("\n"))(`Expected number but observed string: ${e}`)),t}if("number"==typeof e)return e;throw new TypeError(`Expected number, got ${typeof e}: ${e}`)}})(e);if(void 0!==t&&!Number.isNaN(t)&&t!==1/0&&t!==-1/0&&Math.abs(t)>W)throw new TypeError(`Expected 32-bit float, got ${e}`);return t})("string"==typeof e?K(e):e))("0."+e),ne=e=>{let t=0;for(;t<e.length-1&&"0"===e.charAt(t);)t++;return 0===t?e:e.slice(t)};class oe extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}static isInstance(e){if(!e)return!1;const t=e;return oe.prototype.isPrototypeOf(t)||Boolean(t.$fault)&&Boolean(t.$metadata)&&("client"===t.$fault||"server"===t.$fault)}static[Symbol.hasInstance](e){if(!e)return!1;const t=e;return this===oe?oe.isInstance(e):!!oe.isInstance(e)&&(t.name&&this.name?this.prototype.isPrototypeOf(e)||t.name===this.name:this.prototype.isPrototypeOf(e))}}const se=function(e){return Object.assign(new String(e),{deserializeJSON:()=>JSON.parse(String(e)),toString:()=>String(e),toJSON:()=>String(e)})};se.from=e=>e&&"object"==typeof e&&(e instanceof se||"deserializeJSON"in e)?e:"string"==typeof e||Object.getPrototypeOf(e)===String.prototype?se(String(e)):se(JSON.stringify(e)),se.fromObject=se.from;const ie=(e={})=>{let t;e.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");const r=e.awsContainerCredentialsRelativeUri??process.env.AWS_CONTAINER_CREDENTIALS_RELATIVE_URI,s=e.awsContainerCredentialsFullUri??process.env.AWS_CONTAINER_CREDENTIALS_FULL_URI,i=e.awsContainerAuthorizationToken??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN,a=e.awsContainerAuthorizationTokenFile??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE,c="NoOpLogger"!==e.logger?.constructor?.name&&e.logger?e.logger.warn:console.warn;if(r&&s&&(c("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),c("awsContainerCredentialsFullUri will take precedence.")),i&&a&&(c("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),c("awsContainerAuthorizationToken will take precedence.")),s)t=s;else{if(!r)throw new E("No HTTP credential provider host provided.\nSet AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.",{logger:e.logger});t=`http://169.254.170.2${r}`}const f=new URL(t);((e,t)=>{if("https:"!==e.protocol&&"169.254.170.2"!==e.hostname&&"169.254.170.23"!==e.hostname&&"[fd00:ec2::23]"!==e.hostname){if(e.hostname.includes("[")){if("[::1]"===e.hostname||"[0000:0000:0000:0000:0000:0000:0000:0001]"===e.hostname)return}else{if("localhost"===e.hostname)return;const t=e.hostname.split("."),r=e=>{const t=parseInt(e,10);return 0<=t&&t<=255};if("127"===t[0]&&r(t[1])&&r(t[2])&&r(t[3])&&4===t.length)return}throw new E("URL not accepted. It must either be HTTPS or match one of the following:\n  - loopback CIDR 127.0.0.0/8 or [::1/128]\n  - ECS container host 169.254.170.2\n  - EKS container host 169.254.170.23 or [fd00:ec2::23]",{logger:t})}})(f,e.logger);const u=new d({requestTimeout:e.timeout??1e3,connectionTimeout:e.timeout??1e3});return l=async()=>{const t=function(e){return new o.aW({protocol:e.protocol,hostname:e.hostname,port:Number(e.port),path:e.pathname,query:Array.from(e.searchParams.entries()).reduce(((e,[t,r])=>(e[t]=r,e)),{}),fragment:e.hash})}(f);i?t.headers.Authorization=i:a&&(t.headers.Authorization=(await A().readFile(a)).toString());try{return async function(e,t){const r=(e=>{if(!(e instanceof p.Readable))try{return(e=>{if(!x(e)&&!I(e))throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${e?.__proto__?.constructor?.name||e}`);let t=!1;const r=async()=>{if(t)throw new Error($);return t=!0,await(async e=>"function"==typeof Blob&&e instanceof Blob||"Blob"===e.constructor?.name?void 0!==Blob.prototype.arrayBuffer?new Uint8Array(await e.arrayBuffer()):async function(e){const t=await function(e){return new Promise(((t,r)=>{const n=new FileReader;n.onloadend=()=>{if(2!==n.readyState)return r(new Error("Reader aborted too early"));const e=n.result??"",o=e.indexOf(","),s=o>-1?o+1:e.length;t(e.substring(s))},n.onabort=()=>r(new Error("Read aborted")),n.onerror=()=>r(n.error),n.readAsDataURL(e)}))}(e),r=(e=>{if(3*e.length%4!=0)throw new TypeError("Incorrect padding on base64 string.");if(!O.exec(e))throw new TypeError("Invalid base64 string.");const t=R(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)})(t);return new Uint8Array(r)}(e):async function(e){const t=[],r=e.getReader();let n=!1,o=0;for(;!n;){const{done:e,value:s}=await r.read();s&&(t.push(s),o+=s.length),n=e}const s=new Uint8Array(o);let i=0;for(const e of t)s.set(e,i),i+=e.length;return s}(e))(e)};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{const t=await r();if("base64"===e)return(e=>{let t;if(t="string"==typeof e?(e=>{const t=R(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)})(e):e,"object"!=typeof t||"number"!=typeof t.byteOffset||"number"!=typeof t.byteLength)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");return v(t.buffer,t.byteOffset,t.byteLength).toString("base64")})(t);if("hex"===e)return function(e){let t="";for(let r=0;r<e.byteLength;r++)t+=C[e[r]];return t}(t);if(void 0===e||"utf8"===e||"utf-8"===e)return(e=>{if("string"==typeof e)return e;if("object"!=typeof e||"number"!=typeof e.byteOffset||"number"!=typeof e.byteLength)throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return v(e.buffer,e.byteOffset,e.byteLength).toString("utf8")})(t);if("function"==typeof TextDecoder)return new TextDecoder(e).decode(t);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(t)throw new Error($);if(t=!0,x(e))return(e=>{if("function"!=typeof e.stream)throw new Error("Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.\nIf you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body");return e.stream()})(e);if(I(e))return e;throw new Error(`Cannot transform payload to web stream, got ${e}`)}})})(e)}catch(t){throw new Error(`Unexpected stream implementation, expect Stream.Readable instance, got ${e?.__proto__?.constructor?.name||e}`)}let t=!1;const r=async()=>{if(t)throw new Error(P);return t=!0,await m(e)};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{const t=await r();return void 0===e||Buffer.isEncoding(e)?v(t.buffer,t.byteOffset,t.byteLength).toString(e):new TextDecoder(e).decode(t)},transformToWebStream:()=>{if(t)throw new Error(P);if(null!==e.readableFlowing)throw new Error("The stream has been consumed by other callbacks.");if("function"!=typeof p.Readable.toWeb)throw new Error("Readable.toWeb() is not supported. Please ensure a polyfill is available.");return t=!0,p.Readable.toWeb(e)}})})(e.body),n=await r.transformToString();if(200===e.statusCode){const e=JSON.parse(n);if("string"!=typeof e.AccessKeyId||"string"!=typeof e.SecretAccessKey||"string"!=typeof e.Token||"string"!=typeof e.Expiration)throw new E("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:t});return{accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:Y(e.Expiration)}}if(e.statusCode>=400&&e.statusCode<500){let r={};try{r=JSON.parse(n)}catch(e){}throw Object.assign(new E(`Server responded with status: ${e.statusCode}`,{logger:t}),{Code:r.Code,Message:r.Message})}throw new E(`Server responded with status: ${e.statusCode}`,{logger:t})}((await u.handle(t)).response).then((e=>(0,n.P)(e,"CREDENTIALS_HTTP","z")))}catch(t){throw new E(String(t),{logger:e.logger})}},h=e.maxRetries??3,y=e.timeout??1e3,async()=>{for(let e=0;e<h;++e)try{return await l()}catch(e){await new Promise((e=>setTimeout(e,y)))}return await l()};var l,h,y}}};