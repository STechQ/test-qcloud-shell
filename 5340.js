"use strict";(this.webpackChunkqcloud_shell=this.webpackChunkqcloud_shell||[]).push([[5340],{29300:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(51864),o=n.n(a),i=n(60352),s=n.n(i),r=n(35612),l=s()(o());l.i(r.Z),l.push([e.id,"\n.container[data-v-32b77fd6] {\n    padding: 32px 20px 20px;\n}\n","",{version:3,sources:["webpack://./src/presentation/vue3/components/dialogs/attachModuleToApp.vue"],names:[],mappings:";AA6GA;IACI,uBAAuB;AAC3B",sourcesContent:['<script setup lang="ts">\nimport { computed } from \'@vue/reactivity\';\nimport { ref } from \'vue\';\nimport { container } from \'../../../../domain/core/diContainer\';\nimport { ILocalization } from \'../../../../domain/infrastructure/ILocalization\';\nimport { IModule } from \'../../../../domain/model/models\';\nimport { IObjectUseCase } from \'../../../../domain/useCase/IObjectUseCase\';\nimport { IStudio } from \'../../../../domain/useCase/IStudio\';\nimport { IUseCaseExecutor } from \'../../../../domain/useCase/IUseCaseExecutor\';\nimport { IViewModel } from \'../../../../domain/viewModel/IViewModel\';\n\ninterface IExtendedModuleItem extends IModule {\n    relatedAppNames?: string;\n}\n\nconst viewModel = container.resolve<IViewModel>(IViewModel);\nconst executor = container.resolve<IUseCaseExecutor>(IUseCaseExecutor);\nconst localization = container.resolve<ILocalization>(ILocalization);\nconst objectUseCase = container.resolve<IObjectUseCase>(IObjectUseCase);\nconst studio = container.resolve<IStudio>(IStudio);\nconst emit = defineEmits(["close"]);\n\nconst tableData = ref<Array<IExtendedModuleItem>>([]);\nconst tableColumns = ref(["name", "description", "relatedAppNames", "createDate", "createdBy", "actions"]);\nconst tableOptions = ref({\n    filterable: true,\n    perPage: 5,\n    perPageValues: [],\n    headings: {\n        name: localization.get("moduleName"),\n        description: localization.get("description"),\n        relatedAppNames: localization.get("relatedApplications"),\n        createDate: localization.get("createDate"),\n        createdBy: localization.get("createdBy"),\n        actions: "",\n    },\n    sortIcon: {\n        base: \'mdi\',\n        is: \'mdi mdi-unfold-less-horizontal\',\n        up: \'mdi mdi-arrow-up\',\n        down: \'mdi mdi-arrow-down\'\n    },\n    texts: {\n        count: "",\n    },\n});\nconst dateOptions: any = { month: \'2-digit\', day: \'2-digit\', year: \'numeric\', hour: \'numeric\', minute: \'numeric\', second: \'numeric\' };\n\nfunction refreshTable(){\n    executor.execute(async () => {\n    const modules: Array<IExtendedModuleItem> = await objectUseCase.listModules();\n    const appsDict: Record<string, string> = {};\n    viewModel.apps.forEach(app => appsDict[app.ID] = app.name);\n\n    modules.forEach(module => {\n        const appNamesArr = module.relatedApplications.map(i => appsDict[i.applicationID]);\n        module.relatedAppNames = appNamesArr.join(", ");\n    });\n\n    tableData.value = modules;\n}, { loading: true });\n}\n\nrefreshTable()\nfunction add(module: IModule) {\n    executor.execute(async () => {\n        const applicationID = viewModel.studio.appId;\n        await studio.attachModuletoApplication(module, applicationID);\n        const curModule = tableData.value.find(i => i.ID == module.ID);\n        curModule!.relatedApplications.push({ applicationID });\n        refreshTable()\n    }, { loading: true });\n}\n\nfunction remove(module: IModule) {\n    executor.execute(async () => {\n        const applicationID = viewModel.studio.appId;\n        await studio.detachModuleFromApplication(module, applicationID);\n        const curModule = tableData.value.find(i => i.ID == module.ID)!;\n        curModule.relatedApplications = curModule.relatedApplications.filter(i => i.applicationID != applicationID);\n        refreshTable()\n    }, { loading: true });\n}\n\nfunction isAddedtoCurrentApp(module: IModule) {\n    const appID = viewModel.studio.appId;\n    const isAdded = module.relatedApplications?.some(i => i.applicationID == appID);\n    return !!isAdded;\n}\n\n<\/script> \n \n<template>\n    <div class="container">\n        <v-client-table ref="table" :data="tableData" :columns="tableColumns" :options="tableOptions">\n            <template #createDate="props">\n                <span>{{ new Intl.DateTimeFormat("tr-TR", dateOptions).format(new Date(props.row.createDate)) }}</span>\n            </template>\n            <template #relatedAppNames="props">\n                <span>{{props.row.relatedAppNames}}</span>\n            </template>\n            <template #actions="props">\n                <button v-if="isAddedtoCurrentApp(props.row)" @click="remove(props.row)">Remove</button>\n                <button v-else @click="add(props.row)">Add</button>\n            </template>\n        </v-client-table>\n    </div>\n</template> \n<style scoped>\n.container {\n    padding: 32px 20px 20px;\n}\n    @import url("../../../../styles/IDE3.css");\n</style>'],sourceRoot:""}]);const c=l},86595:(e,t,n)=>{n.d(t,{w:()=>a});const a=Symbol.for("ILocalization")},45340:(e,t,n)=>{n.r(t),n.d(t,{default:()=>z});var a=n(62068),o=n(49045),i=n(81407),s=n(3734),r=n(86595),l=n(57554),c=n(33900),d=n(80664),p=n(67422);const u={class:"container"},m=["onClick"],I=["onClick"],v=(0,a.aZ)({__name:"attachModuleToApp",emits:["close"],setup(e,{emit:t}){const n=s.nC.resolve(p.J),v=s.nC.resolve(d.y),D=s.nC.resolve(r.w),A=s.nC.resolve(l._),f=s.nC.resolve(c.c),w=(0,i.iH)([]),b=(0,i.iH)(["name","description","relatedAppNames","createDate","createdBy","actions"]),g=(0,i.iH)({filterable:!0,perPage:5,perPageValues:[],headings:{name:D.get("moduleName"),description:D.get("description"),relatedAppNames:D.get("relatedApplications"),createDate:D.get("createDate"),createdBy:D.get("createdBy"),actions:""},sortIcon:{base:"mdi",is:"mdi mdi-unfold-less-horizontal",up:"mdi mdi-arrow-up",down:"mdi mdi-arrow-down"},texts:{count:""}}),h={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"};function C(){v.execute((async()=>{const e=await A.listModules(),t={};n.apps.forEach((e=>t[e.ID]=e.name)),e.forEach((e=>{const n=e.relatedApplications.map((e=>t[e.applicationID]));e.relatedAppNames=n.join(", ")})),w.value=e}),{loading:!0})}function y(e){var t;const a=n.studio.appId;return!!(null===(t=e.relatedApplications)||void 0===t?void 0:t.some((e=>e.applicationID==a)))}return C(),(e,t)=>{const i=(0,a.up)("v-client-table");return(0,a.wg)(),(0,a.iD)("div",u,[(0,a.Wm)(i,{ref:"table",data:w.value,columns:b.value,options:g.value},{createDate:(0,a.w5)((e=>[(0,a._)("span",null,(0,o.toDisplayString)(new Intl.DateTimeFormat("tr-TR",h).format(new Date(e.row.createDate))),1)])),relatedAppNames:(0,a.w5)((e=>[(0,a._)("span",null,(0,o.toDisplayString)(e.row.relatedAppNames),1)])),actions:(0,a.w5)((e=>[y(e.row)?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:t=>{return a=e.row,void v.execute((async()=>{const e=n.studio.appId;await f.detachModuleFromApplication(a,e);const t=w.value.find((e=>e.ID==a.ID));t.relatedApplications=t.relatedApplications.filter((t=>t.applicationID!=e)),C()}),{loading:!0});var a}},"Remove",8,m)):((0,a.wg)(),(0,a.iD)("button",{key:1,onClick:t=>{return a=e.row,void v.execute((async()=>{const e=n.studio.appId;await f.attachModuletoApplication(a,e),w.value.find((e=>e.ID==a.ID)).relatedApplications.push({applicationID:e}),C()}),{loading:!0});var a}},"Add",8,I))])),_:1},8,["data","columns","options"])])}}});var D=n(75701),A=n.n(D),f=n(8236),w=n.n(f),b=n(6080),g=n.n(b),h=n(56850),C=n.n(h),y=n(87182),M=n.n(y),x=n(39213),N=n.n(x),E=n(29300),k={};k.styleTagTransform=N(),k.setAttributes=C(),k.insert=g().bind(null,"head"),k.domAPI=w(),k.insertStyleElement=M(),A()(E.Z,k),E.Z&&E.Z.locals&&E.Z.locals;const z=(0,n(51419).Z)(v,[["__scopeId","data-v-32b77fd6"]])}}]);
//# sourceMappingURL=5340.js.map