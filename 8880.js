"use strict";(this.webpackChunkqcloud_shell=this.webpackChunkqcloud_shell||[]).push([[8880],{68657:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(51864),o=n.n(a),l=n(60352),s=n.n(l)()(o());s.push([e.id,"\ntextarea[data-v-57aaa323]{\n    resize: both;\n}\n","",{version:3,sources:["webpack://./src/presentation/vue3/editors/fileEditor.vue"],names:[],mappings:";AAkEA;IACI,YAAY;AAChB",sourcesContent:['<script setup lang="ts">\nimport { text } from \'stream/consumers\';\nimport { onBeforeUnmount, onMounted, onUnmounted, Ref, ref } from \'vue\';\nimport { IFileEditorProps } from \'../../../domain/objects/editors/IFileEditor\';\n\ninterface IProps {\n    functions: IFileEditorProps["functions"];\n    callbacks: IFileEditorProps["callbacks"];\n}\nconst props = defineProps<IProps>();\nconst textarea = ref<HTMLTextAreaElement>() as Ref<HTMLTextAreaElement>;\n\nprops.functions.getModel = async () => {\n    const scrollTop = textarea.value.scrollTop;\n    const selectionStart = textarea.value.selectionStart;\n    const selectionEnd = textarea.value.selectionEnd;\n    const width = textarea.value.style.width;\n    const height = textarea.value.style.height;\n\n    return { model: textarea.value.value, state: { scrollTop, selectionStart, selectionEnd, width, height, checkout: !textarea.value.disabled } };\n};\nprops.functions.setModel = async (model, state) => {\n    //model\n    textarea.value.value = model;\n\n    //state\n    textarea.value.focus();\n    textarea.value.style.width = state.width || "98%";\n    textarea.value.style.height = state.height || "90%";\n    textarea.value.scrollTop = state.scrollTop;\n    textarea.value.selectionStart = state.selectionStart;\n    textarea.value.selectionEnd = state.selectionEnd;\n    textarea.value.disabled = textarea.value.readOnly = !state.checkout || false;\n    textarea.value.style.resize = "none";\n    \n}\nconst modified: Record<string, EventListenerOrEventListenerObject> = {\n    select: () => { console.log("select"); props.callbacks.modified({ state: true }) },\n    scroll: () => { console.log("scroll"); props.callbacks.modified({ state: true }) },\n    change: () => { console.log("change"); props.callbacks.modified({ model: true }) },\n    keydown: (e: Event) => {\n        const event = e as KeyboardEvent;\n        const code = event.code.toLowerCase();\n        if (event.shiftKey || event.ctrlKey || code.startsWith("arrow")){return;}\n        console.log("keydown"); props.callbacks.modified({ model: true });\n    },\n    resize: () => { console.log("resize"); props.callbacks.modified({ state: true }) },\n    input:() =>{console.log(\'model change\'); props.callbacks.modified({model:true})}\n};\n\nconst watchTextArea = (attach: boolean) => {\n    const target = attach ? textarea.value.addEventListener : textarea.value.removeEventListener;\n    Object.keys(modified).forEach(key => target.call(textarea.value, key, modified[key]));\n}\n\nonMounted(() => {\n    watchTextArea(true);\n});\nonBeforeUnmount(() => {\n    watchTextArea(false);\n});\n<\/script>\n<template>\n<textarea ref="textarea"></textarea>\n</template>\n<style scoped>\ntextarea{\n    resize: both;\n}\n</style>'],sourceRoot:""}]);const r=s},8880:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var a=n(62068),o=n(81407);const l=(0,a.aZ)({__name:"fileEditor",props:{functions:null,callbacks:null},setup(e){const t=e,n=(0,o.iH)();t.functions.getModel=async()=>{const e=n.value.scrollTop,t=n.value.selectionStart,a=n.value.selectionEnd,o=n.value.style.width,l=n.value.style.height;return{model:n.value.value,state:{scrollTop:e,selectionStart:t,selectionEnd:a,width:o,height:l,checkout:!n.value.disabled}}},t.functions.setModel=async(e,t)=>{n.value.value=e,n.value.focus(),n.value.style.width=t.width||"98%",n.value.style.height=t.height||"90%",n.value.scrollTop=t.scrollTop,n.value.selectionStart=t.selectionStart,n.value.selectionEnd=t.selectionEnd,n.value.disabled=n.value.readOnly=!t.checkout||!1,n.value.style.resize="none"};const l={select:()=>{console.log("select"),t.callbacks.modified({state:!0})},scroll:()=>{console.log("scroll"),t.callbacks.modified({state:!0})},change:()=>{console.log("change"),t.callbacks.modified({model:!0})},keydown:e=>{const n=e,a=n.code.toLowerCase();n.shiftKey||n.ctrlKey||a.startsWith("arrow")||(console.log("keydown"),t.callbacks.modified({model:!0}))},resize:()=>{console.log("resize"),t.callbacks.modified({state:!0})},input:()=>{console.log("model change"),t.callbacks.modified({model:!0})}},s=e=>{const t=e?n.value.addEventListener:n.value.removeEventListener;Object.keys(l).forEach((e=>t.call(n.value,e,l[e])))};return(0,a.bv)((()=>{s(!0)})),(0,a.Jd)((()=>{s(!1)})),(e,t)=>((0,a.wg)(),(0,a.iD)("textarea",{ref_key:"textarea",ref:n},null,512))}});var s=n(75701),r=n.n(s),c=n(8236),i=n.n(c),d=n(6080),u=n.n(d),v=n(56850),h=n.n(v),p=n(87182),m=n.n(p),f=n(39213),g=n.n(f),k=n(68657),y={};y.styleTagTransform=g(),y.setAttributes=h(),y.insert=u().bind(null,"head"),y.domAPI=i(),y.insertStyleElement=m(),r()(k.Z,y),k.Z&&k.Z.locals&&k.Z.locals;const x=(0,n(51419).Z)(l,[["__scopeId","data-v-57aaa323"]])}}]);
//# sourceMappingURL=8880.js.map