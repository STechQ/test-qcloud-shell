"use strict";(this.webpackChunkqcloud_shell=this.webpackChunkqcloud_shell||[]).push([[654],{5648:(e,n,t)=>{t.d(n,{Z:()=>l});var o=t(4663),i=t.n(o),a=t(7638),s=t.n(a)()(i());s.push([e.id,'\n  /*You should put other CSS properties with same class names in the parent component\'s style tag that is not scoped.*/\n*[data-v-237b87c3] {\n    font-family: "Roboto"\n}\n.custom-select[data-v-237b87c3] {\n    position: relative;\n    width: 100%;\n    text-align: left;\n    outline: none;\n}\n.custom-select .selected[data-v-237b87c3] {\n\n    cursor: pointer;\n    user-select: none;\n}\n.custom-select .selected i[data-v-237b87c3] {\n    position: absolute;\n    right: 10px;\n    float: right;\n}\n.custom-select .items[data-v-237b87c3] {\n    position: absolute;\n    left: 0;\n    right: 0;\n    z-index: 1;\n}\n.custom-select .items .option[data-v-237b87c3] {\n    cursor: pointer;\n    user-select: none;\n}\n.custom-select .items .option.disabled div[data-v-237b87c3] {\n    cursor: default;\n    user-select: none;\n    opacity: 0.4;\n}\n.custom-select .items .option.disabled[data-v-237b87c3]:active {\n    pointer-events: none;\n}\n.selectHide[data-v-237b87c3] {\n    display: none;\n}\n.button-div[data-v-237b87c3] {\n    justify-content: center;\n    display: grid;\n    padding: 13px 0 19px;\n    margin-top: 10px\n}\n.button[data-v-237b87c3] {\n    cursor: pointer;\n}\n.custom-placeholder[data-v-237b87c3]:empty:before {\n    content:attr(data-placeholder);\n    color:#616161\n}\n.custom-placeholder[data-v-237b87c3]:focus-visible {\n    outline: none;\n}\n.button-tooltip[data-v-237b87c3] {\n    visibility: hidden;\n    display: flex;\n    flex-direction: row;\n    align-items: flex-start;\n    padding: 8px;\n    top: 39px;\n    left: 65px;\n    height: 30px;\n    position: absolute;\n    background: #757575;\n    color: #FFFFFF;\n    font-size: 12px;\n    line-height: 14px;\n    text-align: center;\n    border-radius: 4px;\n    letter-spacing: 0.2px;\n    opacity: 0;\n    z-index: 1;\n}\n.custom-select .items .option:hover .button-tooltip[data-v-237b87c3] {\n    visibility: visible;\n    transition: opacity 0.3s ease-out 0.5s;\n    opacity: 1;\n}\n  ',"",{version:3,sources:["webpack://./src/presentation/vue3/components/customSelect.vue"],names:[],mappings:";EAoHE,oHAAoH;AACpH;IACE;AACF;AACA;IACE,kBAAkB;IAClB,WAAW;IACX,gBAAgB;IAChB,aAAa;AACf;AAEA;;IAEE,eAAe;IACf,iBAAiB;AACnB;AAEA;IACE,kBAAkB;IAClB,WAAW;IACX,YAAY;AACd;AAEA;IACE,kBAAkB;IAClB,OAAO;IACP,QAAQ;IACR,UAAU;AACZ;AAEA;IACE,eAAe;IACf,iBAAiB;AACnB;AAEA;IACE,eAAe;IACf,iBAAiB;IACjB,YAAY;AACd;AACA;IACE,oBAAoB;AACtB;AAEA;IACE,aAAa;AACf;AACA;IACE,uBAAuB;IACvB,aAAa;IACb,oBAAoB;IACpB;AACF;AACA;IACE,eAAe;AACjB;AACA;IACE,8BAA8B;IAC9B;AACF;AACA;IACE,aAAa;AACf;AACA;IACE,kBAAkB;IAClB,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,YAAY;IACZ,SAAS;IACT,UAAU;IACV,YAAY;IACZ,kBAAkB;IAClB,mBAAmB;IACnB,cAAc;IACd,eAAe;IACf,iBAAiB;IACjB,kBAAkB;IAClB,kBAAkB;IAClB,qBAAqB;IACrB,UAAU;IACV,UAAU;AACZ;AACA;IACE,mBAAmB;IACnB,sCAAsC;IACtC,UAAU;AACZ",sourcesContent:['<template>\n  <div class="custom-select" :tabindex="tabindex" @blur="open = false">\n    <div :class="open ? \'open selected \' + selectedClass : \'selected \' + selectedClass" @click="open = !open">\n      <div v-if = "selected">{{ typeof selected === \'object\' ? selected.name : selected }}\n        <i class="mdi mdi-chevron-down"></i>\n      </div>\n      <div v-else>\n        <span contenteditable="true" :data-placeholder="placeholder" class="custom-placeholder"></span>\n        <i class="mdi mdi-chevron-down"></i>\n      </div>\n    </div>\n    <div class="items" :class="{ selectHide: !open }" :style="{padding: extraButton ? \'10px 0 0\' : \'10px 0\'}">\n      <div v-for="(option, i) of options" :key="i" @click="handleClick(option)" :class="[\'option\' , (props.disabledOptions && getDisabledOptionsText(i)) ? \'disabled\' : \'\' ]">\n        <span v-if="props.disabledOptions && getDisabledOptionsText(i)" class="button-tooltip" :style="{top: (i*32) + 85 + \'px\'}">{{getDisabledOptionsText(i)}}</span>\n        <div>{{typeof option === \'object\' ? option.name : option }}</div>\n      </div>\n      <div v-if="extraButton" class="button-div" :style="{borderTop: extraButton ? \'1px solid #EEEEEE\' :  \'none\'}" >\n        <div v-for="(button, index) in buttons" :key="index">\n            <div :id="\'option-button-\' + index" :class="button.buttonClass + \' button\'" @click="open=false">{{ button.buttonText }}</div>\n        </div>\n      </div>\n    </div>  \n  </div>\n</template>\n\n<script setup>\nimport { ref, watchEffect } from \'vue\'\nconst emit = defineEmits(["input"]);\nconst props = defineProps({\n  options: {\n    type: Array,\n    required: true,\n  },\n  disabledOptions: {\n    type: Array,\n    required: false\n  },\n  default: {\n    type: String,\n    required: false,\n    default: \'\',\n  },\n  selectedOption: {\n    type: String,\n    required: false\n  },\n  tabindex: {\n    type: Number,\n    required: false,\n    default: 0,\n  },\n  placeholder: {\n    type: String,\n    required: false,\n    default: "",\n  },\n  selectedClass: {\n    type: String,\n    required: true,\n    default: "",\n  },\n  extraButton: {\n    type: Boolean,\n    required: false,\n    default: false,\n  },\n  buttons: {\n    type: Array,\n    required: false,\n    default: () => [],\n    validator: (value) => {\n      return value.every(\n        (button) =>\n          typeof button === "object" &&\n          typeof button.buttonText === "string" &&\n          typeof button.buttonClass === "string"\n      );\n    },\n  },\n})\n\nconst open = ref(false);\nconst selected = ref(props.default ? props.default : null);\n\nwatchEffect(() => {\n  if(props && props.selectedOption){\n    selected.value = props.selectedOption;\n    open.value = false;\n  }\n});\n\nconst handleClick = (option) => {\n    if(typeof option === \'object\'){\n      emit(\'input\', option.id);\n      selected.value = option;\n      open.value = false;\n      emit(\'input\', selected.value.id);\n    }\n    else if(typeof option === \'string\') {\n      emit(\'input\', option);\n      selected.value = option;\n      open.value = false;\n      emit(\'input\', selected.value);\n    }\n}\n\nconst getDisabledOptionsText = (index) => {\n  const opt = props.disabledOptions.find(e => e.index == index);\n  if(opt)\n    return opt.cause;\n  return undefined;\n}\n<\/script>\n\n  \n  <style scoped>\n  /*You should put other CSS properties with same class names in the parent component\'s style tag that is not scoped.*/\n  * {\n    font-family: "Roboto"\n  }\n  .custom-select {\n    position: relative;\n    width: 100%;\n    text-align: left;\n    outline: none;\n  }\n  \n  .custom-select .selected {\n\n    cursor: pointer;\n    user-select: none;\n  }\n  \n  .custom-select .selected i {\n    position: absolute;\n    right: 10px;\n    float: right;\n  }\n  \n  .custom-select .items {\n    position: absolute;\n    left: 0;\n    right: 0;\n    z-index: 1;\n  }\n  \n  .custom-select .items .option {\n    cursor: pointer;\n    user-select: none;\n  }  \n  \n  .custom-select .items .option.disabled div {\n    cursor: default;\n    user-select: none;\n    opacity: 0.4;\n  } \n  .custom-select .items .option.disabled:active {\n    pointer-events: none;\n  }\n  \n  .selectHide {\n    display: none;\n  }\n  .button-div {\n    justify-content: center;\n    display: grid;\n    padding: 13px 0 19px;\n    margin-top: 10px\n  }\n  .button {\n    cursor: pointer;\n  }\n  .custom-placeholder:empty:before {\n    content:attr(data-placeholder);\n    color:#616161\n  }\n  .custom-placeholder:focus-visible {\n    outline: none;\n  }\n  .button-tooltip {\n    visibility: hidden;\n    display: flex;\n    flex-direction: row;\n    align-items: flex-start;\n    padding: 8px;\n    top: 39px;\n    left: 65px;\n    height: 30px;\n    position: absolute;\n    background: #757575;\n    color: #FFFFFF;\n    font-size: 12px;\n    line-height: 14px;\n    text-align: center;\n    border-radius: 4px;\n    letter-spacing: 0.2px;\n    opacity: 0;\n    z-index: 1;\n  }\n  .custom-select .items .option:hover .button-tooltip {\n    visibility: visible;\n    transition: opacity 0.3s ease-out 0.5s;\n    opacity: 1;\n  }\n  </style>'],sourceRoot:""}]);const l=s},9678:(e,n,t)=>{t.d(n,{Z:()=>l});var o=t(4663),i=t.n(o),a=t(7638),s=t.n(a)()(i());s.push([e.id,"\n.container[data-v-03dfac29] {\n    padding: 32px 20px 20px;\n}\n.settings-container[data-v-03dfac29] {\n    position: relative;\n    top: 0px;\n    left: 0px;\n}\n.custom-text[data-v-03dfac29] {\n    /* position: absolute; */\n    font-family: 'Roboto';\n    font-style: normal;\n    font-weight: 500;\n    font-size: 15px;\n    line-height: 18px;\n    /* left: 24px; */\n    color: #212121;\n}\n\n/* .custom-text.title{\n    top: 92px;\n}\n\n.custom-text.environment{\n    top: 174px;\n} */\n.radio-button[data-v-03dfac29] {\n    position: absolute;\n    top: 60px;\n    left: 20px;\n    cursor: pointer;\n}\n.radio-text[data-v-03dfac29] {\n    position: absolute;\n    top: 59px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n    user-select: none;\n    cursor: pointer;\n}\n.existing-app-url[data-v-03dfac29] {\n    position: absolute;\n    width: 760px;\n    height: 40px;\n    top: 114px;\n    left: 20px;\n    background: #ffffff 0% 0% no-repeat padding-box;\n    border: 1px solid #bcbcbc;\n    border-radius: 4px;\n    font: normal normal normal 14px/19px Roboto;\n    letter-spacing: 0px;\n    padding: 10px 0px 10px 10px;\n}\n.url-error[data-v-03dfac29] {\n    border: 1px solid red;\n}\n.url-disable[data-v-03dfac29] {\n    opacity: 0.5;\n}\n.existing-app-url[data-v-03dfac29]::placeholder {\n    color: #bcbcbc;\n    user-select: none;\n}\n.modules-selected-checkbox[data-v-03dfac29] {\n    cursor: pointer;\n}\n.modules-selected-text[data-v-03dfac29] {\n    font: normal normal normal 14px/19px Roboto;\n    color: #757575;\n    margin: 0 0 13px 30px;\n}\n\n/* .modules-selected-text.deploy {\n    top: 257px;\n} */\n.text-number[data-v-03dfac29] {\n    font: normal normal bold 14px/19px Roboto;\n    color: #212121;\n}\n.modules-datatable[data-v-03dfac29] {\n    width: 760px;\n    height: 288px;\n    border: 1px solid #bcbcbc;\n    overflow-x: hidden;\n    overflow-y: auto;\n    margin-bottom: 20px;\n}\n\n/* .modules-datatable.deploy {\n    top: 286px;\n} */\n.modules-datatable[data-v-03dfac29]::-webkit-scrollbar {\n    width: 4px;\n}\n.modules-datatable[data-v-03dfac29]::-webkit-scrollbar-thumb {\n    background: #bcbcbc 0% 0% no-repeat padding-box;\n    border-radius: 10px;\n}\n.modules-datatable[data-v-03dfac29]::-webkit-scrollbar-thumb:hover {\n    background: #555;\n}\n.row-container[data-v-03dfac29] {\n    width: 100%;\n    height: 36px;\n    position: relative;\n    background: #ffffff 0% 0% no-repeat padding-box;\n    border: 1px solid #e0e0e0;\n}\n.chevron[data-v-03dfac29] {\n    position: absolute;\n    left: 4px;\n    color: #757575;\n    font-size: 24px;\n}\n.chevron.disabled[data-v-03dfac29] {\n    pointer-events: none;\n    color: #D5D5D5;\n}\n.module-checkbox[data-v-03dfac29] {\n    position: absolute;\n    top: 10px;\n    left: 43px;\n    cursor: pointer;\n}\n.module-name[data-v-03dfac29] {\n    position: absolute;\n    top: 9px;\n    left: 69px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n}\n.module-name.disabled[data-v-03dfac29] {\n    color: #D5D5D5;\n}\n.model-checkbox[data-v-03dfac29] {\n    position: absolute;\n    top: 10px;\n    left: 59px;\n    cursor: pointer;\n}\n.model-icon[data-v-03dfac29] {\n    position: absolute;\n    width: 16px;\n    height: 16px;\n    top: 6px;\n    left: 85px;\n}\n.app-tier-model-icon[data-v-03dfac29] {\n    position: absolute;\n    width: 16px;\n    height: 16px;\n    top: 6px;\n    left: 69px;\n}\n.app-tier-model-name[data-v-03dfac29] {\n    position: absolute;\n    top: 10px;\n    left: 87px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n}\n.app-tier-model-name.disabled[data-v-03dfac29] {\n    color: #D5D5D5;\n}\n.model-name[data-v-03dfac29] {\n    position: absolute;\n    top: 9px;\n    left: 103px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n}\n.model-name.disabled[data-v-03dfac29] {\n    color: #D5D5D5;\n}\n.version-text[data-v-03dfac29] {\n    margin: 10px 7px 10px auto;\n    display: table;\n    font: normal normal normal 12px/16px Roboto;\n    color: #757575;\n    cursor: pointer;\n    user-select: none;\n}\n.version-text.disabled[data-v-03dfac29] {\n    pointer-events: none;\n    cursor: pointer;\n}\n.version-icon[data-v-03dfac29] {\n    font: normal normal normal 16px/19px Material Design Icons;\n    color: #D5D5D5;\n}\n.version-icon.disabled[data-v-03dfac29] {\n    font: normal normal normal 16px/19px Material Design Icons;\n    color: #EEEEEE;\n    pointer-events: none;\n    cursor: pointer;\n}\n.footer[data-v-03dfac29] {\n    position: relative;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: end;\n}\n.footer.deploy[data-v-03dfac29] {\n    position: relative;\n    width: 100%;\n}\n.footer.export[data-v-03dfac29] {\n    margin-top: 102px;\n}\n.cancel-button[data-v-03dfac29] {\n    border-radius: 4px;\n    user-select: none;\n    font-style: normal;\n    font-weight: 500;\n    font-family: \"ROBOTO\";\n    font-size: 15px;\n    color: #757575;\n    padding: 10px 16px;\n    cursor: pointer;\n}\n.save-button[data-v-03dfac29] {\n    background: #151233 0% 0% no-repeat padding-box;\n    border-radius: 4px;\n    user-select: none;\n    font-weight: 500;\n    font-size: 15px;\n    color: #ffffff;\n    padding: 10px 16px;\n    cursor: pointer;\n}\n.mobile-publish-text[data-v-03dfac29],\n.web-publish-text[data-v-03dfac29] {\n    padding: 5px 12px;\n    margin-bottom: 52px;\n    width: 100%;\n    color: #757575;\n    font-size: 14px;\n    background: #F5F5FA;\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n}\n.mobile-publish-text i[data-v-03dfac29],\n.web-publish-text i[data-v-03dfac29] {\n    font-size: 24px;\n    color: #151233;\n    margin-right: 4px;\n}\n.save-button.deploy[data-v-03dfac29] {\n    padding: 10px 16px;\n}\n.button-disable .save-button[data-v-03dfac29] {\n    opacity: 0.5;\n}\n.button-disable .save-button:hover+.button-tooltip[data-v-03dfac29],\n.start-screen:hover .button-tooltip[data-v-03dfac29],\n.publish-info:hover .button-tooltip[data-v-03dfac29] {\n    visibility: visible;\n    transition: opacity 0.3s ease-out 1s;\n    opacity: 1;\n}\n.button-tooltip[data-v-03dfac29] {\n    visibility: hidden;\n    position: absolute;\n    background: #757575;\n    color: #FFFFFF;\n    font-size: 11px;\n    font-family: 'Roboto';\n    text-align: center;\n    border-radius: 4px;\n    letter-spacing: 0.2px;\n    padding: 6px 8px 6px 8px;\n    top: 56px;\n    left: 63px;\n    opacity: 0;\n}\n.publish-info[data-v-03dfac29] {\n    color: #757575;\n    font-size: 20px;\n    margin-left: 10px;\n}\n.qjson-color[data-v-03dfac29] {\n    color: #449dd1;\n}\n.yaml-color[data-v-03dfac29] {\n    color: #449dd1;\n}\n.js-color[data-v-03dfac29] {\n    color: #449dd1;\n}\n.process-color[data-v-03dfac29] {\n    color: #007c77;\n}\n.bpmn-color[data-v-03dfac29] {\n    color: #007c77;\n}\n.entity-designer-color[data-v-03dfac29] {\n    color: #e9724c;\n}\n.select-environment[data-v-03dfac29] {\n    width: 100%;\n    font-size: 15px;\n    height: 40px;\n    line-height: 40px;\n    margin-top: 4px\n}\n","",{version:3,sources:["webpack://./src/presentation/vue3/components/dialogs/publish/publishDialog.vue"],names:[],mappings:";AA+wBA;IACI,uBAAuB;AAC3B;AAEA;IACI,kBAAkB;IAClB,QAAQ;IACR,SAAS;AACb;AAEA;IACI,wBAAwB;IACxB,qBAAqB;IACrB,kBAAkB;IAClB,gBAAgB;IAChB,eAAe;IACf,iBAAiB;IACjB,gBAAgB;IAChB,cAAc;AAClB;;AAEA;;;;;;GAMG;AAEH;IACI,kBAAkB;IAClB,SAAS;IACT,UAAU;IACV,eAAe;AACnB;AAEA;IACI,kBAAkB;IAClB,SAAS;IACT,2CAA2C;IAC3C,cAAc;IACd,iBAAiB;IACjB,eAAe;AACnB;AAEA;IACI,kBAAkB;IAClB,YAAY;IACZ,YAAY;IACZ,UAAU;IACV,UAAU;IACV,+CAA+C;IAC/C,yBAAyB;IACzB,kBAAkB;IAClB,2CAA2C;IAC3C,mBAAmB;IACnB,2BAA2B;AAC/B;AAEA;IACI,qBAAqB;AACzB;AAEA;IACI,YAAY;AAChB;AAEA;IACI,cAAc;IACd,iBAAiB;AACrB;AAEA;IACI,eAAe;AACnB;AAEA;IACI,2CAA2C;IAC3C,cAAc;IACd,qBAAqB;AAEzB;;AAEA;;GAEG;AAEH;IACI,yCAAyC;IACzC,cAAc;AAClB;AAEA;IACI,YAAY;IACZ,aAAa;IACb,yBAAyB;IACzB,kBAAkB;IAClB,gBAAgB;IAChB,mBAAmB;AACvB;;AAEA;;GAEG;AAEH;IACI,UAAU;AACd;AAEA;IACI,+CAA+C;IAC/C,mBAAmB;AACvB;AAEA;IACI,gBAAgB;AACpB;AAEA;IACI,WAAW;IACX,YAAY;IACZ,kBAAkB;IAClB,+CAA+C;IAC/C,yBAAyB;AAC7B;AAEA;IACI,kBAAkB;IAClB,SAAS;IACT,cAAc;IACd,eAAe;AACnB;AAEA;IACI,oBAAoB;IACpB,cAAc;AAClB;AAEA;IACI,kBAAkB;IAClB,SAAS;IACT,UAAU;IACV,eAAe;AACnB;AAEA;IACI,kBAAkB;IAClB,QAAQ;IACR,UAAU;IACV,2CAA2C;IAC3C,cAAc;AAClB;AAEA;IACI,cAAc;AAClB;AAEA;IACI,kBAAkB;IAClB,SAAS;IACT,UAAU;IACV,eAAe;AACnB;AAEA;IACI,kBAAkB;IAClB,WAAW;IACX,YAAY;IACZ,QAAQ;IACR,UAAU;AACd;AAEA;IACI,kBAAkB;IAClB,WAAW;IACX,YAAY;IACZ,QAAQ;IACR,UAAU;AACd;AAEA;IACI,kBAAkB;IAClB,SAAS;IACT,UAAU;IACV,2CAA2C;IAC3C,cAAc;AAClB;AAEA;IACI,cAAc;AAClB;AAEA;IACI,kBAAkB;IAClB,QAAQ;IACR,WAAW;IACX,2CAA2C;IAC3C,cAAc;AAClB;AAEA;IACI,cAAc;AAClB;AAEA;IACI,0BAA0B;IAC1B,cAAc;IACd,2CAA2C;IAC3C,cAAc;IACd,eAAe;IACf,iBAAiB;AACrB;AAEA;IACI,oBAAoB;IACpB,eAAe;AACnB;AAEA;IACI,0DAA0D;IAC1D,cAAc;AAClB;AAEA;IACI,0DAA0D;IAC1D,cAAc;IACd,oBAAoB;IACpB,eAAe;AACnB;AAEA;IACI,kBAAkB;IAClB,WAAW;IACX,aAAa;IACb,mBAAmB;IACnB,oBAAoB;AACxB;AAEA;IACI,kBAAkB;IAClB,WAAW;AACf;AAEA;IACI,iBAAiB;AACrB;AAEA;IACI,kBAAkB;IAClB,iBAAiB;IACjB,kBAAkB;IAClB,gBAAgB;IAChB,qBAAqB;IACrB,eAAe;IACf,cAAc;IACd,kBAAkB;IAClB,eAAe;AACnB;AAIA;IACI,+CAA+C;IAC/C,kBAAkB;IAClB,iBAAiB;IACjB,gBAAgB;IAChB,eAAe;IACf,cAAc;IACd,kBAAkB;IAClB,eAAe;AACnB;AAEA;;IAEI,iBAAiB;IACjB,mBAAmB;IACnB,WAAW;IACX,cAAc;IACd,eAAe;IACf,mBAAmB;IACnB,kBAAkB;IAClB,aAAa;IACb,mBAAmB;AACvB;AAEA;;IAEI,eAAe;IACf,cAAc;IACd,iBAAiB;AACrB;AAEA;IACI,kBAAkB;AACtB;AAEA;IACI,YAAY;AAChB;AAEA;;;IAGI,mBAAmB;IACnB,oCAAoC;IACpC,UAAU;AACd;AAEA;IACI,kBAAkB;IAClB,kBAAkB;IAClB,mBAAmB;IACnB,cAAc;IACd,eAAe;IACf,qBAAqB;IACrB,kBAAkB;IAClB,kBAAkB;IAClB,qBAAqB;IACrB,wBAAwB;IACxB,SAAS;IACT,UAAU;IACV,UAAU;AACd;AAEA;IACI,cAAc;IACd,eAAe;IACf,iBAAiB;AACrB;AAEA;IACI,cAAc;AAClB;AAEA;IACI,cAAc;AAClB;AAEA;IACI,cAAc;AAClB;AAEA;IACI,cAAc;AAClB;AAEA;IACI,cAAc;AAClB;AAEA;IACI,cAAc;AAClB;AAEA;IACI,WAAW;IACX,eAAe;IACf,YAAY;IACZ,iBAAiB;IACjB;AACJ",sourcesContent:['<template>\n    <div class="container">\n        <div>\n            <CheckboxComp :class="[\'modules-selected-checkbox\', props.screenType == \'Deploy\' ? \'deploy\' : \'\']"\n                :minus="mainCheckboxState == false" :check="mainCheckboxState == true"\n                @click="handleModuleCountCheckboxEvent(mainCheckboxState == undefined)" />\n            <div :class="[\'modules-selected-text\', props.screenType == \'Deploy\' ? \'deploy\' : \'\']">\n                <span class="text-number">{{  allChildCheckedModulesCount + anyChildCheckedModulesCount + checkedRootLevelModelsCount }}</span>\n                of <span class="text-number">{{ totalRootLevelCount }}</span> items selected\n            </div>\n        </div>\n\n        <div :class="[\'modules-datatable\', props.screenType == \'Deploy\' ? \'deploy\' : \'\']">\n            <div v-for="item in items">\n                <div v-if="item?.type == \'module\'">\n                    <div class="row-container">\n                        <i :class="\'mdi mdi-menu\' + (item.collapsed ? \'-right\' : \'-down\') + \' chevron\' + (!item.children || item.children.length == 0 ? \' disabled\': \'\')"\n                            @click="handleCollapse(item)" />\n                        <CheckboxComp class="module-checkbox" :check="item.allChildChecked"\n                            :minus="!item.allChildChecked && item.anyChildChecked" :disabled="item.disabled"\n                            @click="handleItemCheckEvent(item)" />\n                        <span :class="[\'module-name\', item.disabled ? \' disabled\': \'\']">{{ item.name }}</span>\n                    </div>\n                    <div class="row-container" v-show="!item.collapsed" v-for="child in item?.children">\n                        <CheckboxComp class="model-checkbox" :check="child.checked" :disabled="child.disabled"\n                            @click="handleItemCheckEvent(child)" />\n                        <i v-if="child.type == \'qjson\'" class="mdi mdi-palette qjson-color model-icon" />\n                        <i v-if="child.type == \'yaml\'" class="mdi mdi-cog-outline yaml-color model-icon" />\n                        <i v-if="child.type == \'js\' || child?.type == \'css\'"\n                            class="mdi mdi-cog-outline js-color model-icon" />\n                        <i v-if="child.type == \'process\'" class="mdi mdi-auto-fix process-color model-icon" />\n                        <i v-if="child.type == \'bpmn\'" class="mdi mdi-vector-polyline bpmn-color model-icon" />\n                        <i v-if="child.type == \'entityDesigner\'"\n                            class="mdi mdi-database entity-designer-color model-icon" />\n                        <i v-if="child.type == \'flow\'" class="mdi mdi-step-forward bpmn-color model-icon" />\n                        <span :class="[\'model-name\', child.disabled ? \' disabled\' : \'\']">{{ child.name }}</span>\n                        <div v-if="!child.usageType" :class="[\'version-text\', child.disabled ? \'disabled\' : \'\']" @click="versionDialog(child)">\n                            {{ child.version ? child.version : \'No version\' }} <i v-if="!child.usageType" :class="[\'mdi mdi-pencil-outline version-icon\', child.disabled ? \'disabled\' : \'\']"></i>\n                        </div>\n                    </div>\n                </div>\n                <div v-else>\n                    <div class="row-container">\n                        <CheckboxComp class="module-checkbox" :check="item?.checked" :disabled="item.disabled"\n                            @click="handleItemCheckEvent(item)" />\n                        <i v-if="item?.type == \'qjson\'" class="mdi mdi-palette qjson-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'yaml\'" class="mdi mdi-cog-outline yaml-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'js\' || item?.type == \'css\'"\n                            class="mdi mdi-cog-outline js-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'process\'" class="mdi mdi-auto-fix process-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'bpmn\'" class="mdi mdi-vector-polyline bpmn-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'entityDesigner\'"\n                            class="mdi mdi-database entity-designer-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'flow\'" class="mdi mdi-step-forward bpmn-color app-tier-model-icon" />\n                        <span class="app-tier-model-name">{{ item?.name }}\n                            <span class="start-screen" v-if="startScreen?.ID == item.id">\n                                <i class="mdi mdi-home-outline"></i>\n                                <span class="button-tooltip" style="top: -30px; left: 2px; z-index: 1; width: 80px;">Start\n                                    Screen</span>\n                            </span>\n                        </span>\n\n                        <span v-if="!item.usageType" :class="[\'version-text\', item.disabled ? \'disabled\' : \'\']" @click="versionDialog(item)">\n                            {{ item.version ? item.version : \'No version\' }} <i v-if="!item.usageType" :class="[\'mdi mdi-pencil-outline version-icon\', item.disabled ? \'disabled\' : \'\']"></i>\n                        </span>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div v-if="props.screenType == \'Deploy\' && props.platformSelection.web" style="margin-bottom: 102px">\n            <div style="display: flex; align-items: center;">\n                <span class="custom-text environment"> Publish To </span>\n                <span class="publish-info">\n                    <i class="mdi mdi-information"></i>\n                    <span class="button-tooltip" style="top: 460px; left: 96px; z-index: 1; width: 231px;">Publish To\n                        options may change depending on the module type you choose.</span>\n                </span>\n            </div>\n\n            <CustomSelect :options="publishTargets" @input="onTargetSelect" :selectedOption="selectedTarget"\n                :default="selectedTarget" :disabledOptions="disabledOptions" selectedClass="selected-environment"\n                placeholder="Select the publish environment of your application" class="select-environment">\n            </CustomSelect>\n        </div>\n        <div v-if="props.screenType == \'Deploy\' && !props.platformSelection.web && props.platformSelection.mobile"\n            class="mobile-publish-text">\n            <i class="mdi mdi-information"></i>\n            <span>Models and static files of your mobile application will be served from Public Cloud.</span>\n\n        </div>\n        <div :class="[\'footer\', props.screenType == \'Deploy\' ? \'deploy\' : \'export\']">\n            <div :class="[\'cancel-button\', props.screenType == \'Deploy\' ? \'deploy\' : \'\']" @click="close">Cancel</div>\n            <div v-if="props.screenType == \'Export\'" :class="(saveButtonDisable ? \' button-disable\' : \'\')" @click="save">\n                <div class="save-button ">DOWNLOAD</div>\n            </div>\n            <div v-if="props.screenType == \'Deploy\'" :class="[(saveButtonDisable ? \' button-disable\' : \'\')]" @click="save">\n                <span class="save-button deploy">PUBLISH</span>\n                <span v-if="selectedTarget" class="button-tooltip"\n                    style="top: -46px; left: 648px; z-index: 1; width: 120px;">You need to include your start screen.</span>\n                <span v-if="!selectedTarget" class="button-tooltip"\n                    style="top: -46px; left: 644px; z-index: 1; width: 123px;">You need to select a publish\n                    environment.</span>\n            </div>\n\n        </div>\n    </div>\n</template>\n\n\n<script setup lang="ts">\nimport { CryptoHelper } from "@stechquick/algae/lib/helpers/cryptoHelper";\nimport { container } from "../../../../../domain/core/diContainer";\nimport { IExportViewItem, IModel, IModelHistoryInfo, IModule } from "../../../../../domain/model/models";\nimport { IViewModel } from "../../../../../domain/viewModel/IViewModel";\nimport CheckboxComp from "../../checkboxComp.vue";\nimport { ref, computed, defineAsyncComponent, watch, onMounted, onBeforeMount } from "vue";\nimport { IDialog } from "../../../../../domain/presentation/IDialog";\nimport { IUseCaseExecutor } from "../../../../../domain/useCase/IUseCaseExecutor";\nimport { DeployType, ICreateDeployJobParam, ICreateExportJobParam, IExportItem, IExportJobData, IPlatformSelection, IProcessConfigModelItem } from "../../../../../../../common/qCloudTemp/exporter";\nimport { ICreateExportJob } from "../../../../../domain/useCase/ICreateExportJob";\nimport { IDeployJobs } from "../../../../../domain/useCase/IDeployJobs";\nimport { IQCloudApi } from "../../../../../domain/infrastructure/IQCloudApi";\nimport { IPackJobs } from "../../../../../domain/useCase/IPackJobs";\nimport { IJobUtils } from "../../../../../domain/useCase/IJobUtils";\nimport { IQJsonAdditionals, UsageType } from "../../../../../../../common/qCloudTemp/quickCloud";\nimport { PlateauHelper } from "@stechquick/algae/lib/helpers/plateau/plateauHelper";\nimport { IViewModelManager } from "../../../../../domain/viewModel/IViewModelManager";\nimport CustomSelect from "../../../components/customSelect.vue"\nimport { IOrganizationCloud } from "../../../../../../../common/clean/domain/useCases/ICloudProvider";\nimport { IListMultiModelVersions } from "../../../../../domain/useCase/IListMultiModelVersions";\n\ninterface ITableData {\n    id: string;\n    parentId?: string;\n    collapsed?: boolean;\n    anyChildChecked?: boolean;\n    allChildChecked?: boolean;\n    checked?: boolean;\n    name: string;\n    type: IModel["modelType"] | IModule["objectType"];\n    version?: string;\n    disabled?: boolean | true;\n    children?: Array<ITableData>;\n    usageType?: UsageType;\n}\n\ninterface IDeployScreenAdditionalProps {\n    screenType: "Export" | "Deploy";\n    platformSelection: IPlatformSelection;\n}\n\ninterface IDisabledOptions {\n    index: number\n    cause: string;\n}\n\nconst props = defineProps<IDeployScreenAdditionalProps>();\nconst viewModel = container.resolve<IViewModel>(IViewModel);\nconst viewModelManager = container.resolve<IViewModelManager>(IViewModelManager);\nconst dialog = container.resolve<IDialog>(IDialog);\nconst executor = container.resolve<IUseCaseExecutor>(IUseCaseExecutor);\nconst deployJobsUseCase = container.resolve<IDeployJobs>(IDeployJobs);\nconst qcloudApi = container.resolve<IQCloudApi>(IQCloudApi);\nconst packJobsUseCase = container.resolve<IPackJobs>(IPackJobs);\nconst jobUtils = container.resolve<IJobUtils>(IJobUtils);\nconst emit = defineEmits(["close"]);\nconst items = ref<Array<ITableData>>([]);\nconst validations = ref<boolean>(true);\nconst selectedTarget = ref<string>("");\nconst disabledOptions = ref<Array<IDisabledOptions>>();\nconst publishTargets = ref<Array<string>>();\nconst modelHistories = ref<Map<string, Array<IModelHistoryInfo>>>();\nconst startScreen = ref<IModel>();\n\nonMounted(async () => {\n    await initVersions();\n    handleItems();\n    props.screenType == "Deploy" && syncPublishTargets();\n    validations.value = validate();\n})\n\nconst allChildCheckedModulesCount = computed(() => items.value.filter(e => e.type == "module" && e.allChildChecked).length);\nconst anyChildCheckedModulesCount = computed(() => items.value.filter(e => e.type == "module" && !e.allChildChecked && e.anyChildChecked).length);\nconst checkedRootLevelModelsCount = computed(() => items.value.filter(e => e.type != "module" && e.checked).length);\nconst totalRootLevelCount = computed(() => items.value.length);\nconst saveButtonDisable = computed(() => (props.screenType == "Deploy" && props.platformSelection.web && selectedTarget.value == "") || !validations.value || !items.value.some((item) => item.checked || item.anyChildChecked));\nconst mainCheckboxState = computed(() => items.value.length == allChildCheckedModulesCount.value ? true \n        : (anyChildCheckedModulesCount.value + checkedRootLevelModelsCount.value > 0  ? false : undefined));\n\nfunction validate() {\n    let result = true;\n    const modules = items.value.filter(e => e.type == "module" && e.anyChildChecked);\n    const appLayerItems = items.value.filter(e => e.type == "qjson" && e.checked);\n\n    startScreen.value = (viewModel.studio.items as Array<IModel>).find(item => item.isRootPage && items.value.find(e => e.id == item.ID)?.checked);\n    if(!startScreen.value)\n        return false;\n\n    if (props.screenType == "Deploy") {\n        if (modules.length > 0)\n            result = modules\n                .filter(e => e.name != "processmanager").map(e => e.children).filter(e => !e?.find(f => f.type == "entityDesigner" && f.checked)).length <= 0\n\n        let isApplicationWillDeploy = appLayerItems.length > 0;\n        if (isApplicationWillDeploy) {\n            result = appLayerItems\n                .map(e => viewModel.studio.items.find(item => item.ID == e.id) as IModel)\n                .findIndex(e => ((e.additionals as IQJsonAdditionals).isRootPage)) != -1;\n        }\n    }\n\n    return result;\n}\n\nfunction mobileFilter(model: IModel) {\n    return props.platformSelection.web || !props.platformSelection.mobile ||\n        !(model.modelType == "bpmn" || model.modelType == "entityDesigner" || model.modelType == "process");\n}\n\nasync function initVersions() {\n    const modelIDs = Array<string>();\n    viewModelManager.flatMapItems(viewModel.studio.items, (item, path) => {\n        if (item.objectType != "model") { return; }\n        modelIDs.push(item.ID);\n        return item;\n    });\n\n    modelHistories.value = await executor.executeUseCase<IListMultiModelVersions>(IListMultiModelVersions, { modelIDs });\n}\n\nasync function handleItems() {\n    items.value = viewModel.studio.items\n        .filter((item) => item.objectType == "module" && item.children.length > 0)\n        .map((item) => {\n            const tableData: ITableData = {\n                id: item.ID,\n                collapsed: true,\n                name: item.name,\n                type: "module",\n                children: (item as IModule).children\n                    .filter((child) => child.objectType == "model")\n                    .filter(e => !props || props.screenType == "Export" || mobileFilter(e as IModel))\n                    .map(child => {\n                        const maxVersion = getItemMaxVersion(child as IModel)\n                        return {\n                            id: child.ID,\n                            parentId: item.ID,\n                            checked: maxVersion != undefined,\n                            disabled: !maxVersion,\n                            name: child.name,\n                            type: (child as IModel).modelType,\n                            version: maxVersion\n                        } as ITableData\n                    })\n            }\n            handleParentCheckedStatus(tableData);\n            return tableData;\n        });\n\n    viewModel.studio.items\n        .filter((item) => item.objectType == "model" && item.usageType != "appSettings")\n        .forEach((item) => {\n            const maxVersion = getItemMaxVersion(item as IModel)\n            items.value.push(\n                {\n                    id: item.ID,\n                    checked: maxVersion != undefined,\n                    name: item.name,\n                    disabled: !maxVersion,\n                    type: (item as IModel).modelType,\n                    version: maxVersion,\n                });\n        });\n    const uiSettingsID = CryptoHelper.CreateGuid();\n    const appSettings = viewModel.studio.items.filter((item) => item.objectType == "model" && item.usageType == "appSettings") as Array<IModel>;\n    const uiSettings: ITableData = {\n        id: uiSettingsID,\n        collapsed: true,\n        name: "UI Settings",\n        type: "module",\n        children: appSettings.map(settings => {\n            const maxVersion = getItemMaxVersion(settings as IModel)\n            return {\n                id: settings.ID,\n                parentId: uiSettingsID,\n                name: settings.name,\n                type: (settings as IModel).modelType,\n                checked: maxVersion != undefined,\n                usageType: settings?.usageType,\n                disabled: !maxVersion,\n                version: maxVersion,\n            }\n        }) as Array<ITableData>,\n    };\n    handleParentCheckedStatus(uiSettings);\n    items.value.unshift(uiSettings);\n}\n\nfunction getItemMaxVersion(item: IModel): string | undefined {\n    if (!modelHistories.value?.has(item.ID))\n        return undefined;\n\n    const versions = modelHistories.value.get(item.ID);\n    if (!versions)\n        return undefined;\n\n    const findMaxVersion = (versions: Array<string>) => {\n        const versionNumbers = versions.map(v => {\n            const parts: Array<string> = v.split(".");\n            return parseInt(parts[0]) * 10 + parseInt(parts[1]) * 1;\n        })\n\n        versionNumbers.sort((a, b) => b - a);\n\n        const maxVersion = versionNumbers[0];\n        return `${Math.floor(maxVersion / 10)}.${maxVersion % 10}`;\n    }\n\n    return findMaxVersion(versions.map(e => e.version!));\n\n}\n\nfunction handleModuleCountCheckboxEvent(value: boolean) {\n    items.value.filter(e => !e.disabled).forEach((item) => {\n        item.checked = value;\n        const allItemsCheckable = item.allChildChecked != undefined && item.children && item.children.length > 0 && !item.children.some(c => c.disabled);\n        if (allItemsCheckable) item.allChildChecked = value;\n        if (item.anyChildChecked != undefined) item.anyChildChecked = value;\n        if (item.children) item.children.filter(c => !c.disabled).forEach((child) => (child.checked = value));\n    });\n\n    validations.value = validate();\n    props.screenType == "Deploy" && syncPublishTargets();\n}\n\nfunction handleCollapse(item: ITableData) {\n    item.collapsed = !item.collapsed;\n}\n\nfunction handleItemCheckEvent(item: ITableData) {\n    if(item.disabled)\n        return;\n\n    if (item.type != "module") {\n        item.checked = !item.checked;\n        if (item.parentId) {\n            const parent = items.value.find((i) => i.id == item.parentId)!;\n            handleParentCheckedStatus(parent);\n        }\n    } else {\n        if (item.children && item.children.filter(c => !c.disabled).length > 0) {\n            if (item.anyChildChecked) {\n                item.children?.filter(c => !c.disabled).forEach((child) => (child.checked = false));\n                item.checked = false;\n            } else {\n                item.children?.filter(e => !e.disabled).forEach((child) => (child.checked = true));\n                item.checked = true;\n            }\n            handleParentCheckedStatus(item);\n        }\n        else {\n            item.checked = !item.checked;\n            item.allChildChecked = false;\n        }\n    }\n\n    validations.value = validate();\n    props.screenType == "Deploy" && syncPublishTargets();\n}\n\nfunction handleParentCheckedStatus(item: ITableData) {\n    item.disabled = item.children && (item.children.length == 0 || !item.children?.some(child => !child.disabled))\n    item.allChildChecked = item.children && item.children.length > 0 && !item.children.some((child) => !child.checked || child.disabled);\n    item.anyChildChecked = item.children?.some((child) => child.checked && !child.disabled);\n}\n\nfunction syncPublishTargets() {\n    publishTargets.value = []; disabledOptions.value = [];\n\n    const targets = viewModel.user?.selectedOrganization?.actions?.publish?.targets;\n    if (!targets)\n        return;\n\n    const isSelectAnyItem = items.value.find(e => e.anyChildChecked || e.checked);\n    if (!isSelectAnyItem) {\n        publishTargets.value = Object.entries(targets).map(e => cloudTargetMap(e[0])!);\n        const disabledOptionList = Array<IDisabledOptions>();\n        for (let i = 0; i < publishTargets.value.length; i++) {\n            disabledOptionList.push({ index: i, cause: "You need to include items to publish." })\n        }\n        disabledOptions.value = disabledOptionList;\n        return;\n    }\n\n    const checkedPublishTargets = checkAndSetDisabledCauses(targets);\n    const sortedTargets = checkedPublishTargets.sort((e, f) => (!e.cause === !f.cause) ? 0 : e.cause ? 1 : -1);\n\n    const disabledOptionList = Array<IDisabledOptions>();\n    for (let i = 0; i < sortedTargets.length; i++) {\n        const cause = sortedTargets[i].cause;\n        if (cause) disabledOptionList.push({ index: i, cause })\n    }\n    disabledOptions.value = disabledOptionList;\n    publishTargets.value = sortedTargets.map(e => e.optionName);\n\n    selectedTarget.value = !sortedTargets[0].cause ? sortedTargets[0].optionName : "";\n}\n\nfunction checkAndSetDisabledCauses(targets: Record<keyof IOrganizationCloud, boolean>) {\n    const list = Array<{ optionName: string, cause?: string }>();\n\n    Object.keys(targets).forEach(e => {\n        const key = e as keyof IOrganizationCloud;\n        const value = targets[key];\n        const optionName = cloudTargetMap(key)!;\n        if (!value)\n            return list.push({ optionName, cause: "You are not authorized to publish to this target." });\n\n\n        switch (key) {\n            case "azure":\n                const traverseSelectedItems = (status: boolean, items?: Array<ITableData>) => {\n                    if (!items || items.length == 0) { return status; }\n                    for (const item of items) {\n                        if (item.checked || item.anyChildChecked) {\n                            if (item.type == "module") {\n                                status = traverseSelectedItems(status, item.children);\n                            }\n                            if (item.type == "entityDesigner" || item.type == "bpmn" || item.type == "process") {\n                                status = false;\n                                break;\n                            }\n                        }\n\n                    }\n                    return status;\n                }\n\n                const status = traverseSelectedItems(true, items.value);\n                if (!status)\n                    return list.push({ optionName, cause: "Entity and process models cannot be published to this target." });\n                break;\n            case "plateauGCP":\n                if (props.platformSelection.mobile)\n                    return list.push({ optionName, cause: "This target is not available for mobile publishing." });\n                \n                const modulesHasNotAnEDModel =  items.value.find(e => e.type == "module" && e.anyChildChecked && !e.children?.some(c => c.type == "entityDesigner" && c.checked))\n                if (modulesHasNotAnEDModel)\n                    return list.push({optionName, cause: `This target not available. Selected module \'${modulesHasNotAnEDModel.name}\' has not any Data Model.`})\n                break;\n        }\n\n        list.push({ optionName });\n    })\n\n    return list;\n}\n\nfunction versionDialog(item: ITableData) {\n    const clickedNode = { id: item.id, state: { checked: item.checked }, text: item.name, type: item.type, version: item.version };\n    const hasAnyVersion = modelHistories.value?.has(item.id);\n    const options = { clickedNode, cb: (version: string) => { item.version = version } } as any;\n    if (hasAnyVersion) {\n        options.versions = modelHistories.value?.get(item.id)\n    }\n    dialog.showDialog(\n        defineAsyncComponent(() => import("../../application/modelVersionDialog.vue")),\n        { closable: true, title: "Change Version", width: "900px", maxHeight: "500px", overflow: "auto" }, options\n    );\n}\n\nfunction close() {\n    emit("close");\n}\n\nasync function save() {\n    executor.execute(\n        async () => {\n            const initAsGroup = async () => {\n                const groupID = CryptoHelper.CreateGuid();\n                await initHistory(groupID);\n                await packJob(groupID);\n                return groupID;\n            }\n\n            switch (props.screenType) {\n                case "Export":\n                    const groupID = await initAsGroup();\n                    await createExportJob(groupID);\n                    break;\n                case "Deploy":\n                    if (props.platformSelection.mobile)\n                        return await createAzureDeploy();\n                    switch (cloudTargetMap(selectedTarget.value!, true) as keyof IOrganizationCloud) {\n                        case "plateauGCP":\n                            const groupID = await initAsGroup();\n                            await createDeployJob(groupID);\n                            break;\n                        case "azure":\n                            await createAzureDeploy();\n                            break;\n                    }\n            }\n            emit("close");\n        },\n        { loading: true });\n}\n\nasync function createAzureDeploy() {\n    const deployItems: Array<IExportItem> = [];\n    const itemIdObj: Record<string, { item: IModel, path: string }> = {};\n\n    viewModelManager.flatMapItems(viewModel.studio.items, (item, path) => {\n        if (item.objectType != "model") { return; }\n        itemIdObj[item.ID] = { item, path };\n        return item;\n    });\n\n    const traverseSelectedItems = (items?: Array<ITableData>) => {\n        if (!items || items.length == 0) { return; }\n        items.filter(e => e.checked || e.anyChildChecked).forEach(item => {\n            if (item.type == "module") {\n                traverseSelectedItems(item.children);\n                return;\n            }\n\n            const itemMap = itemIdObj[item.id];\n\n            const deployItem: IExportItem = {\n                id: item.id,\n                name: jobUtils.getFileFullname(itemMap.item),\n                path: itemMap.path,\n                type: jobUtils.getItemType(itemMap.item),\n                ver: item.version || "latest",\n                isRootPage: itemMap.item.isRootPage,\n                ownerType: \'application\',\n                ownerName: viewModel.studio.appName,\n                size: itemMap.item.size,\n            };\n            deployItems.push(deployItem)\n        });\n    };\n\n    traverseSelectedItems(items.value);\n\n    await deployJobsUseCase.createAppDeployJob(deployItems, props.platformSelection);\n}\n\nasync function initHistory(groupID: string) {\n    return qcloudApi.initPublishHistory({\n        appID: viewModel.studio.appId,\n        ID: groupID,\n        isMultiStep: true,\n        type: props.screenType == "Deploy" ? "publish" : "download"\n    });\n}\n\nfunction isUsingPlateau() {\n    const applications = viewModel.user!.selectedOrganization!.applications;\n\n    if (!applications || (!applications.entity && !applications.process && !applications.bpmn))\n        return false;\n\n    return true;\n}\n\nfunction getItemPath(asset: ITableData, ownerName: string) {\n    if (isUsingPlateau())\n        return "";\n    if (asset.type == "qjson")\n        return ownerName;\n    return "";\n}\n\nfunction isUISettings(asset: ITableData) {\n    return asset.name == "UI Settings";\n}\n\n\nasync function packJob(groupID: string) {\n    let exportItemMap = new Map<string, Array<IExportItem>>();\n\n    items.value.forEach((asset) => {\n        if (asset.checked) {\n            //QUI\n            if (asset.type == \'qjson\') {\n                const isThisrootPage = viewModel.studio.items.find(i => i.objectType == "model" && i.modelType == "qjson" && (i.additionals as IQJsonAdditionals).isRootPage && i.ID == asset.id);\n\n                const obj: IExportItem = {\n                    id: asset.id,\n                    ver: asset.version!,\n                    type: jobUtils.getItemType({ usageType: asset.usageType, type: asset.type } as IExportViewItem),\n                    path: "",\n                    name: jobUtils.getFileFullname({ usageType: asset.usageType, type: asset.type, name: asset.name } as IExportViewItem),\n                    ownerType: \'application\',\n                    ownerName: viewModel.studio.appName,\n                    isRootPage: isThisrootPage ? true : undefined,\n                };\n\n                let applicationModels = exportItemMap.get(viewModel.studio.appName);\n                if (applicationModels && applicationModels.length > 0) {\n                    applicationModels.push(obj);\n                    exportItemMap.set(viewModel.studio.appName, applicationModels);\n                }\n                else\n                    exportItemMap.set(viewModel.studio.appName, [obj]);\n                return;\n            }\n        }\n        if (asset.anyChildChecked && asset.children) {\n            let checkedItems = Array<IExportItem>();\n            asset.children!.forEach(child => {\n                if (!child.checked || child.type == "module")\n                    return;\n                const exportItem: IExportItem = {\n                    id: child.id,\n                    ver: child.version!,\n                    type: jobUtils.getItemType({ usageType: child.usageType, type: child.type, name: child.name } as IExportViewItem),\n                    path: !isUISettings(asset) ? getItemPath(child, asset.name) : "",\n                    name: jobUtils.getFileFullname({ usageType: child.usageType, type: child.type, name: child.name } as IExportViewItem),\n                    ownerType: isUISettings(asset) || !isUsingPlateau() ? "application" : (asset.type === \'module\' ? \'module\' : \'application\'),\n                    ownerName: isUISettings(asset) || !isUsingPlateau() ? viewModel.studio.appName : asset.name\n                };\n                if (exportItem.type == "entityDesigner")\n                    exportItem.entityGenerationDomain = viewModel.user!.selectedOrganization!.actions?.entityGenerationDomain;\n                checkedItems.push(exportItem);\n            });\n\n            if (checkedItems.length > 0) {\n                if (!isUISettings(asset) && isUsingPlateau())\n                    exportItemMap.set(asset.name, checkedItems);\n                else {\n                    let applicationModels = exportItemMap.get(viewModel.studio.appName);\n                    if (applicationModels && applicationModels.length > 0) {\n                        applicationModels.forEach(e => checkedItems.push(e));\n                    }\n                    exportItemMap.set(viewModel.studio.appName, checkedItems);\n                }\n            }\n\n        }\n    })\n\n    let jobs = Array<ICreateExportJobParam>();\n    exportItemMap.forEach((v, k) => {\n        jobs.push({\n            appID: viewModel.studio.appId,\n            exportType: "qui",\n            selectionData: v,\n            layer: 0,\n            groupID: groupID\n        })\n    })\n\n    await packJobsUseCase.createPackJobs(jobs);\n}\n\nasync function createExportJob(groupID: string) {\n    await executor.executeUseCase<ICreateExportJob>(ICreateExportJob, {\n        appID: viewModel.studio.appId,\n        exportType: "qui",\n        selectionData: [],\n        layer: 1,\n        groupID: groupID\n    });\n}\n\nasync function createDeployJob(groupID: string) {\n    //1-(n) L1- deployJob(build)\n    let packages = await qcloudApi.getExportJobsByGroupId({ groupID })\n        .then(jobs => jobs.jobs.filter(e => !isExternalModule(e.jobData as IExportJobData)).map(e => {\n            const jobData = e.jobData as IExportJobData;\n            return {\n                ownerName: jobData.items[0].ownerName,\n                jobID: e.jobID,\n                type: jobData.items[0].ownerType,\n                mainDir: getDeployableArchiveRoot(jobData)\n            }\n        }));\n\n    if (!packages || packages.length <= 0)\n        return;\n\n    let buildJobs = Array<ICreateDeployJobParam>();\n    packages.forEach(pack => {\n        buildJobs.push({\n            appID: viewModel.studio.appId,\n            type: "build",\n            package: {\n                type: pack.type as DeployType,\n                name: pack.ownerName!,\n                mainDir: pack.mainDir!,\n                zip: `${pack.jobID}.zip`,\n            },\n            layer: 1,\n            groupID: groupID\n        })\n    })\n\n    await deployJobsUseCase.createBuildJobs(buildJobs);\n\n    //2-(1) L2- deployJob(deployment)\n    let jobParam: ICreateDeployJobParam = {\n        appID: viewModel.studio.appId,\n        type: "deployment",\n        deployConfig: {\n            process: {\n                configModelIDs: getProcessConfigList(),\n                enabled: items.value.filter(asset => asset.checked && asset.children && asset.children.filter(child => child.checked && child.type == "bpmn")).length > 0\n            }\n        },\n        layer: 2,\n        groupID: groupID\n    }\n\n    await deployJobsUseCase.startDeploymentJob(jobParam);\n}\n\nfunction isExternalModule(jobData: IExportJobData) {\n    //FIXME: external modules may be dynamic\n    return jobData.items[0].ownerType == "module" && jobData.items[0].ownerName == "processmanager";\n}\n\nfunction getProcessConfigList() {\n    let processConfigList = Array<IProcessConfigModelItem>();\n    items.value.forEach((asset) => {\n        if (asset.checked && asset.children) {\n            const usingService = asset.children.find(c => c.type == "entityDesigner");\n            if (!usingService)\n                return;\n\n            const serviceName = PlateauHelper.getServiceNameFromModel(usingService.name);\n            asset.children.forEach(child => {\n                if (child.checked && child.type == "process") {\n                    processConfigList.push({\n                        moduleName: serviceName,\n                        modelId: child.id,\n                        modelName: child.name\n                    })\n                }\n            })\n        }\n    })\n    return processConfigList;\n}\n\nfunction getDeployableArchiveRoot(jobData: IExportJobData) {\n    //FIXME: change external modules\n    if (jobData.items[0].ownerName == "processmanager")\n        return "";\n    if (jobData.items[0].ownerType == "module") {\n        let edModel = jobData.items.find(e => e.type == "entityDesigner");\n        if (!edModel)\n            throw new Error("!!! this module cannot deploy. Because its have not a service");\n        return PlateauHelper.getServiceNameFromModel(edModel.name);\n    }\n    return PlateauHelper.getQuiPackageNameFromAppName(jobData.app.name);\n}\n\nfunction cloudTargetMap(name: string, pureVal: boolean = false) {\n    const map: Record<keyof IOrganizationCloud, string> = { azure: "Public Cloud", plateauGCP: "Plateau Platform Playground" };\n    if (pureVal) {\n        return Object.keys(map).find(e => {\n            if (map[e as keyof IOrganizationCloud] === name) {\n                return true;\n            }\n        })\n    } else {\n        let key = Object.keys(map).includes(name);\n        if (!key)\n            return;\n        return map[name as keyof IOrganizationCloud];\n    }\n}\n\nfunction onTargetSelect(value: string) {\n    selectedTarget.value = value\n}\n\n<\/script>\n\n\n<style scoped>\n.container {\n    padding: 32px 20px 20px;\n}\n\n.settings-container {\n    position: relative;\n    top: 0px;\n    left: 0px;\n}\n\n.custom-text {\n    /* position: absolute; */\n    font-family: \'Roboto\';\n    font-style: normal;\n    font-weight: 500;\n    font-size: 15px;\n    line-height: 18px;\n    /* left: 24px; */\n    color: #212121;\n}\n\n/* .custom-text.title{\n    top: 92px;\n}\n\n.custom-text.environment{\n    top: 174px;\n} */\n\n.radio-button {\n    position: absolute;\n    top: 60px;\n    left: 20px;\n    cursor: pointer;\n}\n\n.radio-text {\n    position: absolute;\n    top: 59px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n    user-select: none;\n    cursor: pointer;\n}\n\n.existing-app-url {\n    position: absolute;\n    width: 760px;\n    height: 40px;\n    top: 114px;\n    left: 20px;\n    background: #ffffff 0% 0% no-repeat padding-box;\n    border: 1px solid #bcbcbc;\n    border-radius: 4px;\n    font: normal normal normal 14px/19px Roboto;\n    letter-spacing: 0px;\n    padding: 10px 0px 10px 10px;\n}\n\n.url-error {\n    border: 1px solid red;\n}\n\n.url-disable {\n    opacity: 0.5;\n}\n\n.existing-app-url::placeholder {\n    color: #bcbcbc;\n    user-select: none;\n}\n\n.modules-selected-checkbox {\n    cursor: pointer;\n}\n\n.modules-selected-text {\n    font: normal normal normal 14px/19px Roboto;\n    color: #757575;\n    margin: 0 0 13px 30px;\n    ;\n}\n\n/* .modules-selected-text.deploy {\n    top: 257px;\n} */\n\n.text-number {\n    font: normal normal bold 14px/19px Roboto;\n    color: #212121;\n}\n\n.modules-datatable {\n    width: 760px;\n    height: 288px;\n    border: 1px solid #bcbcbc;\n    overflow-x: hidden;\n    overflow-y: auto;\n    margin-bottom: 20px;\n}\n\n/* .modules-datatable.deploy {\n    top: 286px;\n} */\n\n.modules-datatable::-webkit-scrollbar {\n    width: 4px;\n}\n\n.modules-datatable::-webkit-scrollbar-thumb {\n    background: #bcbcbc 0% 0% no-repeat padding-box;\n    border-radius: 10px;\n}\n\n.modules-datatable::-webkit-scrollbar-thumb:hover {\n    background: #555;\n}\n\n.row-container {\n    width: 100%;\n    height: 36px;\n    position: relative;\n    background: #ffffff 0% 0% no-repeat padding-box;\n    border: 1px solid #e0e0e0;\n}\n\n.chevron {\n    position: absolute;\n    left: 4px;\n    color: #757575;\n    font-size: 24px;\n}\n\n.chevron.disabled {\n    pointer-events: none;\n    color: #D5D5D5;\n}\n\n.module-checkbox {\n    position: absolute;\n    top: 10px;\n    left: 43px;\n    cursor: pointer;\n}\n\n.module-name {\n    position: absolute;\n    top: 9px;\n    left: 69px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n}\n\n.module-name.disabled {\n    color: #D5D5D5;\n}\n\n.model-checkbox {\n    position: absolute;\n    top: 10px;\n    left: 59px;\n    cursor: pointer;\n}\n\n.model-icon {\n    position: absolute;\n    width: 16px;\n    height: 16px;\n    top: 6px;\n    left: 85px;\n}\n\n.app-tier-model-icon {\n    position: absolute;\n    width: 16px;\n    height: 16px;\n    top: 6px;\n    left: 69px;\n}\n\n.app-tier-model-name {\n    position: absolute;\n    top: 10px;\n    left: 87px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n}\n\n.app-tier-model-name.disabled {\n    color: #D5D5D5;\n}\n\n.model-name {\n    position: absolute;\n    top: 9px;\n    left: 103px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n}\n\n.model-name.disabled {\n    color: #D5D5D5;\n}\n\n.version-text {\n    margin: 10px 7px 10px auto;\n    display: table;\n    font: normal normal normal 12px/16px Roboto;\n    color: #757575;\n    cursor: pointer;\n    user-select: none;\n}\n\n.version-text.disabled {\n    pointer-events: none;\n    cursor: pointer;\n}\n\n.version-icon {\n    font: normal normal normal 16px/19px Material Design Icons;\n    color: #D5D5D5;\n}\n\n.version-icon.disabled {\n    font: normal normal normal 16px/19px Material Design Icons;\n    color: #EEEEEE;\n    pointer-events: none;\n    cursor: pointer;\n}\n\n.footer {\n    position: relative;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: end;\n}\n\n.footer.deploy {\n    position: relative;\n    width: 100%;\n}\n\n.footer.export {\n    margin-top: 102px;\n}\n\n.cancel-button {\n    border-radius: 4px;\n    user-select: none;\n    font-style: normal;\n    font-weight: 500;\n    font-family: "ROBOTO";\n    font-size: 15px;\n    color: #757575;\n    padding: 10px 16px;\n    cursor: pointer;\n}\n\n\n\n.save-button {\n    background: #151233 0% 0% no-repeat padding-box;\n    border-radius: 4px;\n    user-select: none;\n    font-weight: 500;\n    font-size: 15px;\n    color: #ffffff;\n    padding: 10px 16px;\n    cursor: pointer;\n}\n\n.mobile-publish-text,\n.web-publish-text {\n    padding: 5px 12px;\n    margin-bottom: 52px;\n    width: 100%;\n    color: #757575;\n    font-size: 14px;\n    background: #F5F5FA;\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n}\n\n.mobile-publish-text i,\n.web-publish-text i {\n    font-size: 24px;\n    color: #151233;\n    margin-right: 4px;\n}\n\n.save-button.deploy {\n    padding: 10px 16px;\n}\n\n.button-disable .save-button {\n    opacity: 0.5;\n}\n\n.button-disable .save-button:hover+.button-tooltip,\n.start-screen:hover .button-tooltip,\n.publish-info:hover .button-tooltip {\n    visibility: visible;\n    transition: opacity 0.3s ease-out 1s;\n    opacity: 1;\n}\n\n.button-tooltip {\n    visibility: hidden;\n    position: absolute;\n    background: #757575;\n    color: #FFFFFF;\n    font-size: 11px;\n    font-family: \'Roboto\';\n    text-align: center;\n    border-radius: 4px;\n    letter-spacing: 0.2px;\n    padding: 6px 8px 6px 8px;\n    top: 56px;\n    left: 63px;\n    opacity: 0;\n}\n\n.publish-info {\n    color: #757575;\n    font-size: 20px;\n    margin-left: 10px;\n}\n\n.qjson-color {\n    color: #449dd1;\n}\n\n.yaml-color {\n    color: #449dd1;\n}\n\n.js-color {\n    color: #449dd1;\n}\n\n.process-color {\n    color: #007c77;\n}\n\n.bpmn-color {\n    color: #007c77;\n}\n\n.entity-designer-color {\n    color: #e9724c;\n}\n\n.select-environment {\n    width: 100%;\n    font-size: 15px;\n    height: 40px;\n    line-height: 40px;\n    margin-top: 4px\n}\n</style>\n\n<style>\n.selected-environment {\n    background-color: transparent;\n    border-radius: 4px;\n    border: 1px solid #BCBCBC;\n    color: #212121;\n    padding-left: 12px;\n}\n\n.custom-placeholder:empty:before {\n    color: #BCBCBC !important;\n    font-weight: 400;\n}\n\n.custom-select .items .option {\n    font-size: 14px;\n    padding-left: 12px;\n    line-height: 32px;\n}\n\n.custom-select .items .option:hover {\n    background-color: #EEEEEE;\n    color: #212121;\n}\n\n.custom-select .items .option.disabled:hover {\n    background-color: #FFFFFF;\n    color: #212121;\n}\n\n.custom-select.select-environment .items {\n    margin-top: 4px;\n    color: #212121;\n    border-radius: 4px;\n    border: 1px solid #E3E3E3;\n    overflow: hidden;\n    background-color: #FFFFFF;\n    box-shadow: 1px 2px 4px rgba(0, 0, 0, 0.2);\n    position: static !important;\n}\n</style>\n'],sourceRoot:""}]);const l=s},9980:(e,n,t)=>{t.d(n,{Z:()=>l});var o=t(4663),i=t.n(o),a=t(7638),s=t.n(a)()(i());s.push([e.id,"\n.selected-environment {\n    background-color: transparent;\n    border-radius: 4px;\n    border: 1px solid #BCBCBC;\n    color: #212121;\n    padding-left: 12px;\n}\n.custom-placeholder:empty:before {\n    color: #BCBCBC !important;\n    font-weight: 400;\n}\n.custom-select .items .option {\n    font-size: 14px;\n    padding-left: 12px;\n    line-height: 32px;\n}\n.custom-select .items .option:hover {\n    background-color: #EEEEEE;\n    color: #212121;\n}\n.custom-select .items .option.disabled:hover {\n    background-color: #FFFFFF;\n    color: #212121;\n}\n.custom-select.select-environment .items {\n    margin-top: 4px;\n    color: #212121;\n    border-radius: 4px;\n    border: 1px solid #E3E3E3;\n    overflow: hidden;\n    background-color: #FFFFFF;\n    box-shadow: 1px 2px 4px rgba(0, 0, 0, 0.2);\n    position: static !important;\n}\n","",{version:3,sources:["webpack://./src/presentation/vue3/components/dialogs/publish/publishDialog.vue"],names:[],mappings:";AA2nCA;IACI,6BAA6B;IAC7B,kBAAkB;IAClB,yBAAyB;IACzB,cAAc;IACd,kBAAkB;AACtB;AAEA;IACI,yBAAyB;IACzB,gBAAgB;AACpB;AAEA;IACI,eAAe;IACf,kBAAkB;IAClB,iBAAiB;AACrB;AAEA;IACI,yBAAyB;IACzB,cAAc;AAClB;AAEA;IACI,yBAAyB;IACzB,cAAc;AAClB;AAEA;IACI,eAAe;IACf,cAAc;IACd,kBAAkB;IAClB,yBAAyB;IACzB,gBAAgB;IAChB,yBAAyB;IACzB,0CAA0C;IAC1C,2BAA2B;AAC/B",sourcesContent:['<template>\n    <div class="container">\n        <div>\n            <CheckboxComp :class="[\'modules-selected-checkbox\', props.screenType == \'Deploy\' ? \'deploy\' : \'\']"\n                :minus="mainCheckboxState == false" :check="mainCheckboxState == true"\n                @click="handleModuleCountCheckboxEvent(mainCheckboxState == undefined)" />\n            <div :class="[\'modules-selected-text\', props.screenType == \'Deploy\' ? \'deploy\' : \'\']">\n                <span class="text-number">{{  allChildCheckedModulesCount + anyChildCheckedModulesCount + checkedRootLevelModelsCount }}</span>\n                of <span class="text-number">{{ totalRootLevelCount }}</span> items selected\n            </div>\n        </div>\n\n        <div :class="[\'modules-datatable\', props.screenType == \'Deploy\' ? \'deploy\' : \'\']">\n            <div v-for="item in items">\n                <div v-if="item?.type == \'module\'">\n                    <div class="row-container">\n                        <i :class="\'mdi mdi-menu\' + (item.collapsed ? \'-right\' : \'-down\') + \' chevron\' + (!item.children || item.children.length == 0 ? \' disabled\': \'\')"\n                            @click="handleCollapse(item)" />\n                        <CheckboxComp class="module-checkbox" :check="item.allChildChecked"\n                            :minus="!item.allChildChecked && item.anyChildChecked" :disabled="item.disabled"\n                            @click="handleItemCheckEvent(item)" />\n                        <span :class="[\'module-name\', item.disabled ? \' disabled\': \'\']">{{ item.name }}</span>\n                    </div>\n                    <div class="row-container" v-show="!item.collapsed" v-for="child in item?.children">\n                        <CheckboxComp class="model-checkbox" :check="child.checked" :disabled="child.disabled"\n                            @click="handleItemCheckEvent(child)" />\n                        <i v-if="child.type == \'qjson\'" class="mdi mdi-palette qjson-color model-icon" />\n                        <i v-if="child.type == \'yaml\'" class="mdi mdi-cog-outline yaml-color model-icon" />\n                        <i v-if="child.type == \'js\' || child?.type == \'css\'"\n                            class="mdi mdi-cog-outline js-color model-icon" />\n                        <i v-if="child.type == \'process\'" class="mdi mdi-auto-fix process-color model-icon" />\n                        <i v-if="child.type == \'bpmn\'" class="mdi mdi-vector-polyline bpmn-color model-icon" />\n                        <i v-if="child.type == \'entityDesigner\'"\n                            class="mdi mdi-database entity-designer-color model-icon" />\n                        <i v-if="child.type == \'flow\'" class="mdi mdi-step-forward bpmn-color model-icon" />\n                        <span :class="[\'model-name\', child.disabled ? \' disabled\' : \'\']">{{ child.name }}</span>\n                        <div v-if="!child.usageType" :class="[\'version-text\', child.disabled ? \'disabled\' : \'\']" @click="versionDialog(child)">\n                            {{ child.version ? child.version : \'No version\' }} <i v-if="!child.usageType" :class="[\'mdi mdi-pencil-outline version-icon\', child.disabled ? \'disabled\' : \'\']"></i>\n                        </div>\n                    </div>\n                </div>\n                <div v-else>\n                    <div class="row-container">\n                        <CheckboxComp class="module-checkbox" :check="item?.checked" :disabled="item.disabled"\n                            @click="handleItemCheckEvent(item)" />\n                        <i v-if="item?.type == \'qjson\'" class="mdi mdi-palette qjson-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'yaml\'" class="mdi mdi-cog-outline yaml-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'js\' || item?.type == \'css\'"\n                            class="mdi mdi-cog-outline js-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'process\'" class="mdi mdi-auto-fix process-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'bpmn\'" class="mdi mdi-vector-polyline bpmn-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'entityDesigner\'"\n                            class="mdi mdi-database entity-designer-color app-tier-model-icon" />\n                        <i v-if="item?.type == \'flow\'" class="mdi mdi-step-forward bpmn-color app-tier-model-icon" />\n                        <span class="app-tier-model-name">{{ item?.name }}\n                            <span class="start-screen" v-if="startScreen?.ID == item.id">\n                                <i class="mdi mdi-home-outline"></i>\n                                <span class="button-tooltip" style="top: -30px; left: 2px; z-index: 1; width: 80px;">Start\n                                    Screen</span>\n                            </span>\n                        </span>\n\n                        <span v-if="!item.usageType" :class="[\'version-text\', item.disabled ? \'disabled\' : \'\']" @click="versionDialog(item)">\n                            {{ item.version ? item.version : \'No version\' }} <i v-if="!item.usageType" :class="[\'mdi mdi-pencil-outline version-icon\', item.disabled ? \'disabled\' : \'\']"></i>\n                        </span>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div v-if="props.screenType == \'Deploy\' && props.platformSelection.web" style="margin-bottom: 102px">\n            <div style="display: flex; align-items: center;">\n                <span class="custom-text environment"> Publish To </span>\n                <span class="publish-info">\n                    <i class="mdi mdi-information"></i>\n                    <span class="button-tooltip" style="top: 460px; left: 96px; z-index: 1; width: 231px;">Publish To\n                        options may change depending on the module type you choose.</span>\n                </span>\n            </div>\n\n            <CustomSelect :options="publishTargets" @input="onTargetSelect" :selectedOption="selectedTarget"\n                :default="selectedTarget" :disabledOptions="disabledOptions" selectedClass="selected-environment"\n                placeholder="Select the publish environment of your application" class="select-environment">\n            </CustomSelect>\n        </div>\n        <div v-if="props.screenType == \'Deploy\' && !props.platformSelection.web && props.platformSelection.mobile"\n            class="mobile-publish-text">\n            <i class="mdi mdi-information"></i>\n            <span>Models and static files of your mobile application will be served from Public Cloud.</span>\n\n        </div>\n        <div :class="[\'footer\', props.screenType == \'Deploy\' ? \'deploy\' : \'export\']">\n            <div :class="[\'cancel-button\', props.screenType == \'Deploy\' ? \'deploy\' : \'\']" @click="close">Cancel</div>\n            <div v-if="props.screenType == \'Export\'" :class="(saveButtonDisable ? \' button-disable\' : \'\')" @click="save">\n                <div class="save-button ">DOWNLOAD</div>\n            </div>\n            <div v-if="props.screenType == \'Deploy\'" :class="[(saveButtonDisable ? \' button-disable\' : \'\')]" @click="save">\n                <span class="save-button deploy">PUBLISH</span>\n                <span v-if="selectedTarget" class="button-tooltip"\n                    style="top: -46px; left: 648px; z-index: 1; width: 120px;">You need to include your start screen.</span>\n                <span v-if="!selectedTarget" class="button-tooltip"\n                    style="top: -46px; left: 644px; z-index: 1; width: 123px;">You need to select a publish\n                    environment.</span>\n            </div>\n\n        </div>\n    </div>\n</template>\n\n\n<script setup lang="ts">\nimport { CryptoHelper } from "@stechquick/algae/lib/helpers/cryptoHelper";\nimport { container } from "../../../../../domain/core/diContainer";\nimport { IExportViewItem, IModel, IModelHistoryInfo, IModule } from "../../../../../domain/model/models";\nimport { IViewModel } from "../../../../../domain/viewModel/IViewModel";\nimport CheckboxComp from "../../checkboxComp.vue";\nimport { ref, computed, defineAsyncComponent, watch, onMounted, onBeforeMount } from "vue";\nimport { IDialog } from "../../../../../domain/presentation/IDialog";\nimport { IUseCaseExecutor } from "../../../../../domain/useCase/IUseCaseExecutor";\nimport { DeployType, ICreateDeployJobParam, ICreateExportJobParam, IExportItem, IExportJobData, IPlatformSelection, IProcessConfigModelItem } from "../../../../../../../common/qCloudTemp/exporter";\nimport { ICreateExportJob } from "../../../../../domain/useCase/ICreateExportJob";\nimport { IDeployJobs } from "../../../../../domain/useCase/IDeployJobs";\nimport { IQCloudApi } from "../../../../../domain/infrastructure/IQCloudApi";\nimport { IPackJobs } from "../../../../../domain/useCase/IPackJobs";\nimport { IJobUtils } from "../../../../../domain/useCase/IJobUtils";\nimport { IQJsonAdditionals, UsageType } from "../../../../../../../common/qCloudTemp/quickCloud";\nimport { PlateauHelper } from "@stechquick/algae/lib/helpers/plateau/plateauHelper";\nimport { IViewModelManager } from "../../../../../domain/viewModel/IViewModelManager";\nimport CustomSelect from "../../../components/customSelect.vue"\nimport { IOrganizationCloud } from "../../../../../../../common/clean/domain/useCases/ICloudProvider";\nimport { IListMultiModelVersions } from "../../../../../domain/useCase/IListMultiModelVersions";\n\ninterface ITableData {\n    id: string;\n    parentId?: string;\n    collapsed?: boolean;\n    anyChildChecked?: boolean;\n    allChildChecked?: boolean;\n    checked?: boolean;\n    name: string;\n    type: IModel["modelType"] | IModule["objectType"];\n    version?: string;\n    disabled?: boolean | true;\n    children?: Array<ITableData>;\n    usageType?: UsageType;\n}\n\ninterface IDeployScreenAdditionalProps {\n    screenType: "Export" | "Deploy";\n    platformSelection: IPlatformSelection;\n}\n\ninterface IDisabledOptions {\n    index: number\n    cause: string;\n}\n\nconst props = defineProps<IDeployScreenAdditionalProps>();\nconst viewModel = container.resolve<IViewModel>(IViewModel);\nconst viewModelManager = container.resolve<IViewModelManager>(IViewModelManager);\nconst dialog = container.resolve<IDialog>(IDialog);\nconst executor = container.resolve<IUseCaseExecutor>(IUseCaseExecutor);\nconst deployJobsUseCase = container.resolve<IDeployJobs>(IDeployJobs);\nconst qcloudApi = container.resolve<IQCloudApi>(IQCloudApi);\nconst packJobsUseCase = container.resolve<IPackJobs>(IPackJobs);\nconst jobUtils = container.resolve<IJobUtils>(IJobUtils);\nconst emit = defineEmits(["close"]);\nconst items = ref<Array<ITableData>>([]);\nconst validations = ref<boolean>(true);\nconst selectedTarget = ref<string>("");\nconst disabledOptions = ref<Array<IDisabledOptions>>();\nconst publishTargets = ref<Array<string>>();\nconst modelHistories = ref<Map<string, Array<IModelHistoryInfo>>>();\nconst startScreen = ref<IModel>();\n\nonMounted(async () => {\n    await initVersions();\n    handleItems();\n    props.screenType == "Deploy" && syncPublishTargets();\n    validations.value = validate();\n})\n\nconst allChildCheckedModulesCount = computed(() => items.value.filter(e => e.type == "module" && e.allChildChecked).length);\nconst anyChildCheckedModulesCount = computed(() => items.value.filter(e => e.type == "module" && !e.allChildChecked && e.anyChildChecked).length);\nconst checkedRootLevelModelsCount = computed(() => items.value.filter(e => e.type != "module" && e.checked).length);\nconst totalRootLevelCount = computed(() => items.value.length);\nconst saveButtonDisable = computed(() => (props.screenType == "Deploy" && props.platformSelection.web && selectedTarget.value == "") || !validations.value || !items.value.some((item) => item.checked || item.anyChildChecked));\nconst mainCheckboxState = computed(() => items.value.length == allChildCheckedModulesCount.value ? true \n        : (anyChildCheckedModulesCount.value + checkedRootLevelModelsCount.value > 0  ? false : undefined));\n\nfunction validate() {\n    let result = true;\n    const modules = items.value.filter(e => e.type == "module" && e.anyChildChecked);\n    const appLayerItems = items.value.filter(e => e.type == "qjson" && e.checked);\n\n    startScreen.value = (viewModel.studio.items as Array<IModel>).find(item => item.isRootPage && items.value.find(e => e.id == item.ID)?.checked);\n    if(!startScreen.value)\n        return false;\n\n    if (props.screenType == "Deploy") {\n        if (modules.length > 0)\n            result = modules\n                .filter(e => e.name != "processmanager").map(e => e.children).filter(e => !e?.find(f => f.type == "entityDesigner" && f.checked)).length <= 0\n\n        let isApplicationWillDeploy = appLayerItems.length > 0;\n        if (isApplicationWillDeploy) {\n            result = appLayerItems\n                .map(e => viewModel.studio.items.find(item => item.ID == e.id) as IModel)\n                .findIndex(e => ((e.additionals as IQJsonAdditionals).isRootPage)) != -1;\n        }\n    }\n\n    return result;\n}\n\nfunction mobileFilter(model: IModel) {\n    return props.platformSelection.web || !props.platformSelection.mobile ||\n        !(model.modelType == "bpmn" || model.modelType == "entityDesigner" || model.modelType == "process");\n}\n\nasync function initVersions() {\n    const modelIDs = Array<string>();\n    viewModelManager.flatMapItems(viewModel.studio.items, (item, path) => {\n        if (item.objectType != "model") { return; }\n        modelIDs.push(item.ID);\n        return item;\n    });\n\n    modelHistories.value = await executor.executeUseCase<IListMultiModelVersions>(IListMultiModelVersions, { modelIDs });\n}\n\nasync function handleItems() {\n    items.value = viewModel.studio.items\n        .filter((item) => item.objectType == "module" && item.children.length > 0)\n        .map((item) => {\n            const tableData: ITableData = {\n                id: item.ID,\n                collapsed: true,\n                name: item.name,\n                type: "module",\n                children: (item as IModule).children\n                    .filter((child) => child.objectType == "model")\n                    .filter(e => !props || props.screenType == "Export" || mobileFilter(e as IModel))\n                    .map(child => {\n                        const maxVersion = getItemMaxVersion(child as IModel)\n                        return {\n                            id: child.ID,\n                            parentId: item.ID,\n                            checked: maxVersion != undefined,\n                            disabled: !maxVersion,\n                            name: child.name,\n                            type: (child as IModel).modelType,\n                            version: maxVersion\n                        } as ITableData\n                    })\n            }\n            handleParentCheckedStatus(tableData);\n            return tableData;\n        });\n\n    viewModel.studio.items\n        .filter((item) => item.objectType == "model" && item.usageType != "appSettings")\n        .forEach((item) => {\n            const maxVersion = getItemMaxVersion(item as IModel)\n            items.value.push(\n                {\n                    id: item.ID,\n                    checked: maxVersion != undefined,\n                    name: item.name,\n                    disabled: !maxVersion,\n                    type: (item as IModel).modelType,\n                    version: maxVersion,\n                });\n        });\n    const uiSettingsID = CryptoHelper.CreateGuid();\n    const appSettings = viewModel.studio.items.filter((item) => item.objectType == "model" && item.usageType == "appSettings") as Array<IModel>;\n    const uiSettings: ITableData = {\n        id: uiSettingsID,\n        collapsed: true,\n        name: "UI Settings",\n        type: "module",\n        children: appSettings.map(settings => {\n            const maxVersion = getItemMaxVersion(settings as IModel)\n            return {\n                id: settings.ID,\n                parentId: uiSettingsID,\n                name: settings.name,\n                type: (settings as IModel).modelType,\n                checked: maxVersion != undefined,\n                usageType: settings?.usageType,\n                disabled: !maxVersion,\n                version: maxVersion,\n            }\n        }) as Array<ITableData>,\n    };\n    handleParentCheckedStatus(uiSettings);\n    items.value.unshift(uiSettings);\n}\n\nfunction getItemMaxVersion(item: IModel): string | undefined {\n    if (!modelHistories.value?.has(item.ID))\n        return undefined;\n\n    const versions = modelHistories.value.get(item.ID);\n    if (!versions)\n        return undefined;\n\n    const findMaxVersion = (versions: Array<string>) => {\n        const versionNumbers = versions.map(v => {\n            const parts: Array<string> = v.split(".");\n            return parseInt(parts[0]) * 10 + parseInt(parts[1]) * 1;\n        })\n\n        versionNumbers.sort((a, b) => b - a);\n\n        const maxVersion = versionNumbers[0];\n        return `${Math.floor(maxVersion / 10)}.${maxVersion % 10}`;\n    }\n\n    return findMaxVersion(versions.map(e => e.version!));\n\n}\n\nfunction handleModuleCountCheckboxEvent(value: boolean) {\n    items.value.filter(e => !e.disabled).forEach((item) => {\n        item.checked = value;\n        const allItemsCheckable = item.allChildChecked != undefined && item.children && item.children.length > 0 && !item.children.some(c => c.disabled);\n        if (allItemsCheckable) item.allChildChecked = value;\n        if (item.anyChildChecked != undefined) item.anyChildChecked = value;\n        if (item.children) item.children.filter(c => !c.disabled).forEach((child) => (child.checked = value));\n    });\n\n    validations.value = validate();\n    props.screenType == "Deploy" && syncPublishTargets();\n}\n\nfunction handleCollapse(item: ITableData) {\n    item.collapsed = !item.collapsed;\n}\n\nfunction handleItemCheckEvent(item: ITableData) {\n    if(item.disabled)\n        return;\n\n    if (item.type != "module") {\n        item.checked = !item.checked;\n        if (item.parentId) {\n            const parent = items.value.find((i) => i.id == item.parentId)!;\n            handleParentCheckedStatus(parent);\n        }\n    } else {\n        if (item.children && item.children.filter(c => !c.disabled).length > 0) {\n            if (item.anyChildChecked) {\n                item.children?.filter(c => !c.disabled).forEach((child) => (child.checked = false));\n                item.checked = false;\n            } else {\n                item.children?.filter(e => !e.disabled).forEach((child) => (child.checked = true));\n                item.checked = true;\n            }\n            handleParentCheckedStatus(item);\n        }\n        else {\n            item.checked = !item.checked;\n            item.allChildChecked = false;\n        }\n    }\n\n    validations.value = validate();\n    props.screenType == "Deploy" && syncPublishTargets();\n}\n\nfunction handleParentCheckedStatus(item: ITableData) {\n    item.disabled = item.children && (item.children.length == 0 || !item.children?.some(child => !child.disabled))\n    item.allChildChecked = item.children && item.children.length > 0 && !item.children.some((child) => !child.checked || child.disabled);\n    item.anyChildChecked = item.children?.some((child) => child.checked && !child.disabled);\n}\n\nfunction syncPublishTargets() {\n    publishTargets.value = []; disabledOptions.value = [];\n\n    const targets = viewModel.user?.selectedOrganization?.actions?.publish?.targets;\n    if (!targets)\n        return;\n\n    const isSelectAnyItem = items.value.find(e => e.anyChildChecked || e.checked);\n    if (!isSelectAnyItem) {\n        publishTargets.value = Object.entries(targets).map(e => cloudTargetMap(e[0])!);\n        const disabledOptionList = Array<IDisabledOptions>();\n        for (let i = 0; i < publishTargets.value.length; i++) {\n            disabledOptionList.push({ index: i, cause: "You need to include items to publish." })\n        }\n        disabledOptions.value = disabledOptionList;\n        return;\n    }\n\n    const checkedPublishTargets = checkAndSetDisabledCauses(targets);\n    const sortedTargets = checkedPublishTargets.sort((e, f) => (!e.cause === !f.cause) ? 0 : e.cause ? 1 : -1);\n\n    const disabledOptionList = Array<IDisabledOptions>();\n    for (let i = 0; i < sortedTargets.length; i++) {\n        const cause = sortedTargets[i].cause;\n        if (cause) disabledOptionList.push({ index: i, cause })\n    }\n    disabledOptions.value = disabledOptionList;\n    publishTargets.value = sortedTargets.map(e => e.optionName);\n\n    selectedTarget.value = !sortedTargets[0].cause ? sortedTargets[0].optionName : "";\n}\n\nfunction checkAndSetDisabledCauses(targets: Record<keyof IOrganizationCloud, boolean>) {\n    const list = Array<{ optionName: string, cause?: string }>();\n\n    Object.keys(targets).forEach(e => {\n        const key = e as keyof IOrganizationCloud;\n        const value = targets[key];\n        const optionName = cloudTargetMap(key)!;\n        if (!value)\n            return list.push({ optionName, cause: "You are not authorized to publish to this target." });\n\n\n        switch (key) {\n            case "azure":\n                const traverseSelectedItems = (status: boolean, items?: Array<ITableData>) => {\n                    if (!items || items.length == 0) { return status; }\n                    for (const item of items) {\n                        if (item.checked || item.anyChildChecked) {\n                            if (item.type == "module") {\n                                status = traverseSelectedItems(status, item.children);\n                            }\n                            if (item.type == "entityDesigner" || item.type == "bpmn" || item.type == "process") {\n                                status = false;\n                                break;\n                            }\n                        }\n\n                    }\n                    return status;\n                }\n\n                const status = traverseSelectedItems(true, items.value);\n                if (!status)\n                    return list.push({ optionName, cause: "Entity and process models cannot be published to this target." });\n                break;\n            case "plateauGCP":\n                if (props.platformSelection.mobile)\n                    return list.push({ optionName, cause: "This target is not available for mobile publishing." });\n                \n                const modulesHasNotAnEDModel =  items.value.find(e => e.type == "module" && e.anyChildChecked && !e.children?.some(c => c.type == "entityDesigner" && c.checked))\n                if (modulesHasNotAnEDModel)\n                    return list.push({optionName, cause: `This target not available. Selected module \'${modulesHasNotAnEDModel.name}\' has not any Data Model.`})\n                break;\n        }\n\n        list.push({ optionName });\n    })\n\n    return list;\n}\n\nfunction versionDialog(item: ITableData) {\n    const clickedNode = { id: item.id, state: { checked: item.checked }, text: item.name, type: item.type, version: item.version };\n    const hasAnyVersion = modelHistories.value?.has(item.id);\n    const options = { clickedNode, cb: (version: string) => { item.version = version } } as any;\n    if (hasAnyVersion) {\n        options.versions = modelHistories.value?.get(item.id)\n    }\n    dialog.showDialog(\n        defineAsyncComponent(() => import("../../application/modelVersionDialog.vue")),\n        { closable: true, title: "Change Version", width: "900px", maxHeight: "500px", overflow: "auto" }, options\n    );\n}\n\nfunction close() {\n    emit("close");\n}\n\nasync function save() {\n    executor.execute(\n        async () => {\n            const initAsGroup = async () => {\n                const groupID = CryptoHelper.CreateGuid();\n                await initHistory(groupID);\n                await packJob(groupID);\n                return groupID;\n            }\n\n            switch (props.screenType) {\n                case "Export":\n                    const groupID = await initAsGroup();\n                    await createExportJob(groupID);\n                    break;\n                case "Deploy":\n                    if (props.platformSelection.mobile)\n                        return await createAzureDeploy();\n                    switch (cloudTargetMap(selectedTarget.value!, true) as keyof IOrganizationCloud) {\n                        case "plateauGCP":\n                            const groupID = await initAsGroup();\n                            await createDeployJob(groupID);\n                            break;\n                        case "azure":\n                            await createAzureDeploy();\n                            break;\n                    }\n            }\n            emit("close");\n        },\n        { loading: true });\n}\n\nasync function createAzureDeploy() {\n    const deployItems: Array<IExportItem> = [];\n    const itemIdObj: Record<string, { item: IModel, path: string }> = {};\n\n    viewModelManager.flatMapItems(viewModel.studio.items, (item, path) => {\n        if (item.objectType != "model") { return; }\n        itemIdObj[item.ID] = { item, path };\n        return item;\n    });\n\n    const traverseSelectedItems = (items?: Array<ITableData>) => {\n        if (!items || items.length == 0) { return; }\n        items.filter(e => e.checked || e.anyChildChecked).forEach(item => {\n            if (item.type == "module") {\n                traverseSelectedItems(item.children);\n                return;\n            }\n\n            const itemMap = itemIdObj[item.id];\n\n            const deployItem: IExportItem = {\n                id: item.id,\n                name: jobUtils.getFileFullname(itemMap.item),\n                path: itemMap.path,\n                type: jobUtils.getItemType(itemMap.item),\n                ver: item.version || "latest",\n                isRootPage: itemMap.item.isRootPage,\n                ownerType: \'application\',\n                ownerName: viewModel.studio.appName,\n                size: itemMap.item.size,\n            };\n            deployItems.push(deployItem)\n        });\n    };\n\n    traverseSelectedItems(items.value);\n\n    await deployJobsUseCase.createAppDeployJob(deployItems, props.platformSelection);\n}\n\nasync function initHistory(groupID: string) {\n    return qcloudApi.initPublishHistory({\n        appID: viewModel.studio.appId,\n        ID: groupID,\n        isMultiStep: true,\n        type: props.screenType == "Deploy" ? "publish" : "download"\n    });\n}\n\nfunction isUsingPlateau() {\n    const applications = viewModel.user!.selectedOrganization!.applications;\n\n    if (!applications || (!applications.entity && !applications.process && !applications.bpmn))\n        return false;\n\n    return true;\n}\n\nfunction getItemPath(asset: ITableData, ownerName: string) {\n    if (isUsingPlateau())\n        return "";\n    if (asset.type == "qjson")\n        return ownerName;\n    return "";\n}\n\nfunction isUISettings(asset: ITableData) {\n    return asset.name == "UI Settings";\n}\n\n\nasync function packJob(groupID: string) {\n    let exportItemMap = new Map<string, Array<IExportItem>>();\n\n    items.value.forEach((asset) => {\n        if (asset.checked) {\n            //QUI\n            if (asset.type == \'qjson\') {\n                const isThisrootPage = viewModel.studio.items.find(i => i.objectType == "model" && i.modelType == "qjson" && (i.additionals as IQJsonAdditionals).isRootPage && i.ID == asset.id);\n\n                const obj: IExportItem = {\n                    id: asset.id,\n                    ver: asset.version!,\n                    type: jobUtils.getItemType({ usageType: asset.usageType, type: asset.type } as IExportViewItem),\n                    path: "",\n                    name: jobUtils.getFileFullname({ usageType: asset.usageType, type: asset.type, name: asset.name } as IExportViewItem),\n                    ownerType: \'application\',\n                    ownerName: viewModel.studio.appName,\n                    isRootPage: isThisrootPage ? true : undefined,\n                };\n\n                let applicationModels = exportItemMap.get(viewModel.studio.appName);\n                if (applicationModels && applicationModels.length > 0) {\n                    applicationModels.push(obj);\n                    exportItemMap.set(viewModel.studio.appName, applicationModels);\n                }\n                else\n                    exportItemMap.set(viewModel.studio.appName, [obj]);\n                return;\n            }\n        }\n        if (asset.anyChildChecked && asset.children) {\n            let checkedItems = Array<IExportItem>();\n            asset.children!.forEach(child => {\n                if (!child.checked || child.type == "module")\n                    return;\n                const exportItem: IExportItem = {\n                    id: child.id,\n                    ver: child.version!,\n                    type: jobUtils.getItemType({ usageType: child.usageType, type: child.type, name: child.name } as IExportViewItem),\n                    path: !isUISettings(asset) ? getItemPath(child, asset.name) : "",\n                    name: jobUtils.getFileFullname({ usageType: child.usageType, type: child.type, name: child.name } as IExportViewItem),\n                    ownerType: isUISettings(asset) || !isUsingPlateau() ? "application" : (asset.type === \'module\' ? \'module\' : \'application\'),\n                    ownerName: isUISettings(asset) || !isUsingPlateau() ? viewModel.studio.appName : asset.name\n                };\n                if (exportItem.type == "entityDesigner")\n                    exportItem.entityGenerationDomain = viewModel.user!.selectedOrganization!.actions?.entityGenerationDomain;\n                checkedItems.push(exportItem);\n            });\n\n            if (checkedItems.length > 0) {\n                if (!isUISettings(asset) && isUsingPlateau())\n                    exportItemMap.set(asset.name, checkedItems);\n                else {\n                    let applicationModels = exportItemMap.get(viewModel.studio.appName);\n                    if (applicationModels && applicationModels.length > 0) {\n                        applicationModels.forEach(e => checkedItems.push(e));\n                    }\n                    exportItemMap.set(viewModel.studio.appName, checkedItems);\n                }\n            }\n\n        }\n    })\n\n    let jobs = Array<ICreateExportJobParam>();\n    exportItemMap.forEach((v, k) => {\n        jobs.push({\n            appID: viewModel.studio.appId,\n            exportType: "qui",\n            selectionData: v,\n            layer: 0,\n            groupID: groupID\n        })\n    })\n\n    await packJobsUseCase.createPackJobs(jobs);\n}\n\nasync function createExportJob(groupID: string) {\n    await executor.executeUseCase<ICreateExportJob>(ICreateExportJob, {\n        appID: viewModel.studio.appId,\n        exportType: "qui",\n        selectionData: [],\n        layer: 1,\n        groupID: groupID\n    });\n}\n\nasync function createDeployJob(groupID: string) {\n    //1-(n) L1- deployJob(build)\n    let packages = await qcloudApi.getExportJobsByGroupId({ groupID })\n        .then(jobs => jobs.jobs.filter(e => !isExternalModule(e.jobData as IExportJobData)).map(e => {\n            const jobData = e.jobData as IExportJobData;\n            return {\n                ownerName: jobData.items[0].ownerName,\n                jobID: e.jobID,\n                type: jobData.items[0].ownerType,\n                mainDir: getDeployableArchiveRoot(jobData)\n            }\n        }));\n\n    if (!packages || packages.length <= 0)\n        return;\n\n    let buildJobs = Array<ICreateDeployJobParam>();\n    packages.forEach(pack => {\n        buildJobs.push({\n            appID: viewModel.studio.appId,\n            type: "build",\n            package: {\n                type: pack.type as DeployType,\n                name: pack.ownerName!,\n                mainDir: pack.mainDir!,\n                zip: `${pack.jobID}.zip`,\n            },\n            layer: 1,\n            groupID: groupID\n        })\n    })\n\n    await deployJobsUseCase.createBuildJobs(buildJobs);\n\n    //2-(1) L2- deployJob(deployment)\n    let jobParam: ICreateDeployJobParam = {\n        appID: viewModel.studio.appId,\n        type: "deployment",\n        deployConfig: {\n            process: {\n                configModelIDs: getProcessConfigList(),\n                enabled: items.value.filter(asset => asset.checked && asset.children && asset.children.filter(child => child.checked && child.type == "bpmn")).length > 0\n            }\n        },\n        layer: 2,\n        groupID: groupID\n    }\n\n    await deployJobsUseCase.startDeploymentJob(jobParam);\n}\n\nfunction isExternalModule(jobData: IExportJobData) {\n    //FIXME: external modules may be dynamic\n    return jobData.items[0].ownerType == "module" && jobData.items[0].ownerName == "processmanager";\n}\n\nfunction getProcessConfigList() {\n    let processConfigList = Array<IProcessConfigModelItem>();\n    items.value.forEach((asset) => {\n        if (asset.checked && asset.children) {\n            const usingService = asset.children.find(c => c.type == "entityDesigner");\n            if (!usingService)\n                return;\n\n            const serviceName = PlateauHelper.getServiceNameFromModel(usingService.name);\n            asset.children.forEach(child => {\n                if (child.checked && child.type == "process") {\n                    processConfigList.push({\n                        moduleName: serviceName,\n                        modelId: child.id,\n                        modelName: child.name\n                    })\n                }\n            })\n        }\n    })\n    return processConfigList;\n}\n\nfunction getDeployableArchiveRoot(jobData: IExportJobData) {\n    //FIXME: change external modules\n    if (jobData.items[0].ownerName == "processmanager")\n        return "";\n    if (jobData.items[0].ownerType == "module") {\n        let edModel = jobData.items.find(e => e.type == "entityDesigner");\n        if (!edModel)\n            throw new Error("!!! this module cannot deploy. Because its have not a service");\n        return PlateauHelper.getServiceNameFromModel(edModel.name);\n    }\n    return PlateauHelper.getQuiPackageNameFromAppName(jobData.app.name);\n}\n\nfunction cloudTargetMap(name: string, pureVal: boolean = false) {\n    const map: Record<keyof IOrganizationCloud, string> = { azure: "Public Cloud", plateauGCP: "Plateau Platform Playground" };\n    if (pureVal) {\n        return Object.keys(map).find(e => {\n            if (map[e as keyof IOrganizationCloud] === name) {\n                return true;\n            }\n        })\n    } else {\n        let key = Object.keys(map).includes(name);\n        if (!key)\n            return;\n        return map[name as keyof IOrganizationCloud];\n    }\n}\n\nfunction onTargetSelect(value: string) {\n    selectedTarget.value = value\n}\n\n<\/script>\n\n\n<style scoped>\n.container {\n    padding: 32px 20px 20px;\n}\n\n.settings-container {\n    position: relative;\n    top: 0px;\n    left: 0px;\n}\n\n.custom-text {\n    /* position: absolute; */\n    font-family: \'Roboto\';\n    font-style: normal;\n    font-weight: 500;\n    font-size: 15px;\n    line-height: 18px;\n    /* left: 24px; */\n    color: #212121;\n}\n\n/* .custom-text.title{\n    top: 92px;\n}\n\n.custom-text.environment{\n    top: 174px;\n} */\n\n.radio-button {\n    position: absolute;\n    top: 60px;\n    left: 20px;\n    cursor: pointer;\n}\n\n.radio-text {\n    position: absolute;\n    top: 59px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n    user-select: none;\n    cursor: pointer;\n}\n\n.existing-app-url {\n    position: absolute;\n    width: 760px;\n    height: 40px;\n    top: 114px;\n    left: 20px;\n    background: #ffffff 0% 0% no-repeat padding-box;\n    border: 1px solid #bcbcbc;\n    border-radius: 4px;\n    font: normal normal normal 14px/19px Roboto;\n    letter-spacing: 0px;\n    padding: 10px 0px 10px 10px;\n}\n\n.url-error {\n    border: 1px solid red;\n}\n\n.url-disable {\n    opacity: 0.5;\n}\n\n.existing-app-url::placeholder {\n    color: #bcbcbc;\n    user-select: none;\n}\n\n.modules-selected-checkbox {\n    cursor: pointer;\n}\n\n.modules-selected-text {\n    font: normal normal normal 14px/19px Roboto;\n    color: #757575;\n    margin: 0 0 13px 30px;\n    ;\n}\n\n/* .modules-selected-text.deploy {\n    top: 257px;\n} */\n\n.text-number {\n    font: normal normal bold 14px/19px Roboto;\n    color: #212121;\n}\n\n.modules-datatable {\n    width: 760px;\n    height: 288px;\n    border: 1px solid #bcbcbc;\n    overflow-x: hidden;\n    overflow-y: auto;\n    margin-bottom: 20px;\n}\n\n/* .modules-datatable.deploy {\n    top: 286px;\n} */\n\n.modules-datatable::-webkit-scrollbar {\n    width: 4px;\n}\n\n.modules-datatable::-webkit-scrollbar-thumb {\n    background: #bcbcbc 0% 0% no-repeat padding-box;\n    border-radius: 10px;\n}\n\n.modules-datatable::-webkit-scrollbar-thumb:hover {\n    background: #555;\n}\n\n.row-container {\n    width: 100%;\n    height: 36px;\n    position: relative;\n    background: #ffffff 0% 0% no-repeat padding-box;\n    border: 1px solid #e0e0e0;\n}\n\n.chevron {\n    position: absolute;\n    left: 4px;\n    color: #757575;\n    font-size: 24px;\n}\n\n.chevron.disabled {\n    pointer-events: none;\n    color: #D5D5D5;\n}\n\n.module-checkbox {\n    position: absolute;\n    top: 10px;\n    left: 43px;\n    cursor: pointer;\n}\n\n.module-name {\n    position: absolute;\n    top: 9px;\n    left: 69px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n}\n\n.module-name.disabled {\n    color: #D5D5D5;\n}\n\n.model-checkbox {\n    position: absolute;\n    top: 10px;\n    left: 59px;\n    cursor: pointer;\n}\n\n.model-icon {\n    position: absolute;\n    width: 16px;\n    height: 16px;\n    top: 6px;\n    left: 85px;\n}\n\n.app-tier-model-icon {\n    position: absolute;\n    width: 16px;\n    height: 16px;\n    top: 6px;\n    left: 69px;\n}\n\n.app-tier-model-name {\n    position: absolute;\n    top: 10px;\n    left: 87px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n}\n\n.app-tier-model-name.disabled {\n    color: #D5D5D5;\n}\n\n.model-name {\n    position: absolute;\n    top: 9px;\n    left: 103px;\n    font: normal normal normal 14px/19px Roboto;\n    color: #212121;\n}\n\n.model-name.disabled {\n    color: #D5D5D5;\n}\n\n.version-text {\n    margin: 10px 7px 10px auto;\n    display: table;\n    font: normal normal normal 12px/16px Roboto;\n    color: #757575;\n    cursor: pointer;\n    user-select: none;\n}\n\n.version-text.disabled {\n    pointer-events: none;\n    cursor: pointer;\n}\n\n.version-icon {\n    font: normal normal normal 16px/19px Material Design Icons;\n    color: #D5D5D5;\n}\n\n.version-icon.disabled {\n    font: normal normal normal 16px/19px Material Design Icons;\n    color: #EEEEEE;\n    pointer-events: none;\n    cursor: pointer;\n}\n\n.footer {\n    position: relative;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: end;\n}\n\n.footer.deploy {\n    position: relative;\n    width: 100%;\n}\n\n.footer.export {\n    margin-top: 102px;\n}\n\n.cancel-button {\n    border-radius: 4px;\n    user-select: none;\n    font-style: normal;\n    font-weight: 500;\n    font-family: "ROBOTO";\n    font-size: 15px;\n    color: #757575;\n    padding: 10px 16px;\n    cursor: pointer;\n}\n\n\n\n.save-button {\n    background: #151233 0% 0% no-repeat padding-box;\n    border-radius: 4px;\n    user-select: none;\n    font-weight: 500;\n    font-size: 15px;\n    color: #ffffff;\n    padding: 10px 16px;\n    cursor: pointer;\n}\n\n.mobile-publish-text,\n.web-publish-text {\n    padding: 5px 12px;\n    margin-bottom: 52px;\n    width: 100%;\n    color: #757575;\n    font-size: 14px;\n    background: #F5F5FA;\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n}\n\n.mobile-publish-text i,\n.web-publish-text i {\n    font-size: 24px;\n    color: #151233;\n    margin-right: 4px;\n}\n\n.save-button.deploy {\n    padding: 10px 16px;\n}\n\n.button-disable .save-button {\n    opacity: 0.5;\n}\n\n.button-disable .save-button:hover+.button-tooltip,\n.start-screen:hover .button-tooltip,\n.publish-info:hover .button-tooltip {\n    visibility: visible;\n    transition: opacity 0.3s ease-out 1s;\n    opacity: 1;\n}\n\n.button-tooltip {\n    visibility: hidden;\n    position: absolute;\n    background: #757575;\n    color: #FFFFFF;\n    font-size: 11px;\n    font-family: \'Roboto\';\n    text-align: center;\n    border-radius: 4px;\n    letter-spacing: 0.2px;\n    padding: 6px 8px 6px 8px;\n    top: 56px;\n    left: 63px;\n    opacity: 0;\n}\n\n.publish-info {\n    color: #757575;\n    font-size: 20px;\n    margin-left: 10px;\n}\n\n.qjson-color {\n    color: #449dd1;\n}\n\n.yaml-color {\n    color: #449dd1;\n}\n\n.js-color {\n    color: #449dd1;\n}\n\n.process-color {\n    color: #007c77;\n}\n\n.bpmn-color {\n    color: #007c77;\n}\n\n.entity-designer-color {\n    color: #e9724c;\n}\n\n.select-environment {\n    width: 100%;\n    font-size: 15px;\n    height: 40px;\n    line-height: 40px;\n    margin-top: 4px\n}\n</style>\n\n<style>\n.selected-environment {\n    background-color: transparent;\n    border-radius: 4px;\n    border: 1px solid #BCBCBC;\n    color: #212121;\n    padding-left: 12px;\n}\n\n.custom-placeholder:empty:before {\n    color: #BCBCBC !important;\n    font-weight: 400;\n}\n\n.custom-select .items .option {\n    font-size: 14px;\n    padding-left: 12px;\n    line-height: 32px;\n}\n\n.custom-select .items .option:hover {\n    background-color: #EEEEEE;\n    color: #212121;\n}\n\n.custom-select .items .option.disabled:hover {\n    background-color: #FFFFFF;\n    color: #212121;\n}\n\n.custom-select.select-environment .items {\n    margin-top: 4px;\n    color: #212121;\n    border-radius: 4px;\n    border: 1px solid #E3E3E3;\n    overflow: hidden;\n    background-color: #FFFFFF;\n    box-shadow: 1px 2px 4px rgba(0, 0, 0, 0.2);\n    position: static !important;\n}\n</style>\n'],sourceRoot:""}]);const l=s},647:(e,n)=>{n.j=void 0;var t=function(){function e(){}return e.GetRandomWord=function(e,n){return Math.random().toString(e).substring(2,n+2)},e.CreateGuid=function(){var n=this;return[8,4,4,4,6].map((function(e){return n.GetRandomWord(36,e)})).join("-")+(++e.guidCounter%215e7).toString(36)},e.guidCounter=0,e}();n.j=t},3147:(e,n)=>{n.b=void 0;var t=function(){function e(){}return e.purify=function(e){return e.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()},e.getQuiPackageNameFromAppName=function(n){return e.purify(n)+"-qui"},e.getApplicationUINameFromQuiPkg=function(n){return e.purify(n.replace("-qui","ui"))},e.getApplicationHostNamePrefix=function(n){return e.purify(n)+"ui"},e.getServiceNameFromModel=function(n){return e.purify(n.replace(".dm",""))},e}();n.b=t},8246:(e,n,t)=>{t.d(n,{B:()=>o});const o=Symbol.for("IQCloudApi")},9139:(e,n,t)=>{t.d(n,{i:()=>o});const o=Symbol.for("ICreateExportJob")},1705:(e,n,t)=>{t.d(n,{F:()=>o});const o=Symbol.for("IDeployJobs")},1616:(e,n,t)=>{t.d(n,{y:()=>o});const o=Symbol.for("IJobUtils")},2376:(e,n,t)=>{t.d(n,{q:()=>o});const o=Symbol.for("IListMultiModelVersions")},6580:(e,n,t)=>{t.d(n,{k:()=>o});const o=Symbol.for("IPackJobs")},2076:(e,n,t)=>{t.d(n,{Z:()=>E});var o=t(1093),i=t(6190),a=t(3843);const s=e=>((0,o.dD)("data-v-237b87c3"),e=e(),(0,o.Cn)(),e),l=["tabindex"],r={key:0},d=s((()=>(0,o._)("i",{class:"mdi mdi-chevron-down"},null,-1))),c={key:1},p=["data-placeholder"],m=s((()=>(0,o._)("i",{class:"mdi mdi-chevron-down"},null,-1))),u=["onClick"],A=["id"],h={__name:"customSelect",props:{options:{type:Array,required:!0},disabledOptions:{type:Array,required:!1},default:{type:String,required:!1,default:""},selectedOption:{type:String,required:!1},tabindex:{type:Number,required:!1,default:0},placeholder:{type:String,required:!1,default:""},selectedClass:{type:String,required:!0,default:""},extraButton:{type:Boolean,required:!1,default:!1},buttons:{type:Array,required:!1,default:()=>[],validator:e=>e.every((e=>"object"==typeof e&&"string"==typeof e.buttonText&&"string"==typeof e.buttonClass))}},emits:["input"],setup(e,{emit:n}){const t=e,s=(0,a.iH)(!1),h=(0,a.iH)(t.default?t.default:null);(0,o.m0)((()=>{t&&t.selectedOption&&(h.value=t.selectedOption,s.value=!1)}));const b=e=>{const n=t.disabledOptions.find((n=>n.index==e));if(n)return n.cause};return(a,f)=>((0,o.wg)(),(0,o.iD)("div",{class:"custom-select",tabindex:e.tabindex,onBlur:f[2]||(f[2]=e=>s.value=!1)},[(0,o._)("div",{class:(0,i.normalizeClass)(s.value?"open selected "+e.selectedClass:"selected "+e.selectedClass),onClick:f[0]||(f[0]=e=>s.value=!s.value)},[h.value?((0,o.wg)(),(0,o.iD)("div",r,[(0,o.Uk)((0,i.toDisplayString)("object"==typeof h.value?h.value.name:h.value)+" ",1),d])):((0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("span",{contenteditable:"true","data-placeholder":e.placeholder,class:"custom-placeholder"},null,8,p),m]))],2),(0,o._)("div",{class:(0,i.normalizeClass)(["items",{selectHide:!s.value}]),style:(0,i.normalizeStyle)({padding:e.extraButton?"10px 0 0":"10px 0"})},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.options,((e,a)=>((0,o.wg)(),(0,o.iD)("div",{key:a,onClick:t=>(e=>{"object"==typeof e?(n("input",e.id),h.value=e,s.value=!1,n("input",h.value.id)):"string"==typeof e&&(n("input",e),h.value=e,s.value=!1,n("input",h.value))})(e),class:(0,i.normalizeClass)(["option",t.disabledOptions&&b(a)?"disabled":""])},[t.disabledOptions&&b(a)?((0,o.wg)(),(0,o.iD)("span",{key:0,class:"button-tooltip",style:(0,i.normalizeStyle)({top:32*a+85+"px"})},(0,i.toDisplayString)(b(a)),5)):(0,o.kq)("v-if",!0),(0,o._)("div",null,(0,i.toDisplayString)("object"==typeof e?e.name:e),1)],10,u)))),128)),e.extraButton?((0,o.wg)(),(0,o.iD)("div",{key:0,class:"button-div",style:(0,i.normalizeStyle)({borderTop:e.extraButton?"1px solid #EEEEEE":"none"})},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.buttons,((e,n)=>((0,o.wg)(),(0,o.iD)("div",{key:n},[(0,o._)("div",{id:"option-button-"+n,class:(0,i.normalizeClass)(e.buttonClass+" button"),onClick:f[1]||(f[1]=e=>s.value=!1)},(0,i.toDisplayString)(e.buttonText),11,A)])))),128))],4)):(0,o.kq)("v-if",!0)],6)],40,l))}};var b=t(7450),f=t.n(b),y=t(9530),v=t.n(y),g=t(6199),I=t.n(g),C=t(458),x=t.n(C),k=t(2916),D=t.n(k),B=t(2165),w=t.n(B),T=t(5648),M={};M.styleTagTransform=w(),M.setAttributes=x(),M.insert=I().bind(null,"head"),M.domAPI=v(),M.insertStyleElement=D(),f()(T.Z,M),T.Z&&T.Z.locals&&T.Z.locals;const E=(0,t(2525).Z)(h,[["__scopeId","data-v-237b87c3"]])},654:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Ce});var o=t(1093),i=t(6190),a=t(3843),s=t(6233),l=t(647),r=t(5627),d=t(8613),c=t(4137),p=t(1056),m=t(3487),u=t(9139),A=t(1705),h=t(8246),b=t(6580),f=t(1616),y=t(3147),v=t(4848),g=t(2076),I=t(2376);const C=e=>((0,o.dD)("data-v-03dfac29"),e=e(),(0,o.Cn)(),e),x={class:"container"},k={class:"text-number"},D={class:"text-number"},B={key:0},w={class:"row-container"},T=["onClick"],M={class:"row-container"},E={key:0,class:"mdi mdi-palette qjson-color model-icon"},S={key:1,class:"mdi mdi-cog-outline yaml-color model-icon"},j={key:2,class:"mdi mdi-cog-outline js-color model-icon"},P={key:3,class:"mdi mdi-auto-fix process-color model-icon"},U={key:4,class:"mdi mdi-vector-polyline bpmn-color model-icon"},z={key:5,class:"mdi mdi-database entity-designer-color model-icon"},N={key:6,class:"mdi mdi-step-forward bpmn-color model-icon"},F=["onClick"],q={key:1},O={class:"row-container"},J={key:0,class:"mdi mdi-palette qjson-color app-tier-model-icon"},V={key:1,class:"mdi mdi-cog-outline yaml-color app-tier-model-icon"},R={key:2,class:"mdi mdi-cog-outline js-color app-tier-model-icon"},H={key:3,class:"mdi mdi-auto-fix process-color app-tier-model-icon"},L={key:4,class:"mdi mdi-vector-polyline bpmn-color app-tier-model-icon"},Y={key:5,class:"mdi mdi-database entity-designer-color app-tier-model-icon"},G={key:6,class:"mdi mdi-step-forward bpmn-color app-tier-model-icon"},Z={class:"app-tier-model-name"},_={key:0,class:"start-screen"},Q=[C((()=>(0,o._)("i",{class:"mdi mdi-home-outline"},null,-1))),C((()=>(0,o._)("span",{class:"button-tooltip",style:{top:"-30px",left:"2px","z-index":"1",width:"80px"}},"Start Screen",-1)))],W=["onClick"],X={key:0,style:{"margin-bottom":"102px"}},$=(0,o.uE)('<div style="display:flex;align-items:center;" data-v-03dfac29><span class="custom-text environment" data-v-03dfac29> Publish To </span><span class="publish-info" data-v-03dfac29><i class="mdi mdi-information" data-v-03dfac29></i><span class="button-tooltip" style="top:460px;left:96px;z-index:1;width:231px;" data-v-03dfac29>Publish To options may change depending on the module type you choose.</span></span></div>',1),K={key:1,class:"mobile-publish-text"},ee=[C((()=>(0,o._)("i",{class:"mdi mdi-information"},null,-1))),C((()=>(0,o._)("span",null,"Models and static files of your mobile application will be served from Public Cloud.",-1)))],ne=[C((()=>(0,o._)("div",{class:"save-button"},"DOWNLOAD",-1)))],te=C((()=>(0,o._)("span",{class:"save-button deploy"},"PUBLISH",-1))),oe={key:0,class:"button-tooltip",style:{top:"-46px",left:"648px","z-index":"1",width:"120px"}},ie={key:1,class:"button-tooltip",style:{top:"-46px",left:"644px","z-index":"1",width:"123px"}},ae=(0,o.aZ)({__name:"publishDialog",props:{screenType:null,platformSelection:null},emits:["close"],setup(e,{emit:n}){const C=e,ae=r.nC.resolve(d.J),se=r.nC.resolve(v.B),le=r.nC.resolve(p.u),re=r.nC.resolve(m.y),de=r.nC.resolve(A.F),ce=r.nC.resolve(h.B),pe=r.nC.resolve(b.k),me=r.nC.resolve(f.y),ue=(0,a.iH)([]),Ae=(0,a.iH)(!0),he=(0,a.iH)(""),be=(0,a.iH)(),fe=(0,a.iH)(),ye=(0,a.iH)(),ve=(0,a.iH)();(0,o.bv)((async()=>{await async function(){const e=Array();se.flatMapItems(ae.studio.items,((n,t)=>{if("model"==n.objectType)return e.push(n.ID),n})),ye.value=await re.executeUseCase(I.q,{modelIDs:e})}(),async function(){ue.value=ae.studio.items.filter((e=>"module"==e.objectType&&e.children.length>0)).map((e=>{const n={id:e.ID,collapsed:!0,name:e.name,type:"module",children:e.children.filter((e=>"model"==e.objectType)).filter((e=>{return!C||"Export"==C.screenType||(n=e,C.platformSelection.web||!C.platformSelection.mobile||!("bpmn"==n.modelType||"entityDesigner"==n.modelType||"process"==n.modelType));var n})).map((n=>{const t=we(n);return{id:n.ID,parentId:e.ID,checked:null!=t,disabled:!t,name:n.name,type:n.modelType,version:t}}))};return Me(n),n})),ae.studio.items.filter((e=>"model"==e.objectType&&"appSettings"!=e.usageType)).forEach((e=>{const n=we(e);ue.value.push({id:e.ID,checked:null!=n,name:e.name,disabled:!n,type:e.modelType,version:n})}));const e=l.j.CreateGuid(),n=ae.studio.items.filter((e=>"model"==e.objectType&&"appSettings"==e.usageType)),t={id:e,collapsed:!0,name:"UI Settings",type:"module",children:n.map((n=>{const t=we(n);return{id:n.ID,parentId:e,name:n.name,type:n.modelType,checked:null!=t,usageType:null==n?void 0:n.usageType,disabled:!t,version:t}}))};Me(t),ue.value.unshift(t)}(),"Deploy"==C.screenType&&Ee(),Ae.value=Be()}));const ge=(0,o.Fl)((()=>ue.value.filter((e=>"module"==e.type&&e.allChildChecked)).length)),Ie=(0,o.Fl)((()=>ue.value.filter((e=>"module"==e.type&&!e.allChildChecked&&e.anyChildChecked)).length)),Ce=(0,o.Fl)((()=>ue.value.filter((e=>"module"!=e.type&&e.checked)).length)),xe=(0,o.Fl)((()=>ue.value.length)),ke=(0,o.Fl)((()=>"Deploy"==C.screenType&&C.platformSelection.web&&""==he.value||!Ae.value||!ue.value.some((e=>e.checked||e.anyChildChecked)))),De=(0,o.Fl)((()=>ue.value.length==ge.value||!(Ie.value+Ce.value>0)&&void 0));function Be(){let e=!0;const n=ue.value.filter((e=>"module"==e.type&&e.anyChildChecked)),t=ue.value.filter((e=>"qjson"==e.type&&e.checked));return ve.value=ae.studio.items.find((e=>{var n;return e.isRootPage&&(null===(n=ue.value.find((n=>n.id==e.ID)))||void 0===n?void 0:n.checked)})),!!ve.value&&("Deploy"==C.screenType&&(n.length>0&&(e=n.filter((e=>"processmanager"!=e.name)).map((e=>e.children)).filter((e=>!(null==e?void 0:e.find((e=>"entityDesigner"==e.type&&e.checked))))).length<=0),t.length>0&&(e=-1!=t.map((e=>ae.studio.items.find((n=>n.ID==e.id)))).findIndex((e=>e.additionals.isRootPage)))),e)}function we(e){var n;if(!(null===(n=ye.value)||void 0===n?void 0:n.has(e.ID)))return;const t=ye.value.get(e.ID);return t?(e=>{const n=e.map((e=>{const n=e.split(".");return 10*parseInt(n[0])+1*parseInt(n[1])}));n.sort(((e,n)=>n-e));const t=n[0];return`${Math.floor(t/10)}.${t%10}`})(t.map((e=>e.version))):void 0}function Te(e){var n,t;e.disabled||("module"!=e.type?(e.checked=!e.checked,e.parentId&&Me(ue.value.find((n=>n.id==e.parentId)))):e.children&&e.children.filter((e=>!e.disabled)).length>0?(e.anyChildChecked?(null===(n=e.children)||void 0===n||n.filter((e=>!e.disabled)).forEach((e=>e.checked=!1)),e.checked=!1):(null===(t=e.children)||void 0===t||t.filter((e=>!e.disabled)).forEach((e=>e.checked=!0)),e.checked=!0),Me(e)):(e.checked=!e.checked,e.allChildChecked=!1),Ae.value=Be(),"Deploy"==C.screenType&&Ee())}function Me(e){var n,t;e.disabled=e.children&&(0==e.children.length||!(null===(n=e.children)||void 0===n?void 0:n.some((e=>!e.disabled)))),e.allChildChecked=e.children&&e.children.length>0&&!e.children.some((e=>!e.checked||e.disabled)),e.anyChildChecked=null===(t=e.children)||void 0===t?void 0:t.some((e=>e.checked&&!e.disabled))}function Ee(){var e,n,t,o;fe.value=[],be.value=[];const i=null===(o=null===(t=null===(n=null===(e=ae.user)||void 0===e?void 0:e.selectedOrganization)||void 0===n?void 0:n.actions)||void 0===t?void 0:t.publish)||void 0===o?void 0:o.targets;if(!i)return;if(!ue.value.find((e=>e.anyChildChecked||e.checked))){fe.value=Object.entries(i).map((e=>Je(e[0])));const e=Array();for(let n=0;n<fe.value.length;n++)e.push({index:n,cause:"You need to include items to publish."});return void(be.value=e)}const a=function(e){const n=Array();return Object.keys(e).forEach((t=>{const o=t,i=e[o],a=Je(o);if(!i)return n.push({optionName:a,cause:"You are not authorized to publish to this target."});switch(o){case"azure":const e=(n,t)=>{if(!t||0==t.length)return n;for(const o of t)if((o.checked||o.anyChildChecked)&&("module"==o.type&&(n=e(n,o.children)),"entityDesigner"==o.type||"bpmn"==o.type||"process"==o.type)){n=!1;break}return n};if(!e(!0,ue.value))return n.push({optionName:a,cause:"Entity and process models cannot be published to this target."});break;case"plateauGCP":if(C.platformSelection.mobile)return n.push({optionName:a,cause:"This target is not available for mobile publishing."});const t=ue.value.find((e=>{var n;return"module"==e.type&&e.anyChildChecked&&!(null===(n=e.children)||void 0===n?void 0:n.some((e=>"entityDesigner"==e.type&&e.checked)))}));if(t)return n.push({optionName:a,cause:`This target not available. Selected module '${t.name}' has not any Data Model.`})}n.push({optionName:a})})),n}(i),s=a.sort(((e,n)=>!e.cause==!n.cause?0:e.cause?1:-1)),l=Array();for(let e=0;e<s.length;e++){const n=s[e].cause;n&&l.push({index:e,cause:n})}be.value=l,fe.value=s.map((e=>e.optionName)),he.value=s[0].cause?"":s[0].optionName}function Se(e){var n,i;const a={clickedNode:{id:e.id,state:{checked:e.checked},text:e.name,type:e.type,version:e.version},cb:n=>{e.version=n}};(null===(n=ye.value)||void 0===n?void 0:n.has(e.id))&&(a.versions=null===(i=ye.value)||void 0===i?void 0:i.get(e.id)),le.showDialog((0,o.RC)((()=>t.e(9153).then(t.bind(t,9153)))),{closable:!0,title:"Change Version",width:"900px",maxHeight:"500px",overflow:"auto"},a)}function je(){n("close")}async function Pe(){re.execute((async()=>{const e=async()=>{const e=l.j.CreateGuid();return await async function(e){return ce.initPublishHistory({appID:ae.studio.appId,ID:e,isMultiStep:!0,type:"Deploy"==C.screenType?"publish":"download"})}(e),await async function(e){let n=new Map;ue.value.forEach((e=>{if(e.checked&&"qjson"==e.type){const t=ae.studio.items.find((n=>"model"==n.objectType&&"qjson"==n.modelType&&n.additionals.isRootPage&&n.ID==e.id)),o={id:e.id,ver:e.version,type:me.getItemType({usageType:e.usageType,type:e.type}),path:"",name:me.getFileFullname({usageType:e.usageType,type:e.type,name:e.name}),ownerType:"application",ownerName:ae.studio.appName,isRootPage:!!t||void 0};let i=n.get(ae.studio.appName);i&&i.length>0?(i.push(o),n.set(ae.studio.appName,i)):n.set(ae.studio.appName,[o])}else if(e.anyChildChecked&&e.children){let t=Array();if(e.children.forEach((n=>{var o;if(!n.checked||"module"==n.type)return;const i={id:n.id,ver:n.version,type:me.getItemType({usageType:n.usageType,type:n.type,name:n.name}),path:Fe(e)?"":Ne(n,e.name),name:me.getFileFullname({usageType:n.usageType,type:n.type,name:n.name}),ownerType:Fe(e)||!ze()?"application":"module"===e.type?"module":"application",ownerName:Fe(e)||!ze()?ae.studio.appName:e.name};"entityDesigner"==i.type&&(i.entityGenerationDomain=null===(o=ae.user.selectedOrganization.actions)||void 0===o?void 0:o.entityGenerationDomain),t.push(i)})),t.length>0)if(!Fe(e)&&ze())n.set(e.name,t);else{let e=n.get(ae.studio.appName);e&&e.length>0&&e.forEach((e=>t.push(e))),n.set(ae.studio.appName,t)}}}));let t=Array();n.forEach(((n,o)=>{t.push({appID:ae.studio.appId,exportType:"qui",selectionData:n,layer:0,groupID:e})})),await pe.createPackJobs(t)}(e),e};switch(C.screenType){case"Export":const n=await e();await async function(e){await re.executeUseCase(u.i,{appID:ae.studio.appId,exportType:"qui",selectionData:[],layer:1,groupID:e})}(n);break;case"Deploy":if(C.platformSelection.mobile)return await Ue();switch(Je(he.value,!0)){case"plateauGCP":const n=await e();await async function(e){let n=await ce.getExportJobsByGroupId({groupID:e}).then((e=>e.jobs.filter((e=>{return!("module"==(n=e.jobData).items[0].ownerType&&"processmanager"==n.items[0].ownerName);var n})).map((e=>{const n=e.jobData;return{ownerName:n.items[0].ownerName,jobID:e.jobID,type:n.items[0].ownerType,mainDir:Oe(n)}}))));if(!n||n.length<=0)return;let t=Array();n.forEach((n=>{t.push({appID:ae.studio.appId,type:"build",package:{type:n.type,name:n.ownerName,mainDir:n.mainDir,zip:`${n.jobID}.zip`},layer:1,groupID:e})})),await de.createBuildJobs(t);let o={appID:ae.studio.appId,type:"deployment",deployConfig:{process:{configModelIDs:qe(),enabled:ue.value.filter((e=>e.checked&&e.children&&e.children.filter((e=>e.checked&&"bpmn"==e.type)))).length>0}},layer:2,groupID:e};await de.startDeploymentJob(o)}(n);break;case"azure":await Ue()}}n("close")}),{loading:!0})}async function Ue(){const e=[],n={};se.flatMapItems(ae.studio.items,((e,t)=>{if("model"==e.objectType)return n[e.ID]={item:e,path:t},e}));const t=o=>{o&&0!=o.length&&o.filter((e=>e.checked||e.anyChildChecked)).forEach((o=>{if("module"==o.type)return void t(o.children);const i=n[o.id],a={id:o.id,name:me.getFileFullname(i.item),path:i.path,type:me.getItemType(i.item),ver:o.version||"latest",isRootPage:i.item.isRootPage,ownerType:"application",ownerName:ae.studio.appName,size:i.item.size};e.push(a)}))};t(ue.value),await de.createAppDeployJob(e,C.platformSelection)}function ze(){const e=ae.user.selectedOrganization.applications;return!(!e||!(e.entity||e.process||e.bpmn))}function Ne(e,n){return ze()?"":"qjson"==e.type?n:""}function Fe(e){return"UI Settings"==e.name}function qe(){let e=Array();return ue.value.forEach((n=>{if(n.checked&&n.children){const t=n.children.find((e=>"entityDesigner"==e.type));if(!t)return;const o=y.b.getServiceNameFromModel(t.name);n.children.forEach((n=>{n.checked&&"process"==n.type&&e.push({moduleName:o,modelId:n.id,modelName:n.name})}))}})),e}function Oe(e){if("processmanager"==e.items[0].ownerName)return"";if("module"==e.items[0].ownerType){let n=e.items.find((e=>"entityDesigner"==e.type));if(!n)throw new Error("!!! this module cannot deploy. Because its have not a service");return y.b.getServiceNameFromModel(n.name)}return y.b.getQuiPackageNameFromAppName(e.app.name)}function Je(e,n=!1){const t={azure:"Public Cloud",plateauGCP:"Plateau Platform Playground"};return n?Object.keys(t).find((n=>{if(t[n]===e)return!0})):Object.keys(t).includes(e)?t[e]:void 0}function Ve(e){he.value=e}return(e,n)=>((0,o.wg)(),(0,o.iD)("div",x,[(0,o._)("div",null,[(0,o.Wm)(c.Z,{class:(0,i.normalizeClass)(["modules-selected-checkbox","Deploy"==C.screenType?"deploy":""]),minus:0==(0,a.SU)(De),check:1==(0,a.SU)(De),onClick:n[0]||(n[0]=e=>{return n=null==(0,a.SU)(De),ue.value.filter((e=>!e.disabled)).forEach((e=>{e.checked=n,null!=e.allChildChecked&&e.children&&e.children.length>0&&!e.children.some((e=>e.disabled))&&(e.allChildChecked=n),null!=e.anyChildChecked&&(e.anyChildChecked=n),e.children&&e.children.filter((e=>!e.disabled)).forEach((e=>e.checked=n))})),Ae.value=Be(),void("Deploy"==C.screenType&&Ee());var n})},null,8,["class","minus","check"]),(0,o._)("div",{class:(0,i.normalizeClass)(["modules-selected-text","Deploy"==C.screenType?"deploy":""])},[(0,o._)("span",k,(0,i.toDisplayString)((0,a.SU)(ge)+(0,a.SU)(Ie)+(0,a.SU)(Ce)),1),(0,o.Uk)(" of "),(0,o._)("span",D,(0,i.toDisplayString)((0,a.SU)(xe)),1),(0,o.Uk)(" items selected ")],2)]),(0,o._)("div",{class:(0,i.normalizeClass)(["modules-datatable","Deploy"==C.screenType?"deploy":""])},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(ue.value,(e=>{var n;return(0,o.wg)(),(0,o.iD)("div",null,["module"==(null==e?void 0:e.type)?((0,o.wg)(),(0,o.iD)("div",B,[(0,o._)("div",w,[(0,o._)("i",{class:(0,i.normalizeClass)("mdi mdi-menu"+(e.collapsed?"-right":"-down")+" chevron"+(e.children&&0!=e.children.length?"":" disabled")),onClick:n=>function(e){e.collapsed=!e.collapsed}(e)},null,10,T),(0,o.Wm)(c.Z,{class:"module-checkbox",check:e.allChildChecked,minus:!e.allChildChecked&&e.anyChildChecked,disabled:e.disabled,onClick:n=>Te(e)},null,8,["check","minus","disabled","onClick"]),(0,o._)("span",{class:(0,i.normalizeClass)(["module-name",e.disabled?" disabled":""])},(0,i.toDisplayString)(e.name),3)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(null==e?void 0:e.children,(n=>(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",M,[(0,o.Wm)(c.Z,{class:"model-checkbox",check:n.checked,disabled:n.disabled,onClick:e=>Te(n)},null,8,["check","disabled","onClick"]),"qjson"==n.type?((0,o.wg)(),(0,o.iD)("i",E)):(0,o.kq)("v-if",!0),"yaml"==n.type?((0,o.wg)(),(0,o.iD)("i",S)):(0,o.kq)("v-if",!0),"js"==n.type||"css"==(null==n?void 0:n.type)?((0,o.wg)(),(0,o.iD)("i",j)):(0,o.kq)("v-if",!0),"process"==n.type?((0,o.wg)(),(0,o.iD)("i",P)):(0,o.kq)("v-if",!0),"bpmn"==n.type?((0,o.wg)(),(0,o.iD)("i",U)):(0,o.kq)("v-if",!0),"entityDesigner"==n.type?((0,o.wg)(),(0,o.iD)("i",z)):(0,o.kq)("v-if",!0),"flow"==n.type?((0,o.wg)(),(0,o.iD)("i",N)):(0,o.kq)("v-if",!0),(0,o._)("span",{class:(0,i.normalizeClass)(["model-name",n.disabled?" disabled":""])},(0,i.toDisplayString)(n.name),3),n.usageType?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("div",{key:7,class:(0,i.normalizeClass)(["version-text",n.disabled?"disabled":""]),onClick:e=>Se(n)},[(0,o.Uk)((0,i.toDisplayString)(n.version?n.version:"No version")+" ",1),n.usageType?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("i",{key:0,class:(0,i.normalizeClass)(["mdi mdi-pencil-outline version-icon",n.disabled?"disabled":""])},null,2))],10,F))],512)),[[s.vShow,!e.collapsed]]))),256))])):((0,o.wg)(),(0,o.iD)("div",q,[(0,o._)("div",O,[(0,o.Wm)(c.Z,{class:"module-checkbox",check:null==e?void 0:e.checked,disabled:e.disabled,onClick:n=>Te(e)},null,8,["check","disabled","onClick"]),"qjson"==(null==e?void 0:e.type)?((0,o.wg)(),(0,o.iD)("i",J)):(0,o.kq)("v-if",!0),"yaml"==(null==e?void 0:e.type)?((0,o.wg)(),(0,o.iD)("i",V)):(0,o.kq)("v-if",!0),"js"==(null==e?void 0:e.type)||"css"==(null==e?void 0:e.type)?((0,o.wg)(),(0,o.iD)("i",R)):(0,o.kq)("v-if",!0),"process"==(null==e?void 0:e.type)?((0,o.wg)(),(0,o.iD)("i",H)):(0,o.kq)("v-if",!0),"bpmn"==(null==e?void 0:e.type)?((0,o.wg)(),(0,o.iD)("i",L)):(0,o.kq)("v-if",!0),"entityDesigner"==(null==e?void 0:e.type)?((0,o.wg)(),(0,o.iD)("i",Y)):(0,o.kq)("v-if",!0),"flow"==(null==e?void 0:e.type)?((0,o.wg)(),(0,o.iD)("i",G)):(0,o.kq)("v-if",!0),(0,o._)("span",Z,[(0,o.Uk)((0,i.toDisplayString)(null==e?void 0:e.name)+" ",1),(null===(n=ve.value)||void 0===n?void 0:n.ID)==e.id?((0,o.wg)(),(0,o.iD)("span",_,Q)):(0,o.kq)("v-if",!0)]),e.usageType?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("span",{key:7,class:(0,i.normalizeClass)(["version-text",e.disabled?"disabled":""]),onClick:n=>Se(e)},[(0,o.Uk)((0,i.toDisplayString)(e.version?e.version:"No version")+" ",1),e.usageType?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("i",{key:0,class:(0,i.normalizeClass)(["mdi mdi-pencil-outline version-icon",e.disabled?"disabled":""])},null,2))],10,W))])]))])})),256))],2),"Deploy"==C.screenType&&C.platformSelection.web?((0,o.wg)(),(0,o.iD)("div",X,[$,(0,o.Wm)(g.Z,{options:fe.value,onInput:Ve,selectedOption:he.value,default:he.value,disabledOptions:be.value,selectedClass:"selected-environment",placeholder:"Select the publish environment of your application",class:"select-environment"},null,8,["options","selectedOption","default","disabledOptions"])])):(0,o.kq)("v-if",!0),"Deploy"==C.screenType&&!C.platformSelection.web&&C.platformSelection.mobile?((0,o.wg)(),(0,o.iD)("div",K,ee)):(0,o.kq)("v-if",!0),(0,o._)("div",{class:(0,i.normalizeClass)(["footer","Deploy"==C.screenType?"deploy":"export"])},[(0,o._)("div",{class:(0,i.normalizeClass)(["cancel-button","Deploy"==C.screenType?"deploy":""]),onClick:je},"Cancel",2),"Export"==C.screenType?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,i.normalizeClass)((0,a.SU)(ke)?" button-disable":""),onClick:Pe},ne,2)):(0,o.kq)("v-if",!0),"Deploy"==C.screenType?((0,o.wg)(),(0,o.iD)("div",{key:1,class:(0,i.normalizeClass)([(0,a.SU)(ke)?" button-disable":""]),onClick:Pe},[te,he.value?((0,o.wg)(),(0,o.iD)("span",oe,"You need to include your start screen.")):(0,o.kq)("v-if",!0),he.value?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("span",ie,"You need to select a publish environment."))],2)):(0,o.kq)("v-if",!0)],2)]))}});var se=t(7450),le=t.n(se),re=t(9530),de=t.n(re),ce=t(6199),pe=t.n(ce),me=t(458),ue=t.n(me),Ae=t(2916),he=t.n(Ae),be=t(2165),fe=t.n(be),ye=t(9678),ve={};ve.styleTagTransform=fe(),ve.setAttributes=ue(),ve.insert=pe().bind(null,"head"),ve.domAPI=de(),ve.insertStyleElement=he(),le()(ye.Z,ve),ye.Z&&ye.Z.locals&&ye.Z.locals;var ge=t(9980),Ie={};Ie.styleTagTransform=fe(),Ie.setAttributes=ue(),Ie.insert=pe().bind(null,"head"),Ie.domAPI=de(),Ie.insertStyleElement=he(),le()(ge.Z,Ie),ge.Z&&ge.Z.locals&&ge.Z.locals;const Ce=(0,t(2525).Z)(ae,[["__scopeId","data-v-03dfac29"]])}}]);
//# sourceMappingURL=654.js.map