/*! For license information please see 1436.js.LICENSE.txt */
(this.webpackChunkqcloud_shell=this.webpackChunkqcloud_shell||[]).push([[1436],{91436:(e,t,r)=>{"use strict";r.d(t,{LF:()=>Dl});var i={};r.r(i),r.d(i,{Any:()=>Bt,BaseBlock:()=>D,BaseStringBlock:()=>M,BitString:()=>He,BmpString:()=>nt,Boolean:()=>Ue,CharacterString:()=>dt,Choice:()=>xt,Constructed:()=>Ce,DATE:()=>mt,DateTime:()=>wt,Duration:()=>At,EndOfContent:()=>Ie,Enumerated:()=>Je,GeneralString:()=>yt,GeneralizedTime:()=>vt,GraphicString:()=>pt,HexBlock:()=>j,IA5String:()=>ht,Integer:()=>Fe,Null:()=>Te,NumericString:()=>at,ObjectIdentifier:()=>Ke,OctetString:()=>Pe,Primitive:()=>xe,PrintableString:()=>ct,RawData:()=>Ot,RelativeObjectIdentifier:()=>Ge,Repeated:()=>kt,Sequence:()=>Ze,Set:()=>Ye,TIME:()=>St,TeletexString:()=>lt,TimeOfDay:()=>bt,UTCTime:()=>gt,UniversalString:()=>ot,Utf8String:()=>rt,ValueBlock:()=>V,VideotexString:()=>ut,ViewWriter:()=>f,VisibleString:()=>ft,compareSchema:()=>Et,fromBER:()=>Oe,verifySchema:()=>Ct}),r(87308);var n=r(53738);function s(e,t){let r=0;if(1===e.length)return e[0];for(let i=e.length-1;i>=0;i--)r+=e[e.length-1-i]*Math.pow(2,t*i);return r}function o(e,t,r=-1){const i=r;let n=e,s=0,o=Math.pow(2,t);for(let r=1;r<8;r++){if(e<o){let e;if(i<0)e=new ArrayBuffer(r),s=r;else{if(i<r)return new ArrayBuffer(0);e=new ArrayBuffer(i),s=i}const o=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);o[s-e-1]=Math.floor(n/r),n-=o[s-e-1]*r}return e}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function a(...e){let t=0,r=0;for(const r of e)t+=r.length;const i=new ArrayBuffer(t),n=new Uint8Array(i);for(const t of e)n.set(t,r),r+=t.length;return n}function c(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const i=s(r,8),n=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(n);for(let t=0;t<this.valueHex.byteLength;t++)o[t]=e[t];return o[0]&=127,s(o,8)-i}function l(e,t){const r=e.toString(10);if(t<r.length)return"";const i=t-r.length,n=new Array(i);for(let e=0;e<i;e++)n[e]="0";return n.join("").concat(r)}function u(){if("undefined"==typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function h(e){let t=0,r=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;const i=new Uint8Array(t);for(let t=0;t<e.length;t++){const n=e[t];i.set(new Uint8Array(n),r),r+=n.byteLength}return i.buffer}function p(e,t,r,i){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):i<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-i<0&&(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",1)):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}Math.log(2);class f{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return h(this.items)}}const y=[new Uint8Array([1])],d="0123456789",g="name",v="valueHexView",m="isHexOnly",b="idBlock",w="tagClass",A="tagNumber",S="isConstructed",B="fromBER",x="toBER",k="local",O="",E=new ArrayBuffer(0),C=new Uint8Array(0),N="EndOfContent",I="OCTET STRING",T="BIT STRING";function j(e){var t;return(t=class extends e{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!==(t=r.isHexOnly)&&void 0!==t&&t,this.valueHexView=r.valueHex?n.vJ.toUint8Array(r.valueHex):C}fromBER(e,t,r){const i=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!p(this,i,t,r))return-1;const n=t+r;return this.valueHexView=i.subarray(t,n),this.valueHexView.length?(this.blockLength=r,n):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",E)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:n.ep.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class U{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}constructor({blockLength:e=0,error:t=O,warnings:r=[],valueBeforeDecode:i=C}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=n.vJ.toUint8Array(i)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:n.ep.ToHex(this.valueBeforeDecodeView)}}}U.NAME="baseBlock";class V extends U{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}V.NAME="valueBlock";class P extends(j(U)){constructor({idBlock:e={}}={}){var t,r,i,s;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?n.vJ.toUint8Array(e.valueHex):C,this.tagClass=null!==(r=e.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(i=e.tagNumber)&&void 0!==i?i:-1,this.isConstructed=null!==(s=e.isConstructed)&&void 0!==s&&s):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",E}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){const r=o(this.tagNumber,7),i=new Uint8Array(r),n=r.byteLength,s=new Uint8Array(n+1);if(s[0]=31|t,!e){for(let e=0;e<n-1;e++)s[e+1]=128|i[e];s[n]=i[n-1]}return s.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){const e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){const i=n.vJ.toUint8Array(e);if(!p(this,i,t,r))return-1;const o=i.subarray(t,t+r);if(0===o.length)return this.error="Zero buffer length",-1;switch(192&o[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&o[0]),this.isHexOnly=!1;const a=31&o[0];if(31!==a)this.tagNumber=a,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&o[e];){if(t[e-1]=127&o[e],e++,e>=o.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){r+=255;const e=new Uint8Array(r);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&o[e];const i=new Uint8Array(e);for(let r=0;r<e;r++)i[r]=t[r];t=this.valueHexView=new Uint8Array(e),t.set(i),this.blockLength<=9?this.tagNumber=s(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}P.NAME="identificationBlock";class L extends U{constructor({lenBlock:e={}}={}){var t,r,i;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(r=e.longFormUsed)&&void 0!==r&&r,this.length=null!==(i=e.length)&&void 0!==i?i:0}fromBER(e,t,r){const i=n.vJ.toUint8Array(e);if(!p(this,i,t,r))return-1;const o=i.subarray(t,t+r);if(0===o.length)return this.error="Zero buffer length",-1;if(255===o[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===o[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&o[0]),!1===this.longFormUsed)return this.length=o[0],this.blockLength=1,t+this.blockLength;const a=127&o[0];if(a>8)return this.error="Too big integer",-1;if(a+1>o.length)return this.error="End of input reached before message was fully decoded",-1;const c=t+1,l=i.subarray(c,c+a);return 0===l[a-1]&&this.warnings.push("Needlessly long encoded length"),this.length=s(l,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=a+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const i=o(this.length,8);if(i.byteLength>127)return this.error="Too big length",E;if(t=new ArrayBuffer(i.byteLength+1),e)return t;const n=new Uint8Array(i);r=new Uint8Array(t),r[0]=128|i.byteLength;for(let e=0;e<i.byteLength;e++)r[e+1]=n[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}L.NAME="lengthBlock";const H={};class D extends U{constructor({name:e=O,optional:t=!1,primitiveSchema:r,...i}={},n){super(i),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new P(i),this.lenBlock=new L(i),this.valueBlock=n?new n(i):new V(i)}fromBER(e,t,r){const i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===i?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}toBER(e,t){const r=t||new f;t||R(this);const i=this.idBlock.toBER(e);if(r.write(i),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;const i=this.lenBlock.toBER(e);r.write(i),r.write(t)}return t?E:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():n.ep.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${n.ep.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){return this===e||e instanceof this.constructor&&function(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}(this.toBER(),e.toBER())}}function R(e){var t;if(e instanceof H.Constructed)for(const t of e.valueBlock.value)R(t)&&(e.lenBlock.isIndefiniteForm=!0);return!!(null===(t=e.lenBlock)||void 0===t?void 0:t.isIndefiniteForm)}D.NAME="BaseBlock";class M extends D{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor({value:e=O,...t}={},r){super(t,r),e&&this.fromString(e)}fromBER(e,t,r){const i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===i?(this.error=this.valueBlock.error,i):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}M.NAME="BaseStringBlock";class $ extends(j(V)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}var F,J,_,z,K,q,W,G,Z,Y,X,Q,ee,te,re,ie,ne,se,oe,ae,ce,le,ue,he,pe,fe,ye,de,ge,ve,me,be,we,Ae,Se,Be;$.NAME="PrimitiveValueBlock";class xe extends D{constructor(e={}){super(e,$),this.idBlock.isConstructed=!1}}function ke(e,t=0,r=e.length){const i=t;let n=new D({},V);const s=new U;if(!p(s,e,t,r))return n.error=s.error,{offset:-1,result:n};if(!e.subarray(t,t+r).length)return n.error="Zero buffer length",{offset:-1,result:n};let o=n.idBlock.fromBER(e,t,r);if(n.idBlock.warnings.length&&n.warnings.concat(n.idBlock.warnings),-1===o)return n.error=n.idBlock.error,{offset:-1,result:n};if(t=o,r-=n.idBlock.blockLength,o=n.lenBlock.fromBER(e,t,r),n.lenBlock.warnings.length&&n.warnings.concat(n.lenBlock.warnings),-1===o)return n.error=n.lenBlock.error,{offset:-1,result:n};if(t=o,r-=n.lenBlock.blockLength,!n.idBlock.isConstructed&&n.lenBlock.isIndefiniteForm)return n.error="Indefinite length form used for primitive encoding form",{offset:-1,result:n};let a=D;if(1===n.idBlock.tagClass){if(n.idBlock.tagNumber>=37&&!1===n.idBlock.isHexOnly)return n.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:n};switch(n.idBlock.tagNumber){case 0:if(n.idBlock.isConstructed&&n.lenBlock.length>0)return n.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:n};a=H.EndOfContent;break;case 1:a=H.Boolean;break;case 2:a=H.Integer;break;case 3:a=H.BitString;break;case 4:a=H.OctetString;break;case 5:a=H.Null;break;case 6:a=H.ObjectIdentifier;break;case 10:a=H.Enumerated;break;case 12:a=H.Utf8String;break;case 13:a=H.RelativeObjectIdentifier;break;case 14:a=H.TIME;break;case 15:return n.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:n};case 16:a=H.Sequence;break;case 17:a=H.Set;break;case 18:a=H.NumericString;break;case 19:a=H.PrintableString;break;case 20:a=H.TeletexString;break;case 21:a=H.VideotexString;break;case 22:a=H.IA5String;break;case 23:a=H.UTCTime;break;case 24:a=H.GeneralizedTime;break;case 25:a=H.GraphicString;break;case 26:a=H.VisibleString;break;case 27:a=H.GeneralString;break;case 28:a=H.UniversalString;break;case 29:a=H.CharacterString;break;case 30:a=H.BmpString;break;case 31:a=H.DATE;break;case 32:a=H.TimeOfDay;break;case 33:a=H.DateTime;break;case 34:a=H.Duration;break;default:{const e=n.idBlock.isConstructed?new H.Constructed:new H.Primitive;e.idBlock=n.idBlock,e.lenBlock=n.lenBlock,e.warnings=n.warnings,n=e}}}else a=n.idBlock.isConstructed?H.Constructed:H.Primitive;return n=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(n,a),o=n.fromBER(e,t,n.lenBlock.isIndefiniteForm?r:n.lenBlock.length),n.valueBeforeDecodeView=e.subarray(i,i+n.blockLength),{offset:o,result:n}}function Oe(e){if(!e.byteLength){const e=new D({},V);return e.error="Input buffer has zero length",{offset:-1,result:e}}return ke(n.vJ.toUint8Array(e).slice(),0,e.byteLength)}F=xe,H.Primitive=F,xe.NAME="PRIMITIVE";class Ee extends V{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const i=n.vJ.toUint8Array(e);if(!p(this,i,t,r))return-1;if(this.valueBeforeDecodeView=i.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let s=t;for(;(this.isIndefiniteForm?1:r)>0;){const e=ke(i,s,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(s=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===N)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===N?this.value.pop():this.warnings.push("No EndOfContent block encoded")),s}toBER(e,t){const r=t||new f;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?E:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}Ee.NAME="ConstructedValueBlock";class Ce extends D{constructor(e={}){super(e,Ee),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===i?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}J=Ce,H.Constructed=J,Ce.NAME="CONSTRUCTED";class Ne extends V{fromBER(e,t,r){return t}toBER(e){return E}}Ne.override="EndOfContentValueBlock";class Ie extends D{constructor(e={}){super(e,Ne),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}_=Ie,H.EndOfContent=_,Ie.NAME=N;class Te extends D{constructor(e={}){super(e,V),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}z=Te,H.Null=z,Te.NAME="NULL";class je extends(j(V)){get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=n.vJ.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}fromBER(e,t,r){const i=n.vJ.toUint8Array(e);return p(this,i,t,r)?(this.valueHexView=i.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,c.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}je.NAME="BooleanValueBlock";class Ue extends D{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor(e={}){super(e,je),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}K=Ue,H.Boolean=K,Ue.NAME="BOOLEAN";class Ve extends(j(Ee)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,i=Ee.prototype.fromBER.call(this,e,t,r),-1===i)return i;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.NAME;if(t===N){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==I)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(e,t,r),this.blockLength=r;return i}toBER(e,t){return this.isConstructed?Ee.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}Ve.NAME="OctetStringValueBlock";class Pe extends D{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i,n;null!==(i=r.isConstructed)&&void 0!==i||(r.isConstructed=!!(null===(n=r.value)||void 0===n?void 0:n.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Ve),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(i.byteLength){const e=ke(i,0,i.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch{}}return super.fromBER(e,t,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?Ce.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${n.ep.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof q&&e.push(t.valueBlock.valueHexView);return n.vJ.concat(e)}}q=Pe,H.OctetString=q,Pe.NAME=I;class Le extends(j(Ee)){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let i=-1;if(this.isConstructed){if(i=Ee.prototype.fromBER.call(this,e,t,r),-1===i)return i;for(const e of this.value){const t=e.constructor.NAME;if(t===N){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==T)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return i}const s=n.vJ.toUint8Array(e);if(!p(this,s,t,r))return-1;const o=s.subarray(t,t+r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const e=o.subarray(1);try{if(e.byteLength){const t=ke(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch{}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,t+r}toBER(e,t){if(this.isConstructed)return Ee.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return E;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}Le.NAME="BitStringValueBlock";class He extends D{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i,n;null!==(i=r.isConstructed)&&void 0!==i||(r.isConstructed=!!(null===(n=r.value)||void 0===n?void 0:n.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Le),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Ce.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const r of t)e.push(r.toString(2).padStart(8,"0"));const r=e.join("");return`${this.constructor.NAME} : ${r.substring(0,r.length-this.valueBlock.unusedBits)}`}}}function De(e,t){const r=new Uint8Array([0]),i=new Uint8Array(e),n=new Uint8Array(t);let s=i.slice(0);const o=s.length-1,c=n.slice(0),l=c.length-1;let u=0,h=0;for(let e=l<o?o:l;e>=0;e--,h++)u=1==h<c.length?s[o-h]+c[l-h]+r[0]:s[o-h]+r[0],r[0]=u/10,1==h>=s.length?s=a(new Uint8Array([u%10]),s):s[o-h]=u%10;return r[0]>0&&(s=a(r,s)),s}function Re(e){if(e>=y.length)for(let t=y.length;t<=e;t++){const e=new Uint8Array([0]);let r=y[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const i=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=i[0]/10,r[t]=i[0]%10}e[0]>0&&(r=a(e,r)),y.push(r)}return y[e]}function Me(e,t){let r=0;const i=new Uint8Array(e),n=new Uint8Array(t),s=i.slice(0),o=s.length-1,a=n.slice(0),c=a.length-1;let l,u=0;for(let e=c;e>=0;e--,u++)l=s[o-u]-a[c-u]-r,1==l<0?(r=1,s[o-u]=l+10):(r=0,s[o-u]=l);if(r>0)for(let e=o-c+1;e>=0;e--,u++){if(l=s[o-u]-r,!(l<0)){r=0,s[o-u]=l;break}r=1,s[o-u]=l+10}return s.slice()}W=He,H.BitString=W,He.NAME=T;class $e extends(j(V)){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=c.call(this)))}constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){const t=e<0?-1*e:e;let r=128;for(let i=1;i<8;i++){if(t<=r){if(e<0){const e=o(r-t,8,i);return new Uint8Array(e)[0]|=128,e}let n=o(t,8,i),s=new Uint8Array(n);if(128&s[0]){const e=n.slice(0),t=new Uint8Array(e);n=new ArrayBuffer(n.byteLength+1),s=new Uint8Array(n);for(let r=0;r<e.byteLength;r++)s[r+1]=t[r];s[0]=0}return n}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,i=0){const n=this.fromBER(e,t,r);if(-1===n)return n;const s=this.valueHexView;return 0===s[0]&&0!=(128&s[1])?this.valueHexView=s.subarray(1):0!==i&&s.length<i&&(i-s.length>1&&(i=s.length+1),this.valueHexView=s.subarray(i-s.length)),n}toDER(e=!1){const t=this.valueHexView;switch(!0){case 0!=(128&t[0]):{const e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&0==(128&t[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){const i=super.fromBER(e,t,r);return-1===i||this.setValueHex(),i}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=8*this.valueHexView.length-1;let t,r=new Uint8Array(8*this.valueHexView.length/3),i=0;const n=this.valueHexView;let s="",o=!1;for(let o=n.byteLength-1;o>=0;o--){t=n[o];for(let n=0;n<8;n++)1==(1&t)&&(i===e?(r=Me(Re(i),r),s="-"):r=De(r,Re(i))),i++,t>>=1}for(let e=0;e<r.length;e++)r[e]&&(o=!0),o&&(s+=d.charAt(r[e]));return!1===o&&(s+=d.charAt(0)),s}}G=$e,$e.NAME="IntegerValueBlock",Object.defineProperty(G.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class Fe extends D{constructor(e={}){super(e,$e),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return u(),BigInt(this.valueBlock.toString())}static fromBigInt(e){u();const t=BigInt(e),r=new f,i=t.toString(16).replace(/^-/,""),s=new Uint8Array(n.ep.FromHex(i));if(t<0){const e=new Uint8Array(s.length+(128&s[0]?1:0));e[0]|=128;const i=BigInt(`0x${n.ep.ToHex(e)}`)+t,o=n.vJ.toUint8Array(n.ep.FromHex(i.toString(16)));o[0]|=128,r.write(o)}else 128&s[0]&&r.write(new Uint8Array([0])),r.write(s);return new Z({valueHex:r.final()})}convertToDER(){const e=new Z({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new Z({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}Z=Fe,H.Integer=Z,Fe.NAME="INTEGER";class Je extends Fe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Y=Je,H.Enumerated=Y,Je.NAME="ENUMERATED";class _e extends(j(V)){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const i=n.vJ.toUint8Array(e);if(!p(this,i,t,r))return-1;const o=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&o[e],this.blockLength++,0!=(128&o[e]));e++);const a=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)a[e]=this.valueHexView[e];return this.valueHexView=a,0!=(128&o[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=s(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){u();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+(e+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=o(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",E;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r}toString(){let e="";if(this.isHexOnly)e=n.ep.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}_e.NAME="sidBlock";class ze extends V{constructor({value:e=O,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){const t=new _e;if(i=t.fromBER(e,i,r),-1===i)return this.blockLength=0,this.error=t.error,i;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const i=this.value[r].toBER(e);if(0===i.byteLength)return this.error=this.value[r].error,E;t.push(i)}return h(t)}fromString(e){this.value=[];let t=0,r=0,i="",n=!1;do{if(r=e.indexOf(".",t),i=-1===r?e.substring(t):e.substring(t,r),t=r+1,n){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return void(this.value=[])}const r=parseInt(i,10);if(isNaN(r))return;e.valueDec=r+t,n=!1}else{const e=new _e;if(i>Number.MAX_SAFE_INTEGER){u();const t=BigInt(i);e.valueBigInt=t}else if(e.valueDec=parseInt(i,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,n=!0),this.value.push(e)}}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?(i=`{${i}}`,this.value[r].isFirstSid?e=`2.{${i} - 80}`:e+=i):e+=i}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}ze.NAME="ObjectIdentifierValueBlock";class Ke extends D{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,ze),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}X=Ke,H.ObjectIdentifier=X,Ke.NAME="OBJECT IDENTIFIER";class qe extends(j(U)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;const i=n.vJ.toUint8Array(e);if(!p(this,i,t,r))return-1;const o=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&o[e],this.blockLength++,0!=(128&o[e]));e++);const a=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)a[e]=this.valueHexView[e];return this.valueHexView=a,0!=(128&o[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=s(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=o(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",E;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r.buffer}toString(){let e="";return e=this.isHexOnly?n.ep.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}qe.NAME="relativeSidBlock";class We extends V{constructor({value:e=O,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){const t=new qe;if(i=t.fromBER(e,i,r),-1===i)return this.blockLength=0,this.error=t.error,i;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e,t){const r=[];for(let t=0;t<this.value.length;t++){const i=this.value[t].toBER(e);if(0===i.byteLength)return this.error=this.value[t].error,E;r.push(i)}return h(r)}fromString(e){this.value=[];let t=0,r=0,i="";do{r=e.indexOf(".",t),i=-1===r?e.substring(t):e.substring(t,r),t=r+1;const n=new qe;if(n.valueDec=parseInt(i,10),isNaN(n.valueDec))return!0;this.value.push(n)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?(i=`{${i}}`,e+=i):e+=i}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}We.NAME="RelativeObjectIdentifierValueBlock";class Ge extends D{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,We),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Q=Ge,H.RelativeObjectIdentifier=Q,Ge.NAME="RelativeObjectIdentifier";class Ze extends Ce{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}ee=Ze,H.Sequence=ee,Ze.NAME="SEQUENCE";class Ye extends Ce{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}te=Ye,H.Set=te,Ye.NAME="SET";class Xe extends(j(V)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=O}toJSON(){return{...super.toJSON(),value:this.value}}}Xe.NAME="StringValueBlock";class Qe extends Xe{}Qe.NAME="SimpleStringValueBlock";class et extends M{constructor({...e}={}){super(e,Qe)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,n.vJ.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);this.valueBlock.value=e}}et.NAME="SIMPLE STRING";class tt extends et{fromBuffer(e){this.valueBlock.valueHexView=n.vJ.toUint8Array(e);try{this.valueBlock.value=n.ep.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=n.ep.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(n.ep.FromUtf8String(e)),this.valueBlock.value=e}}tt.NAME="Utf8StringValueBlock";class rt extends tt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}re=rt,H.Utf8String=re,rt.NAME="UTF8String";class it extends et{fromBuffer(e){this.valueBlock.value=n.ep.ToUtf16String(e),this.valueBlock.valueHexView=n.vJ.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(n.ep.FromUtf16String(e))}}it.NAME="BmpStringValueBlock";class nt extends it{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}ie=nt,H.BmpString=ie,nt.NAME="BMPString";class st extends et{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let i=0;i<t;i++){const t=o(e.charCodeAt(i),8),n=new Uint8Array(t);if(n.length>4)continue;const s=4-n.length;for(let e=n.length-1;e>=0;e--)r[4*i+e+s]=n[e]}this.valueBlock.value=e}}st.NAME="UniversalStringValueBlock";class ot extends st{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}ne=ot,H.UniversalString=ne,ot.NAME="UniversalString";class at extends et{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}se=at,H.NumericString=se,at.NAME="NumericString";class ct extends et{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}oe=ct,H.PrintableString=oe,ct.NAME="PrintableString";class lt extends et{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}ae=lt,H.TeletexString=ae,lt.NAME="TeletexString";class ut extends et{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}ce=ut,H.VideotexString=ce,ut.NAME="VideotexString";class ht extends et{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}le=ht,H.IA5String=le,ht.NAME="IA5String";class pt extends et{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}ue=pt,H.GraphicString=ue,pt.NAME="GraphicString";class ft extends et{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}he=ft,H.VisibleString=he,ft.NAME="VisibleString";class yt extends et{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}pe=yt,H.GeneralString=pe,yt.NAME="GeneralString";class dt extends et{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}fe=dt,H.CharacterString=fe,dt.NAME="CharacterString";class gt extends ft{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,n.vJ.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for conversion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){const e=new Array(7);return e[0]=l(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=l(this.month,2),e[2]=l(this.day,2),e[3]=l(this.hour,2),e[4]=l(this.minute,2),e[5]=l(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}ye=gt,H.UTCTime=ye,gt.NAME="UTCTime";class vt extends gt{constructor(e={}){var t;super(e),null!==(t=this.millisecond)&&void 0!==t||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){const e=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond);return new Date(e)}fromString(e){let t,r=!1,i="",n="",s=0,o=0,a=0;if("Z"===e[e.length-1])i=e.substring(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");i=e}if(r){if(-1!==i.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==i.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let e=1,t=i.indexOf("+"),r="";if(-1===t&&(t=i.indexOf("-"),e=-1),-1!==t){if(r=i.substring(t+1),i=i.substring(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for conversion");let n=parseInt(r.substring(0,2),10);if(isNaN(n.valueOf()))throw new Error("Wrong input string for conversion");if(o=e*n,4===r.length){if(n=parseInt(r.substring(2,4),10),isNaN(n.valueOf()))throw new Error("Wrong input string for conversion");a=e*n}}}let c=i.indexOf(".");if(-1===c&&(c=i.indexOf(",")),-1!==c){const e=new Number(`0${i.substring(c)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");s=e.valueOf(),n=i.substring(0,c)}else n=i;switch(!0){case 8===n.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for conversion");break;case 10===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*s;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*s;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const e=1e3*s;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for conversion")}const l=t.exec(n);if(null===l)throw new Error("Wrong input string for conversion");for(let e=1;e<l.length;e++)switch(e){case 1:this.year=parseInt(l[e],10);break;case 2:this.month=parseInt(l[e],10);break;case 3:this.day=parseInt(l[e],10);break;case 4:this.hour=parseInt(l[e],10)+o;break;case 5:this.minute=parseInt(l[e],10)+a;break;case 6:this.second=parseInt(l[e],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){const e=[];return e.push(l(this.year,4)),e.push(l(this.month,2)),e.push(l(this.day,2)),e.push(l(this.hour,2)),e.push(l(this.minute,2)),e.push(l(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(l(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}de=vt,H.GeneralizedTime=de,vt.NAME="GeneralizedTime";class mt extends rt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}ge=mt,H.DATE=ge,mt.NAME="DATE";class bt extends rt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}ve=bt,H.TimeOfDay=ve,bt.NAME="TimeOfDay";class wt extends rt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}me=wt,H.DateTime=me,wt.NAME="DateTime";class At extends rt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}be=At,H.Duration=be,At.NAME="Duration";class St extends rt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}we=St,H.TIME=we,St.NAME="TIME";class Bt{constructor({name:e=O,optional:t=!1}={}){this.name=e,this.optional=t}}class xt extends Bt{constructor({value:e=[],...t}={}){super(t),this.value=e}}class kt extends Bt{constructor({value:e=new Bt,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class Ot{get data(){return this.dataView.slice().buffer}set data(e){this.dataView=n.vJ.toUint8Array(e)}constructor({data:e=C}={}){this.dataView=n.vJ.toUint8Array(e)}fromBER(e,t,r){const i=t+r;return this.dataView=n.vJ.toUint8Array(e).subarray(t,i),i}toBER(e){return this.dataView.slice().buffer}}function Et(e,t,r){if(r instanceof xt){for(const i of r.value)if(Et(e,t,i).verified)return{verified:!0,result:e};{const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(g)&&(e.name=r.name),e}}if(r instanceof Bt)return r.hasOwnProperty(g)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==0)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(b in r==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(B in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(x in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=r.idBlock.toBER(!1);if(0===i.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(i,0,i.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty(w))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty(A))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty(S))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!(m in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(v in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=r.idBlock.valueHexView,n=t.idBlock.valueHexView;if(i.length!==n.length)return{verified:!1,result:e};for(let t=0;t<i.length;t++)if(i[t]!==n[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,O),r.name&&(e[r.name]=t)),r instanceof H.Constructed){let i=0,n={verified:!1,result:{error:"Unknown error"}},s=r.valueBlock.value.length;if(s>0&&r.valueBlock.value[0]instanceof kt&&(s=t.valueBlock.value.length),0===s)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,O),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let o=0;o<s;o++)if(o-i>=t.valueBlock.value.length){if(!1===r.valueBlock.value[o].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,O),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof kt){if(n=Et(e,t.valueBlock.value[o],r.valueBlock.value[0].value),!1===n.verified){if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,O),r.name&&delete e[r.name]),n;i++}if(g in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let i={};i=k in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e,void 0===i[r.valueBlock.value[0].name]&&(i[r.valueBlock.value[0].name]=[]),i[r.valueBlock.value[0].name].push(t.valueBlock.value[o])}}else if(n=Et(e,t.valueBlock.value[o-i],r.valueBlock.value[o]),!1===n.verified){if(!r.valueBlock.value[o].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,O),r.name&&delete e[r.name]),n;i++}if(!1===n.verified){const t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,O),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&v in t.valueBlock){const i=ke(t.valueBlock.valueHexView);if(-1===i.offset){const t={verified:!1,result:i.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,O),r.name&&(delete e[r.name],t.name=r.name)),t}return Et(e,i.result,r.primitiveSchema)}return{verified:!0,result:e}}function Ct(e,t){if(t instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const r=ke(n.vJ.toUint8Array(e));return-1===r.offset?{verified:!1,result:r.result}:Et(r.result,r.result,t)}(Be=Ae||(Ae={}))[Be.Sequence=0]="Sequence",Be[Be.Set=1]="Set",Be[Be.Choice=2]="Choice",function(e){e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.OctetString=3]="OctetString",e[e.BitString=4]="BitString",e[e.Integer=5]="Integer",e[e.Enumerated=6]="Enumerated",e[e.ObjectIdentifier=7]="ObjectIdentifier",e[e.Utf8String=8]="Utf8String",e[e.BmpString=9]="BmpString",e[e.UniversalString=10]="UniversalString",e[e.NumericString=11]="NumericString",e[e.PrintableString=12]="PrintableString",e[e.TeletexString=13]="TeletexString",e[e.VideotexString=14]="VideotexString",e[e.IA5String=15]="IA5String",e[e.GraphicString=16]="GraphicString",e[e.VisibleString=17]="VisibleString",e[e.GeneralString=18]="GeneralString",e[e.CharacterString=19]="CharacterString",e[e.UTCTime=20]="UTCTime",e[e.GeneralizedTime=21]="GeneralizedTime",e[e.DATE=22]="DATE",e[e.TimeOfDay=23]="TimeOfDay",e[e.DateTime=24]="DateTime",e[e.Duration=25]="Duration",e[e.TIME=26]="TIME",e[e.Null=27]="Null"}(Se||(Se={}));class Nt{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else{if(!n.vJ.isBufferSource(e))throw TypeError("Unsupported type of 'params' argument for BitString");this.unusedBits=t,this.value=n.vJ.toArrayBuffer(e)}}fromASN(e){if(!(e instanceof He))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new He({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new He({name:e})}toNumber(){let e="";const t=new Uint8Array(this.value);for(const r of t)e+=r.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2);const r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;const i=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let n=0;for(;n<r;)i[n]=parseInt(t.slice(n<<3,8+(n<<3)),2),n++;this.value=i.buffer}}class It{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):n.vJ.isBufferSource(e)?this.buffer=n.vJ.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}fromASN(e){if(!(e instanceof Pe))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new Pe({valueHex:this.buffer})}toSchema(e){return new Pe({name:e})}}const Tt={fromASN:e=>e instanceof Te?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new Te;const t=Oe(e);if(t.result.error)throw new Error(t.result.error);return t.result}},jt={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new Fe({value:+e})},Ut={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new Je({value:e})},Vt={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new Fe({valueHex:e})},Pt={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new He({valueHex:e})},Lt={fromASN:e=>e.valueBlock.toString(),toASN:e=>new Ke({value:e})},Ht={fromASN:e=>e.valueBlock.value,toASN:e=>new Ue({value:e})},Dt={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new Pe({valueHex:e})},Rt={fromASN:e=>new It(e.getValue()),toASN:e=>e.toASN()};function Mt(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}const $t=Mt(rt),Ft=Mt(nt),Jt=Mt(ot),_t=Mt(at),zt=Mt(ct),Kt=Mt(lt),qt=Mt(ut),Wt=Mt(ht),Gt=Mt(pt),Zt=Mt(ft),Yt=Mt(yt),Xt=Mt(dt),Qt={fromASN:e=>e.toDate(),toASN:e=>new gt({valueDate:e})},er={fromASN:e=>e.toDate(),toASN:e=>new vt({valueDate:e})},tr={fromASN:()=>null,toASN:()=>new Te};function rr(e){switch(e){case Se.Any:return Tt;case Se.BitString:return Pt;case Se.BmpString:return Ft;case Se.Boolean:return Ht;case Se.CharacterString:return Xt;case Se.Enumerated:return Ut;case Se.GeneralString:return Yt;case Se.GeneralizedTime:return er;case Se.GraphicString:return Gt;case Se.IA5String:return Wt;case Se.Integer:return jt;case Se.Null:return tr;case Se.NumericString:return _t;case Se.ObjectIdentifier:return Lt;case Se.OctetString:return Dt;case Se.PrintableString:return zt;case Se.TeletexString:return Kt;case Se.UTCTime:return Qt;case Se.UniversalString:return Jt;case Se.Utf8String:return $t;case Se.VideotexString:return qt;case Se.VisibleString:return Zt;default:return null}}function ir(e){return"function"==typeof e&&e.prototype?!(!e.prototype.toASN||!e.prototype.fromASN)||ir(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}function nr(e){var t;if(e){const r=Object.getPrototypeOf(e);return(null===(t=null==r?void 0:r.prototype)||void 0===t?void 0:t.constructor)===Array||nr(r)}return!1}function sr(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}const or=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){const r=this.items.get(e);if(!r)throw new Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw new Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){const t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){const t={type:Ae.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){const r=this.items.get(e)||this.createDefault(e),n=[];for(const e in r.items){const s=r.items[e],o=t?e:"";let a;if("number"==typeof s.type){const e=Se[s.type],t=i[e];if(!t)throw new Error(`Cannot get ASN1 class by name '${e}'`);a=new t({name:o})}else ir(s.type)?a=(new s.type).toSchema(o):s.optional?this.get(s.type).type===Ae.Choice?a=new Bt({name:o}):(a=this.create(s.type,!1),a.name=o):a=new Bt({name:o});const c=!!s.optional||void 0!==s.defaultValue;if(s.repeated&&(a.name="",a=new("set"===s.repeated?Ye:Ze)({name:"",value:[new kt({name:o,value:a})]})),null!==s.context&&void 0!==s.context)if(s.implicit)if("number"==typeof s.type||ir(s.type)){const e=s.repeated?Ce:xe;n.push(new e({name:o,optional:c,idBlock:{tagClass:3,tagNumber:s.context}}))}else{this.cache(s.type);const e=!!s.repeated;let t=e?a:this.get(s.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,n.push(new Ce({name:e?"":o,optional:c,idBlock:{tagClass:3,tagNumber:s.context},value:t}))}else n.push(new Ce({optional:c,idBlock:{tagClass:3,tagNumber:s.context},value:[a]}));else a.optional=c,n.push(a)}switch(r.type){case Ae.Sequence:return new Ze({value:n,name:""});case Ae.Set:return new Ye({value:n,name:""});case Ae.Choice:return new xt({value:n,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}},ar=e=>t=>{let r;or.has(t)?r=or.get(t):(r=or.createDefault(t),or.set(t,r)),Object.assign(r,e)},cr=e=>(t,r)=>{let i;or.has(t.constructor)?i=or.get(t.constructor):(i=or.createDefault(t.constructor),or.set(t.constructor,i));const n=Object.assign({},e);if("number"==typeof n.type&&!n.converter){const i=rr(e.type);if(!i)throw new Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);n.converter=i}i.items[r]=n};class lr extends Error{constructor(){super(...arguments),this.schemas=[]}}class ur{static parse(e,t){const r=Oe(e);if(r.result.error)throw new Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(e,t){var r;try{if(ir(t))return(new t).fromASN(e);const n=or.get(t);or.cache(t);let s=n.schema;if(e.constructor===Ce&&n.type!==Ae.Choice){s=new Ce({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:n.schema.valueBlock.value});for(const t in n.items)delete e[t]}const o=Et({},e,s);if(!o.verified)throw new lr(`Data does not match to ${t.name} ASN1 schema. ${o.result.error}`);const a=new t;if(nr(t)){if(!("value"in e.valueBlock)||!Array.isArray(e.valueBlock.value))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const r=n.itemType;if("number"==typeof r){const i=rr(r);if(!i)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);return t.from(e.valueBlock.value,(e=>i.fromASN(e)))}return t.from(e.valueBlock.value,(e=>this.fromASN(e,r)))}for(const e in n.items){const t=o.result[e];if(!t)continue;const s=n.items[e],c=s.type;if("number"==typeof c||ir(c)){const n=null!==(r=s.converter)&&void 0!==r?r:ir(c)?new c:null;if(!n)throw new Error("Converter is empty");if(s.repeated)if(s.implicit){const r=new("sequence"===s.repeated?Ze:Ye);r.valueBlock=t.valueBlock;const i=Oe(r.toBER(!1));if(-1===i.offset)throw new Error(`Cannot parse the child item. ${i.result.error}`);if(!("value"in i.result.valueBlock)||!Array.isArray(i.result.valueBlock.value))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const o=i.result.valueBlock.value;a[e]=Array.from(o,(e=>n.fromASN(e)))}else a[e]=Array.from(t,(e=>n.fromASN(e)));else{let r=t;if(s.implicit){let e;if(ir(c))e=(new c).toSchema("");else{const t=Se[c],r=i[t];if(!r)throw new Error(`Cannot get '${t}' class from asn1js module`);e=new r}e.valueBlock=r.valueBlock,r=Oe(e.toBER(!1)).result}a[e]=n.fromASN(r)}}else if(s.repeated){if(!Array.isArray(t))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");a[e]=Array.from(t,(e=>this.fromASN(e,c)))}else a[e]=this.fromASN(t,c)}return a}catch(e){throw e instanceof lr&&e.schemas.push(t.name),e}}}class hr{static serialize(e){return e instanceof D?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&"object"==typeof e&&ir(e))return e.toASN();if(!e||"object"!=typeof e)throw new TypeError("Parameter 1 should be type of Object.");const t=e.constructor,r=or.get(t);or.cache(t);let i,n=[];if(r.itemType){if(!Array.isArray(e))throw new TypeError("Parameter 1 should be type of Array.");if("number"==typeof r.itemType){const i=rr(r.itemType);if(!i)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);n=e.map((e=>i.toASN(e)))}else n=e.map((e=>this.toAsnItem({type:r.itemType},"[]",t,e)))}else for(const i in r.items){const s=r.items[i],o=e[i];if(void 0===o||s.defaultValue===o||"object"==typeof s.defaultValue&&"object"==typeof o&&sr(this.serialize(s.defaultValue),this.serialize(o)))continue;const a=hr.toAsnItem(s,i,t,o);if("number"==typeof s.context)if(s.implicit)if(s.repeated||"number"!=typeof s.type&&!ir(s.type))n.push(new Ce({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:a.valueBlock.value}));else{const e={};e.valueHex=a instanceof Te?a.valueBeforeDecodeView:a.valueBlock.toBER(),n.push(new xe({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},...e}))}else n.push(new Ce({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:[a]}));else s.repeated?n=n.concat(a):n.push(a)}switch(r.type){case Ae.Sequence:i=new Ze({value:n});break;case Ae.Set:i=new Ye({value:n});break;case Ae.Choice:if(!n[0])throw new Error(`Schema '${t.name}' has wrong data. Choice cannot be empty.`);i=n[0]}return i}static toAsnItem(e,t,r,i){let n;if("number"==typeof e.type){const s=e.converter;if(!s)throw new Error(`Property '${t}' doesn't have converter for type ${Se[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(i))throw new TypeError("Parameter 'objProp' should be type of Array.");const t=Array.from(i,(e=>s.toASN(e)));n=new("sequence"===e.repeated?Ze:Ye)({value:t})}else n=s.toASN(i)}else if(e.repeated){if(!Array.isArray(i))throw new TypeError("Parameter 'objProp' should be type of Array.");const t=Array.from(i,(e=>this.toASN(e)));n=new("sequence"===e.repeated?Ze:Ye)({value:t})}else n=this.toASN(i);return n}}class pr extends Array{constructor(e=[]){if("number"==typeof e)super(e);else{super();for(const t of e)this.push(t)}}}class fr{static serialize(e){return hr.serialize(e)}static parse(e,t){return ur.parse(e,t)}static toString(e){const t=Oe(n.vJ.isBufferSource(e)?n.vJ.toArrayBuffer(e):fr.serialize(e));if(-1===t.offset)throw new Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}function yr(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;class dr{static isIPv4(e){return/^(\d{1,3}\.){3}\d{1,3}$/.test(e)}static parseIPv4(e){const t=e.split(".");if(4!==t.length)throw new Error("Invalid IPv4 address");return t.map((e=>{const t=parseInt(e,10);if(isNaN(t)||t<0||t>255)throw new Error("Invalid IPv4 address part");return t}))}static parseIPv6(e){const t=this.expandIPv6(e).split(":");if(8!==t.length)throw new Error("Invalid IPv6 address");return t.reduce(((e,t)=>{const r=parseInt(t,16);if(isNaN(r)||r<0||r>65535)throw new Error("Invalid IPv6 address part");return e.push(r>>8&255),e.push(255&r),e}),[])}static expandIPv6(e){if(!e.includes("::"))return e;const t=e.split("::");if(t.length>2)throw new Error("Invalid IPv6 address");const r=t[0]?t[0].split(":"):[],i=t[1]?t[1].split(":"):[],n=8-(r.length+i.length);if(n<0)throw new Error("Invalid IPv6 address");return[...r,...Array(n).fill("0"),...i].join(":")}static formatIPv6(e){const t=[];for(let r=0;r<16;r+=2)t.push((e[r]<<8|e[r+1]).toString(16));return this.compressIPv6(t.join(":"))}static compressIPv6(e){const t=e.split(":");let r=-1,i=0,n=-1,s=0;for(let e=0;e<t.length;e++)"0"===t[e]?(-1===n&&(n=e),s++):(s>i&&(r=n,i=s),n=-1,s=0);return s>i&&(r=n,i=s),i>1?`${t.slice(0,r).join(":")}::${t.slice(r+i).join(":")}`:e}static parseCIDR(e){const[t,r]=e.split("/"),i=parseInt(r,10);if(this.isIPv4(t)){if(i<0||i>32)throw new Error("Invalid IPv4 prefix length");return[this.parseIPv4(t),i]}if(i<0||i>128)throw new Error("Invalid IPv6 prefix length");return[this.parseIPv6(t),i]}static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;const t=parseInt(e.slice(8),16).toString(2).split("").reduce(((e,t)=>e+ +t),0);let r=e.slice(0,8).replace(/(.{2})/g,(e=>`${parseInt(e,16)}.`));return r=r.slice(0,-1),`${r}/${t}`}static toString(e){const t=new Uint8Array(e);if(4===t.length)return Array.from(t).join(".");if(16===t.length)return this.formatIPv6(t);if(8===t.length||32===t.length){const e=t.length/2,r=t.slice(0,e),i=t.slice(e);if(t.every((e=>0===e)))return 8===t.length?"0.0.0.0/0":"::/0";const n=i.reduce(((e,t)=>e+(t.toString(2).match(/1/g)||[]).length),0);return 8===t.length?`${Array.from(r).join(".")}/${n}`:`${this.formatIPv6(r)}/${n}`}return this.decodeIP(n.ep.ToHex(e))}static fromString(e){if(e.includes("/")){const[t,r]=this.parseCIDR(e),i=new Uint8Array(t.length);let n=r;for(let e=0;e<i.length;e++)n>=8?(i[e]=255,n-=8):n>0&&(i[e]=255<<8-n,n=0);const s=new Uint8Array(2*t.length);return s.set(t,0),s.set(i,t.length),s.buffer}const t=this.isIPv4(e)?this.parseIPv4(e):this.parseIPv6(e);return new Uint8Array(t).buffer}}var gr,vr,mr;let br=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};yr([cr({type:Se.TeletexString})],br.prototype,"teletexString",void 0),yr([cr({type:Se.PrintableString})],br.prototype,"printableString",void 0),yr([cr({type:Se.UniversalString})],br.prototype,"universalString",void 0),yr([cr({type:Se.Utf8String})],br.prototype,"utf8String",void 0),yr([cr({type:Se.BmpString})],br.prototype,"bmpString",void 0),br=yr([ar({type:Ae.Choice})],br);let wr=class extends br{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?n.ep.ToHex(this.anyValue):super.toString())}};yr([cr({type:Se.IA5String})],wr.prototype,"ia5String",void 0),yr([cr({type:Se.Any})],wr.prototype,"anyValue",void 0),wr=yr([ar({type:Ae.Choice})],wr);class Ar{constructor(e={}){this.type="",this.value=new wr,Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],Ar.prototype,"type",void 0),yr([cr({type:wr})],Ar.prototype,"value",void 0);let Sr=gr=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,gr.prototype)}};Sr=gr=yr([ar({type:Ae.Set,itemType:Ar})],Sr);let Br=vr=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,vr.prototype)}};Br=vr=yr([ar({type:Ae.Sequence,itemType:Sr})],Br);let xr=mr=class extends Br{constructor(e){super(e),Object.setPrototypeOf(this,mr.prototype)}};xr=mr=yr([ar({type:Ae.Sequence})],xr);const kr={fromASN:e=>dr.toString(Dt.fromASN(e)),toASN:e=>Dt.toASN(dr.fromString(e))};class Or{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],Or.prototype,"typeId",void 0),yr([cr({type:Se.Any,context:0})],Or.prototype,"value",void 0);class Er{constructor(e={}){this.partyName=new br,Object.assign(this,e)}}yr([cr({type:br,optional:!0,context:0,implicit:!0})],Er.prototype,"nameAssigner",void 0),yr([cr({type:br,context:1,implicit:!0})],Er.prototype,"partyName",void 0);let Cr=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:Or,context:0,implicit:!0})],Cr.prototype,"otherName",void 0),yr([cr({type:Se.IA5String,context:1,implicit:!0})],Cr.prototype,"rfc822Name",void 0),yr([cr({type:Se.IA5String,context:2,implicit:!0})],Cr.prototype,"dNSName",void 0),yr([cr({type:Se.Any,context:3,implicit:!0})],Cr.prototype,"x400Address",void 0),yr([cr({type:xr,context:4,implicit:!1})],Cr.prototype,"directoryName",void 0),yr([cr({type:Er,context:5})],Cr.prototype,"ediPartyName",void 0),yr([cr({type:Se.IA5String,context:6,implicit:!0})],Cr.prototype,"uniformResourceIdentifier",void 0),yr([cr({type:Se.OctetString,context:7,implicit:!0,converter:kr})],Cr.prototype,"iPAddress",void 0),yr([cr({type:Se.ObjectIdentifier,context:8,implicit:!0})],Cr.prototype,"registeredID",void 0),Cr=yr([ar({type:Ae.Choice})],Cr);const Nr="1.3.6.1.5.5.7",Ir=`${Nr}.3`,Tr=`${Nr}.48`,jr=`${Tr}.1`,Ur=`${Tr}.2`,Vr=`${Tr}.3`,Pr=`${Tr}.5`,Lr="2.5.29";var Hr;const Dr=`${`${Nr}.1`}.1`;class Rr{constructor(e={}){this.accessMethod="",this.accessLocation=new Cr,Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],Rr.prototype,"accessMethod",void 0),yr([cr({type:Cr})],Rr.prototype,"accessLocation",void 0);let Mr=Hr=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Hr.prototype)}};Mr=Hr=yr([ar({type:Ae.Sequence,itemType:Rr})],Mr);const $r=`${Lr}.35`;class Fr extends It{}class Jr{constructor(e={}){e&&Object.assign(this,e)}}yr([cr({type:Fr,context:0,optional:!0,implicit:!0})],Jr.prototype,"keyIdentifier",void 0),yr([cr({type:Cr,context:1,optional:!0,implicit:!0,repeated:"sequence"})],Jr.prototype,"authorityCertIssuer",void 0),yr([cr({type:Se.Integer,context:2,optional:!0,implicit:!0,converter:Vt})],Jr.prototype,"authorityCertSerialNumber",void 0);const _r=`${Lr}.19`;class zr{constructor(e={}){this.cA=!1,Object.assign(this,e)}}var Kr;yr([cr({type:Se.Boolean,defaultValue:!1})],zr.prototype,"cA",void 0),yr([cr({type:Se.Integer,optional:!0})],zr.prototype,"pathLenConstraint",void 0);let qr=Kr=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Kr.prototype)}};var Wr;qr=Kr=yr([ar({type:Ae.Sequence,itemType:Cr})],qr);let Gr=Wr=class extends qr{constructor(e){super(e),Object.setPrototypeOf(this,Wr.prototype)}};var Zr;Gr=Wr=yr([ar({type:Ae.Sequence})],Gr);const Yr=`${Lr}.32`;let Xr=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};yr([cr({type:Se.IA5String})],Xr.prototype,"ia5String",void 0),yr([cr({type:Se.VisibleString})],Xr.prototype,"visibleString",void 0),yr([cr({type:Se.BmpString})],Xr.prototype,"bmpString",void 0),yr([cr({type:Se.Utf8String})],Xr.prototype,"utf8String",void 0),Xr=yr([ar({type:Ae.Choice})],Xr);class Qr{constructor(e={}){this.organization=new Xr,this.noticeNumbers=[],Object.assign(this,e)}}yr([cr({type:Xr})],Qr.prototype,"organization",void 0),yr([cr({type:Se.Integer,repeated:"sequence"})],Qr.prototype,"noticeNumbers",void 0);class ei{constructor(e={}){Object.assign(this,e)}}yr([cr({type:Qr,optional:!0})],ei.prototype,"noticeRef",void 0),yr([cr({type:Xr,optional:!0})],ei.prototype,"explicitText",void 0);let ti=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:Se.IA5String})],ti.prototype,"cPSuri",void 0),yr([cr({type:ei})],ti.prototype,"userNotice",void 0),ti=yr([ar({type:Ae.Choice})],ti);class ri{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],ri.prototype,"policyQualifierId",void 0),yr([cr({type:Se.Any})],ri.prototype,"qualifier",void 0);class ii{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],ii.prototype,"policyIdentifier",void 0),yr([cr({type:ri,repeated:"sequence",optional:!0})],ii.prototype,"policyQualifiers",void 0);let ni=Zr=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Zr.prototype)}};ni=Zr=yr([ar({type:Ae.Sequence,itemType:ii})],ni);let si=class{constructor(e=0){this.value=e}};yr([cr({type:Se.Integer})],si.prototype,"value",void 0),si=yr([ar({type:Ae.Choice})],si);let oi=class extends si{};var ai;oi=yr([ar({type:Ae.Choice})],oi);const ci=`${Lr}.31`;var li;!function(e){e[e.unused=1]="unused",e[e.keyCompromise=2]="keyCompromise",e[e.cACompromise=4]="cACompromise",e[e.affiliationChanged=8]="affiliationChanged",e[e.superseded=16]="superseded",e[e.cessationOfOperation=32]="cessationOfOperation",e[e.certificateHold=64]="certificateHold",e[e.privilegeWithdrawn=128]="privilegeWithdrawn",e[e.aACompromise=256]="aACompromise"}(li||(li={}));class ui extends Nt{toJSON(){const e=[],t=this.toNumber();return t&li.aACompromise&&e.push("aACompromise"),t&li.affiliationChanged&&e.push("affiliationChanged"),t&li.cACompromise&&e.push("cACompromise"),t&li.certificateHold&&e.push("certificateHold"),t&li.cessationOfOperation&&e.push("cessationOfOperation"),t&li.keyCompromise&&e.push("keyCompromise"),t&li.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&li.superseded&&e.push("superseded"),t&li.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let hi=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:Cr,context:0,repeated:"sequence",implicit:!0})],hi.prototype,"fullName",void 0),yr([cr({type:Sr,context:1,implicit:!0})],hi.prototype,"nameRelativeToCRLIssuer",void 0),hi=yr([ar({type:Ae.Choice})],hi);class pi{constructor(e={}){Object.assign(this,e)}}yr([cr({type:hi,context:0,optional:!0})],pi.prototype,"distributionPoint",void 0),yr([cr({type:ui,context:1,optional:!0,implicit:!0})],pi.prototype,"reasons",void 0),yr([cr({type:Cr,context:2,optional:!0,repeated:"sequence",implicit:!0})],pi.prototype,"cRLIssuer",void 0);let fi=ai=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,ai.prototype)}};var yi;fi=ai=yr([ar({type:Ae.Sequence,itemType:pi})],fi);let di=yi=class extends fi{constructor(e){super(e),Object.setPrototypeOf(this,yi.prototype)}};di=yi=yr([ar({type:Ae.Sequence,itemType:pi})],di);class gi{constructor(e={}){this.onlyContainsUserCerts=gi.ONLY,this.onlyContainsCACerts=gi.ONLY,this.indirectCRL=gi.ONLY,this.onlyContainsAttributeCerts=gi.ONLY,Object.assign(this,e)}}var vi;gi.ONLY=!1,yr([cr({type:hi,context:0,optional:!0})],gi.prototype,"distributionPoint",void 0),yr([cr({type:Se.Boolean,context:1,defaultValue:gi.ONLY,implicit:!0})],gi.prototype,"onlyContainsUserCerts",void 0),yr([cr({type:Se.Boolean,context:2,defaultValue:gi.ONLY,implicit:!0})],gi.prototype,"onlyContainsCACerts",void 0),yr([cr({type:ui,context:3,optional:!0,implicit:!0})],gi.prototype,"onlySomeReasons",void 0),yr([cr({type:Se.Boolean,context:4,defaultValue:gi.ONLY,implicit:!0})],gi.prototype,"indirectCRL",void 0),yr([cr({type:Se.Boolean,context:5,defaultValue:gi.ONLY,implicit:!0})],gi.prototype,"onlyContainsAttributeCerts",void 0),function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(vi||(vi={}));let mi=class{constructor(e=vi.unspecified){this.reason=vi.unspecified,this.reason=e}toJSON(){return vi[this.reason]}toString(){return this.toJSON()}};var bi;yr([cr({type:Se.Enumerated})],mi.prototype,"reason",void 0),mi=yr([ar({type:Ae.Choice})],mi);const wi=`${Lr}.37`;let Ai=bi=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,bi.prototype)}};Ai=bi=yr([ar({type:Ae.Sequence,itemType:Se.ObjectIdentifier})],Ai);const Si=`${Ir}.1`,Bi=`${Ir}.2`,xi=`${Ir}.3`,ki=`${Ir}.4`,Oi=`${Ir}.8`,Ei=`${Ir}.9`;let Ci=class{constructor(e=new ArrayBuffer(0)){this.value=e}};yr([cr({type:Se.Integer,converter:Vt})],Ci.prototype,"value",void 0),Ci=yr([ar({type:Ae.Choice})],Ci);let Ni=class{constructor(e){this.value=new Date,e&&(this.value=e)}};var Ii;yr([cr({type:Se.GeneralizedTime})],Ni.prototype,"value",void 0),Ni=yr([ar({type:Ae.Choice})],Ni);let Ti=Ii=class extends qr{constructor(e){super(e),Object.setPrototypeOf(this,Ii.prototype)}};Ti=Ii=yr([ar({type:Ae.Sequence})],Ti);const ji=`${Lr}.15`;var Ui,Vi;!function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(Ui||(Ui={}));class Pi extends Nt{toJSON(){const e=this.toNumber(),t=[];return e&Ui.cRLSign&&t.push("crlSign"),e&Ui.dataEncipherment&&t.push("dataEncipherment"),e&Ui.decipherOnly&&t.push("decipherOnly"),e&Ui.digitalSignature&&t.push("digitalSignature"),e&Ui.encipherOnly&&t.push("encipherOnly"),e&Ui.keyAgreement&&t.push("keyAgreement"),e&Ui.keyCertSign&&t.push("keyCertSign"),e&Ui.keyEncipherment&&t.push("keyEncipherment"),e&Ui.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class Li{constructor(e={}){this.base=new Cr,this.minimum=0,Object.assign(this,e)}}yr([cr({type:Cr})],Li.prototype,"base",void 0),yr([cr({type:Se.Integer,context:0,defaultValue:0,implicit:!0})],Li.prototype,"minimum",void 0),yr([cr({type:Se.Integer,context:1,optional:!0,implicit:!0})],Li.prototype,"maximum",void 0);let Hi=Vi=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Vi.prototype)}};Hi=Vi=yr([ar({type:Ae.Sequence,itemType:Li})],Hi);class Di{constructor(e={}){Object.assign(this,e)}}yr([cr({type:Hi,context:0,optional:!0,implicit:!0})],Di.prototype,"permittedSubtrees",void 0),yr([cr({type:Hi,context:1,optional:!0,implicit:!0})],Di.prototype,"excludedSubtrees",void 0);class Ri{constructor(e={}){Object.assign(this,e)}}var Mi;yr([cr({type:Se.Integer,context:0,implicit:!0,optional:!0,converter:Vt})],Ri.prototype,"requireExplicitPolicy",void 0),yr([cr({type:Se.Integer,context:1,implicit:!0,optional:!0,converter:Vt})],Ri.prototype,"inhibitPolicyMapping",void 0);class $i{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],$i.prototype,"issuerDomainPolicy",void 0),yr([cr({type:Se.ObjectIdentifier})],$i.prototype,"subjectDomainPolicy",void 0);let Fi=Mi=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Mi.prototype)}};var Ji;Fi=Mi=yr([ar({type:Ae.Sequence,itemType:$i})],Fi);const _i=`${Lr}.17`;let zi=Ji=class extends qr{constructor(e){super(e),Object.setPrototypeOf(this,Ji.prototype)}};zi=Ji=yr([ar({type:Ae.Sequence})],zi);class Ki{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}var qi;yr([cr({type:Se.ObjectIdentifier})],Ki.prototype,"type",void 0),yr([cr({type:Se.Any,repeated:"set"})],Ki.prototype,"values",void 0);let Wi=qi=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,qi.prototype)}};Wi=qi=yr([ar({type:Ae.Sequence,itemType:Ki})],Wi);const Gi=`${Lr}.14`;class Zi extends Fr{}class Yi{constructor(e={}){Object.assign(this,e)}}var Xi,Qi;yr([cr({type:Se.GeneralizedTime,context:0,implicit:!0,optional:!0})],Yi.prototype,"notBefore",void 0),yr([cr({type:Se.GeneralizedTime,context:1,implicit:!0,optional:!0})],Yi.prototype,"notAfter",void 0),function(e){e[e.keyUpdateAllowed=1]="keyUpdateAllowed",e[e.newExtensions=2]="newExtensions",e[e.pKIXCertificate=4]="pKIXCertificate"}(Xi||(Xi={}));class en extends Nt{toJSON(){const e=[],t=this.toNumber();return t&Xi.pKIXCertificate&&e.push("pKIXCertificate"),t&Xi.newExtensions&&e.push("newExtensions"),t&Xi.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class tn{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new en,Object.assign(this,e)}}yr([cr({type:Se.GeneralString})],tn.prototype,"entrustVers",void 0),yr([cr({type:en})],tn.prototype,"entrustInfoFlags",void 0);let rn=Qi=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Qi.prototype)}};rn=Qi=yr([ar({type:Ae.Sequence,itemType:Rr})],rn);class nn{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof nn&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&n.Xy(e.parameters,this.parameters)||e.parameters===this.parameters)}}yr([cr({type:Se.ObjectIdentifier})],nn.prototype,"algorithm",void 0),yr([cr({type:Se.Any,optional:!0})],nn.prototype,"parameters",void 0);class sn{constructor(e={}){this.algorithm=new nn,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:nn})],sn.prototype,"algorithm",void 0),yr([cr({type:Se.BitString})],sn.prototype,"subjectPublicKey",void 0);let on=class{constructor(e){if(e)if("string"==typeof e||"number"==typeof e||e instanceof Date){const t=new Date(e);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){const e=this.utcTime||this.generalTime;if(!e)throw new Error("Cannot get time from CHOICE object");return e}};yr([cr({type:Se.UTCTime})],on.prototype,"utcTime",void 0),yr([cr({type:Se.GeneralizedTime})],on.prototype,"generalTime",void 0),on=yr([ar({type:Ae.Choice})],on);class an{constructor(e){this.notBefore=new on(new Date),this.notAfter=new on(new Date),e&&(this.notBefore=new on(e.notBefore),this.notAfter=new on(e.notAfter))}}var cn;yr([cr({type:on})],an.prototype,"notBefore",void 0),yr([cr({type:on})],an.prototype,"notAfter",void 0);class ln{constructor(e={}){this.extnID="",this.critical=ln.CRITICAL,this.extnValue=new It,Object.assign(this,e)}}ln.CRITICAL=!1,yr([cr({type:Se.ObjectIdentifier})],ln.prototype,"extnID",void 0),yr([cr({type:Se.Boolean,defaultValue:ln.CRITICAL})],ln.prototype,"critical",void 0),yr([cr({type:It})],ln.prototype,"extnValue",void 0);let un=cn=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,cn.prototype)}};var hn;un=cn=yr([ar({type:Ae.Sequence,itemType:ln})],un),function(e){e[e.v1=0]="v1",e[e.v2=1]="v2",e[e.v3=2]="v3"}(hn||(hn={}));class pn{constructor(e={}){this.version=hn.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new nn,this.issuer=new xr,this.validity=new an,this.subject=new xr,this.subjectPublicKeyInfo=new sn,Object.assign(this,e)}}yr([cr({type:Se.Integer,context:0,defaultValue:hn.v1})],pn.prototype,"version",void 0),yr([cr({type:Se.Integer,converter:Vt})],pn.prototype,"serialNumber",void 0),yr([cr({type:nn})],pn.prototype,"signature",void 0),yr([cr({type:xr})],pn.prototype,"issuer",void 0),yr([cr({type:an})],pn.prototype,"validity",void 0),yr([cr({type:xr})],pn.prototype,"subject",void 0),yr([cr({type:sn})],pn.prototype,"subjectPublicKeyInfo",void 0),yr([cr({type:Se.BitString,context:1,implicit:!0,optional:!0})],pn.prototype,"issuerUniqueID",void 0),yr([cr({type:Se.BitString,context:2,implicit:!0,optional:!0})],pn.prototype,"subjectUniqueID",void 0),yr([cr({type:un,context:3,optional:!0})],pn.prototype,"extensions",void 0);class fn{constructor(e={}){this.tbsCertificate=new pn,this.signatureAlgorithm=new nn,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:pn})],fn.prototype,"tbsCertificate",void 0),yr([cr({type:nn})],fn.prototype,"signatureAlgorithm",void 0),yr([cr({type:Se.BitString})],fn.prototype,"signatureValue",void 0);class yn{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new on,Object.assign(this,e)}}yr([cr({type:Se.Integer,converter:Vt})],yn.prototype,"userCertificate",void 0),yr([cr({type:on})],yn.prototype,"revocationDate",void 0),yr([cr({type:ln,optional:!0,repeated:"sequence"})],yn.prototype,"crlEntryExtensions",void 0);class dn{constructor(e={}){this.signature=new nn,this.issuer=new xr,this.thisUpdate=new on,Object.assign(this,e)}}yr([cr({type:Se.Integer,optional:!0})],dn.prototype,"version",void 0),yr([cr({type:nn})],dn.prototype,"signature",void 0),yr([cr({type:xr})],dn.prototype,"issuer",void 0),yr([cr({type:on})],dn.prototype,"thisUpdate",void 0),yr([cr({type:on,optional:!0})],dn.prototype,"nextUpdate",void 0),yr([cr({type:yn,repeated:"sequence",optional:!0})],dn.prototype,"revokedCertificates",void 0),yr([cr({type:ln,optional:!0,context:0,repeated:"sequence"})],dn.prototype,"crlExtensions",void 0);class gn{constructor(e={}){this.tbsCertList=new dn,this.signatureAlgorithm=new nn,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:dn})],gn.prototype,"tbsCertList",void 0),yr([cr({type:nn})],gn.prototype,"signatureAlgorithm",void 0),yr([cr({type:Se.BitString})],gn.prototype,"signature",void 0);class vn{constructor(e={}){this.issuer=new xr,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:xr})],vn.prototype,"issuer",void 0),yr([cr({type:Se.Integer,converter:Vt})],vn.prototype,"serialNumber",void 0);let mn=class{constructor(e={}){Object.assign(this,e)}};var bn;yr([cr({type:Zi,context:0,implicit:!0})],mn.prototype,"subjectKeyIdentifier",void 0),yr([cr({type:vn})],mn.prototype,"issuerAndSerialNumber",void 0),mn=yr([ar({type:Ae.Choice})],mn),function(e){e[e.v0=0]="v0",e[e.v1=1]="v1",e[e.v2=2]="v2",e[e.v3=3]="v3",e[e.v4=4]="v4",e[e.v5=5]="v5"}(bn||(bn={}));let wn=class extends nn{};wn=yr([ar({type:Ae.Sequence})],wn);let An=class extends nn{};An=yr([ar({type:Ae.Sequence})],An);let Sn=class extends nn{};Sn=yr([ar({type:Ae.Sequence})],Sn);let Bn=class extends nn{};Bn=yr([ar({type:Ae.Sequence})],Bn);let xn=class extends nn{};xn=yr([ar({type:Ae.Sequence})],xn);let kn=class extends nn{};kn=yr([ar({type:Ae.Sequence})],kn);class On{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}var En;yr([cr({type:Se.ObjectIdentifier})],On.prototype,"attrType",void 0),yr([cr({type:Se.Any,repeated:"set"})],On.prototype,"attrValues",void 0);class Cn{constructor(e={}){this.version=bn.v0,this.sid=new mn,this.digestAlgorithm=new wn,this.signatureAlgorithm=new An,this.signature=new It,Object.assign(this,e)}}yr([cr({type:Se.Integer})],Cn.prototype,"version",void 0),yr([cr({type:mn})],Cn.prototype,"sid",void 0),yr([cr({type:wn})],Cn.prototype,"digestAlgorithm",void 0),yr([cr({type:On,repeated:"set",context:0,implicit:!0,optional:!0})],Cn.prototype,"signedAttrs",void 0),yr([cr({type:An})],Cn.prototype,"signatureAlgorithm",void 0),yr([cr({type:It})],Cn.prototype,"signature",void 0),yr([cr({type:On,repeated:"set",context:1,implicit:!0,optional:!0})],Cn.prototype,"unsignedAttrs",void 0);let Nn=En=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,En.prototype)}};Nn=En=yr([ar({type:Ae.Set,itemType:Cn})],Nn);let In=class extends on{};In=yr([ar({type:Ae.Choice})],In);let Tn=class extends Cn{};Tn=yr([ar({type:Ae.Sequence})],Tn);class jn{constructor(e={}){this.acIssuer=new Cr,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}var Un;yr([cr({type:Cr})],jn.prototype,"acIssuer",void 0),yr([cr({type:Se.Integer})],jn.prototype,"acSerial",void 0),yr([cr({type:Ki,repeated:"sequence"})],jn.prototype,"attrs",void 0);let Vn=Un=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Un.prototype)}};Vn=Un=yr([ar({type:Ae.Sequence,itemType:Se.ObjectIdentifier})],Vn);class Pn{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}yr([cr({type:Se.Integer,optional:!0})],Pn.prototype,"pathLenConstraint",void 0),yr([cr({type:Vn,implicit:!0,context:0,optional:!0})],Pn.prototype,"permittedAttrs",void 0),yr([cr({type:Vn,implicit:!0,context:1,optional:!0})],Pn.prototype,"excludedAttrs",void 0),yr([cr({type:Se.Boolean,defaultValue:!0})],Pn.prototype,"permitUnSpecified",void 0);class Ln{constructor(e={}){this.issuer=new qr,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}var Hn;yr([cr({type:qr})],Ln.prototype,"issuer",void 0),yr([cr({type:Se.Integer,converter:Vt})],Ln.prototype,"serial",void 0),yr([cr({type:Se.BitString,optional:!0})],Ln.prototype,"issuerUID",void 0),function(e){e[e.publicKey=0]="publicKey",e[e.publicKeyCert=1]="publicKeyCert",e[e.otherObjectTypes=2]="otherObjectTypes"}(Hn||(Hn={}));class Dn{constructor(e={}){this.digestedObjectType=Hn.publicKey,this.digestAlgorithm=new nn,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.Enumerated})],Dn.prototype,"digestedObjectType",void 0),yr([cr({type:Se.ObjectIdentifier,optional:!0})],Dn.prototype,"otherObjectTypeID",void 0),yr([cr({type:nn})],Dn.prototype,"digestAlgorithm",void 0),yr([cr({type:Se.BitString})],Dn.prototype,"objectDigest",void 0);class Rn{constructor(e={}){Object.assign(this,e)}}yr([cr({type:qr,optional:!0})],Rn.prototype,"issuerName",void 0),yr([cr({type:Ln,context:0,implicit:!0,optional:!0})],Rn.prototype,"baseCertificateID",void 0),yr([cr({type:Dn,context:1,implicit:!0,optional:!0})],Rn.prototype,"objectDigestInfo",void 0);let Mn=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:Cr,repeated:"sequence"})],Mn.prototype,"v1Form",void 0),yr([cr({type:Rn,context:0,implicit:!0})],Mn.prototype,"v2Form",void 0),Mn=yr([ar({type:Ae.Choice})],Mn);class $n{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}yr([cr({type:Se.GeneralizedTime})],$n.prototype,"notBeforeTime",void 0),yr([cr({type:Se.GeneralizedTime})],$n.prototype,"notAfterTime",void 0);class Fn{constructor(e={}){Object.assign(this,e)}}var Jn,_n,zn;yr([cr({type:Ln,implicit:!0,context:0,optional:!0})],Fn.prototype,"baseCertificateID",void 0),yr([cr({type:qr,implicit:!0,context:1,optional:!0})],Fn.prototype,"entityName",void 0),yr([cr({type:Dn,implicit:!0,context:2,optional:!0})],Fn.prototype,"objectDigestInfo",void 0),function(e){e[e.v2=1]="v2"}(Jn||(Jn={}));class Kn{constructor(e={}){this.version=Jn.v2,this.holder=new Fn,this.issuer=new Mn,this.signature=new nn,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new $n,this.attributes=[],Object.assign(this,e)}}yr([cr({type:Se.Integer})],Kn.prototype,"version",void 0),yr([cr({type:Fn})],Kn.prototype,"holder",void 0),yr([cr({type:Mn})],Kn.prototype,"issuer",void 0),yr([cr({type:nn})],Kn.prototype,"signature",void 0),yr([cr({type:Se.Integer,converter:Vt})],Kn.prototype,"serialNumber",void 0),yr([cr({type:$n})],Kn.prototype,"attrCertValidityPeriod",void 0),yr([cr({type:Ki,repeated:"sequence"})],Kn.prototype,"attributes",void 0),yr([cr({type:Se.BitString,optional:!0})],Kn.prototype,"issuerUniqueID",void 0),yr([cr({type:un,optional:!0})],Kn.prototype,"extensions",void 0);class qn{constructor(e={}){this.acinfo=new Kn,this.signatureAlgorithm=new nn,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Kn})],qn.prototype,"acinfo",void 0),yr([cr({type:nn})],qn.prototype,"signatureAlgorithm",void 0),yr([cr({type:Se.BitString})],qn.prototype,"signatureValue",void 0),function(e){e[e.unmarked=1]="unmarked",e[e.unclassified=2]="unclassified",e[e.restricted=4]="restricted",e[e.confidential=8]="confidential",e[e.secret=16]="secret",e[e.topSecret=32]="topSecret"}(_n||(_n={}));class Wn extends Nt{}class Gn{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier,implicit:!0,context:0})],Gn.prototype,"type",void 0),yr([cr({type:Se.Any,implicit:!0,context:1})],Gn.prototype,"value",void 0);class Zn{constructor(e={}){this.policyId="",this.classList=new Wn(_n.unclassified),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],Zn.prototype,"policyId",void 0),yr([cr({type:Wn,defaultValue:new Wn(_n.unclassified)})],Zn.prototype,"classList",void 0),yr([cr({type:Gn,repeated:"set"})],Zn.prototype,"securityCategories",void 0);class Yn{constructor(e={}){Object.assign(this,e)}}yr([cr({type:It})],Yn.prototype,"cotets",void 0),yr([cr({type:Se.ObjectIdentifier})],Yn.prototype,"oid",void 0),yr([cr({type:Se.Utf8String})],Yn.prototype,"string",void 0);class Xn{constructor(e={}){this.values=[],Object.assign(this,e)}}yr([cr({type:qr,implicit:!0,context:0,optional:!0})],Xn.prototype,"policyAuthority",void 0),yr([cr({type:Yn,repeated:"sequence"})],Xn.prototype,"values",void 0);class Qn{constructor(e={}){this.targetCertificate=new Ln,Object.assign(this,e)}}yr([cr({type:Ln})],Qn.prototype,"targetCertificate",void 0),yr([cr({type:Cr,optional:!0})],Qn.prototype,"targetName",void 0),yr([cr({type:Dn,optional:!0})],Qn.prototype,"certDigestInfo",void 0);let es=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:Cr,context:0,implicit:!0})],es.prototype,"targetName",void 0),yr([cr({type:Cr,context:1,implicit:!0})],es.prototype,"targetGroup",void 0),yr([cr({type:Qn,context:2,implicit:!0})],es.prototype,"targetCert",void 0),es=yr([ar({type:Ae.Choice})],es);let ts=zn=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,zn.prototype)}};var rs;ts=zn=yr([ar({type:Ae.Sequence,itemType:es})],ts);let is=rs=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,rs.prototype)}};is=rs=yr([ar({type:Ae.Sequence,itemType:ts})],is);class ns{constructor(e={}){Object.assign(this,e)}}yr([cr({type:qr,implicit:!0,context:0,optional:!0})],ns.prototype,"roleAuthority",void 0),yr([cr({type:Cr,implicit:!0,context:1})],ns.prototype,"roleName",void 0);class ss{constructor(e={}){this.service=new Cr,this.ident=new Cr,Object.assign(this,e)}}var os;yr([cr({type:Cr})],ss.prototype,"service",void 0),yr([cr({type:Cr})],ss.prototype,"ident",void 0),yr([cr({type:It,optional:!0})],ss.prototype,"authInfo",void 0);class as{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],as.prototype,"otherCertFormat",void 0),yr([cr({type:Se.Any})],as.prototype,"otherCert",void 0);let cs=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:fn})],cs.prototype,"certificate",void 0),yr([cr({type:qn,context:2,implicit:!0})],cs.prototype,"v2AttrCert",void 0),yr([cr({type:as,context:3,implicit:!0})],cs.prototype,"other",void 0),cs=yr([ar({type:Ae.Choice})],cs);let ls=os=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,os.prototype)}};ls=os=yr([ar({type:Ae.Set,itemType:cs})],ls);class us{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],us.prototype,"contentType",void 0),yr([cr({type:Se.Any,context:0})],us.prototype,"content",void 0);let hs=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:It})],hs.prototype,"single",void 0),yr([cr({type:Se.Any})],hs.prototype,"any",void 0),hs=yr([ar({type:Ae.Choice})],hs);class ps{constructor(e={}){this.eContentType="",Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],ps.prototype,"eContentType",void 0),yr([cr({type:hs,context:0,optional:!0})],ps.prototype,"eContent",void 0);let fs=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:It,context:0,implicit:!0,optional:!0})],fs.prototype,"value",void 0),yr([cr({type:It,converter:Rt,context:0,implicit:!0,optional:!0,repeated:"sequence"})],fs.prototype,"constructedValue",void 0),fs=yr([ar({type:Ae.Choice})],fs);class ys{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new Bn,Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],ys.prototype,"contentType",void 0),yr([cr({type:Bn})],ys.prototype,"contentEncryptionAlgorithm",void 0),yr([cr({type:fs,optional:!0})],ys.prototype,"encryptedContent",void 0);class ds{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}var gs;yr([cr({type:Se.ObjectIdentifier})],ds.prototype,"keyAttrId",void 0),yr([cr({type:Se.Any,optional:!0})],ds.prototype,"keyAttr",void 0);class vs{constructor(e={}){this.subjectKeyIdentifier=new Zi,Object.assign(this,e)}}yr([cr({type:Zi})],vs.prototype,"subjectKeyIdentifier",void 0),yr([cr({type:Se.GeneralizedTime,optional:!0})],vs.prototype,"date",void 0),yr([cr({type:ds,optional:!0})],vs.prototype,"other",void 0);let ms=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:vs,context:0,implicit:!0,optional:!0})],ms.prototype,"rKeyId",void 0),yr([cr({type:vn,optional:!0})],ms.prototype,"issuerAndSerialNumber",void 0),ms=yr([ar({type:Ae.Choice})],ms);class bs{constructor(e={}){this.rid=new ms,this.encryptedKey=new It,Object.assign(this,e)}}yr([cr({type:ms})],bs.prototype,"rid",void 0),yr([cr({type:It})],bs.prototype,"encryptedKey",void 0);let ws=gs=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,gs.prototype)}};ws=gs=yr([ar({type:Ae.Sequence,itemType:bs})],ws);class As{constructor(e={}){this.algorithm=new nn,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:nn})],As.prototype,"algorithm",void 0),yr([cr({type:Se.BitString})],As.prototype,"publicKey",void 0);let Ss=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:Zi,context:0,implicit:!0,optional:!0})],Ss.prototype,"subjectKeyIdentifier",void 0),yr([cr({type:As,context:1,implicit:!0,optional:!0})],Ss.prototype,"originatorKey",void 0),yr([cr({type:vn,optional:!0})],Ss.prototype,"issuerAndSerialNumber",void 0),Ss=yr([ar({type:Ae.Choice})],Ss);class Bs{constructor(e={}){this.version=bn.v3,this.originator=new Ss,this.keyEncryptionAlgorithm=new Sn,this.recipientEncryptedKeys=new ws,Object.assign(this,e)}}yr([cr({type:Se.Integer})],Bs.prototype,"version",void 0),yr([cr({type:Ss,context:0})],Bs.prototype,"originator",void 0),yr([cr({type:It,context:1,optional:!0})],Bs.prototype,"ukm",void 0),yr([cr({type:Sn})],Bs.prototype,"keyEncryptionAlgorithm",void 0),yr([cr({type:ws})],Bs.prototype,"recipientEncryptedKeys",void 0);let xs=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:Zi,context:0,implicit:!0})],xs.prototype,"subjectKeyIdentifier",void 0),yr([cr({type:vn})],xs.prototype,"issuerAndSerialNumber",void 0),xs=yr([ar({type:Ae.Choice})],xs);class ks{constructor(e={}){this.version=bn.v0,this.rid=new xs,this.keyEncryptionAlgorithm=new Sn,this.encryptedKey=new It,Object.assign(this,e)}}yr([cr({type:Se.Integer})],ks.prototype,"version",void 0),yr([cr({type:xs})],ks.prototype,"rid",void 0),yr([cr({type:Sn})],ks.prototype,"keyEncryptionAlgorithm",void 0),yr([cr({type:It})],ks.prototype,"encryptedKey",void 0);class Os{constructor(e={}){this.keyIdentifier=new It,Object.assign(this,e)}}yr([cr({type:It})],Os.prototype,"keyIdentifier",void 0),yr([cr({type:Se.GeneralizedTime,optional:!0})],Os.prototype,"date",void 0),yr([cr({type:ds,optional:!0})],Os.prototype,"other",void 0);class Es{constructor(e={}){this.version=bn.v4,this.kekid=new Os,this.keyEncryptionAlgorithm=new Sn,this.encryptedKey=new It,Object.assign(this,e)}}yr([cr({type:Se.Integer})],Es.prototype,"version",void 0),yr([cr({type:Os})],Es.prototype,"kekid",void 0),yr([cr({type:Sn})],Es.prototype,"keyEncryptionAlgorithm",void 0),yr([cr({type:It})],Es.prototype,"encryptedKey",void 0);class Cs{constructor(e={}){this.version=bn.v0,this.keyEncryptionAlgorithm=new Sn,this.encryptedKey=new It,Object.assign(this,e)}}yr([cr({type:Se.Integer})],Cs.prototype,"version",void 0),yr([cr({type:kn,context:0,optional:!0})],Cs.prototype,"keyDerivationAlgorithm",void 0),yr([cr({type:Sn})],Cs.prototype,"keyEncryptionAlgorithm",void 0),yr([cr({type:It})],Cs.prototype,"encryptedKey",void 0);class Ns{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],Ns.prototype,"oriType",void 0),yr([cr({type:Se.Any})],Ns.prototype,"oriValue",void 0);let Is=class{constructor(e={}){Object.assign(this,e)}};var Ts;yr([cr({type:ks,optional:!0})],Is.prototype,"ktri",void 0),yr([cr({type:Bs,context:1,implicit:!0,optional:!0})],Is.prototype,"kari",void 0),yr([cr({type:Es,context:2,implicit:!0,optional:!0})],Is.prototype,"kekri",void 0),yr([cr({type:Cs,context:3,implicit:!0,optional:!0})],Is.prototype,"pwri",void 0),yr([cr({type:Ns,context:4,implicit:!0,optional:!0})],Is.prototype,"ori",void 0),Is=yr([ar({type:Ae.Choice})],Is);let js=Ts=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Ts.prototype)}};var Us;js=Ts=yr([ar({type:Ae.Set,itemType:Is})],js);class Vs{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],Vs.prototype,"otherRevInfoFormat",void 0),yr([cr({type:Se.Any})],Vs.prototype,"otherRevInfo",void 0);let Ps=class{constructor(e={}){this.other=new Vs,Object.assign(this,e)}};yr([cr({type:Vs,context:1,implicit:!0})],Ps.prototype,"other",void 0),Ps=yr([ar({type:Ae.Choice})],Ps);let Ls=Us=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Us.prototype)}};Ls=Us=yr([ar({type:Ae.Set,itemType:Ps})],Ls);class Hs{constructor(e={}){Object.assign(this,e)}}var Ds;yr([cr({type:ls,context:0,implicit:!0,optional:!0})],Hs.prototype,"certs",void 0),yr([cr({type:Ls,context:1,implicit:!0,optional:!0})],Hs.prototype,"crls",void 0);let Rs=Ds=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Ds.prototype)}};Rs=Ds=yr([ar({type:Ae.Set,itemType:On})],Rs);class Ms{constructor(e={}){this.version=bn.v0,this.recipientInfos=new js,this.encryptedContentInfo=new ys,Object.assign(this,e)}}var $s;yr([cr({type:Se.Integer})],Ms.prototype,"version",void 0),yr([cr({type:Hs,context:0,implicit:!0,optional:!0})],Ms.prototype,"originatorInfo",void 0),yr([cr({type:js})],Ms.prototype,"recipientInfos",void 0),yr([cr({type:ys})],Ms.prototype,"encryptedContentInfo",void 0),yr([cr({type:Rs,context:1,implicit:!0,optional:!0})],Ms.prototype,"unprotectedAttrs",void 0);let Fs=$s=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,$s.prototype)}};Fs=$s=yr([ar({type:Ae.Set,itemType:wn})],Fs);class Js{constructor(e={}){this.version=bn.v0,this.digestAlgorithms=new Fs,this.encapContentInfo=new ps,this.signerInfos=new Nn,Object.assign(this,e)}}yr([cr({type:Se.Integer})],Js.prototype,"version",void 0),yr([cr({type:Fs})],Js.prototype,"digestAlgorithms",void 0),yr([cr({type:ps})],Js.prototype,"encapContentInfo",void 0),yr([cr({type:ls,context:0,implicit:!0,optional:!0})],Js.prototype,"certificates",void 0),yr([cr({type:Ls,context:1,implicit:!0,optional:!0})],Js.prototype,"crls",void 0),yr([cr({type:Nn})],Js.prototype,"signerInfos",void 0);const _s="1.2.840.10045.2.1",zs="1.2.840.10045.4.1",Ks="1.2.840.10045.4.3.1",qs="1.2.840.10045.4.3.2",Ws="1.2.840.10045.4.3.3",Gs="1.2.840.10045.4.3.4",Zs="1.2.840.10045.3.1.7",Ys="1.3.132.0.34",Xs="1.3.132.0.35";function Qs(e){return new nn({algorithm:e})}const eo=Qs(zs),to=(Qs(Ks),Qs(qs)),ro=Qs(Ws),io=Qs(Gs);let no=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:Se.ObjectIdentifier})],no.prototype,"fieldType",void 0),yr([cr({type:Se.Any})],no.prototype,"parameters",void 0),no=yr([ar({type:Ae.Sequence})],no);let so=class{constructor(e={}){Object.assign(this,e)}};var oo;yr([cr({type:Se.OctetString})],so.prototype,"a",void 0),yr([cr({type:Se.OctetString})],so.prototype,"b",void 0),yr([cr({type:Se.BitString,optional:!0})],so.prototype,"seed",void 0),so=yr([ar({type:Ae.Sequence})],so),function(e){e[e.ecpVer1=1]="ecpVer1"}(oo||(oo={}));let ao=class{constructor(e={}){this.version=oo.ecpVer1,Object.assign(this,e)}};yr([cr({type:Se.Integer})],ao.prototype,"version",void 0),yr([cr({type:no})],ao.prototype,"fieldID",void 0),yr([cr({type:so})],ao.prototype,"curve",void 0),yr([cr({type:class extends It{}})],ao.prototype,"base",void 0),yr([cr({type:Se.Integer,converter:Vt})],ao.prototype,"order",void 0),yr([cr({type:Se.Integer,optional:!0})],ao.prototype,"cofactor",void 0),ao=yr([ar({type:Ae.Sequence})],ao);let co=class{constructor(e={}){Object.assign(this,e)}};yr([cr({type:Se.ObjectIdentifier})],co.prototype,"namedCurve",void 0),yr([cr({type:Se.Null})],co.prototype,"implicitCurve",void 0),yr([cr({type:ao})],co.prototype,"specifiedCurve",void 0),co=yr([ar({type:Ae.Choice})],co);class lo{constructor(e={}){this.version=1,this.privateKey=new It,Object.assign(this,e)}}yr([cr({type:Se.Integer})],lo.prototype,"version",void 0),yr([cr({type:It})],lo.prototype,"privateKey",void 0),yr([cr({type:co,context:0,optional:!0})],lo.prototype,"parameters",void 0),yr([cr({type:Se.BitString,context:1,optional:!0})],lo.prototype,"publicKey",void 0);class uo{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.Integer,converter:Vt})],uo.prototype,"r",void 0),yr([cr({type:Se.Integer,converter:Vt})],uo.prototype,"s",void 0);const ho="1.2.840.113549.1.1",po=`${ho}.1`,fo=`${ho}.7`,yo=`${ho}.9`,go=`${ho}.10`,vo=`${ho}.2`,mo=`${ho}.4`,bo=`${ho}.5`,wo=`${ho}.14`,Ao=`${ho}.11`,So=`${ho}.12`,Bo=`${ho}.13`,xo=`${ho}.15`,ko=`${ho}.16`,Oo="1.3.14.3.2.26",Eo="2.16.840.1.101.3.4.2.4",Co="2.16.840.1.101.3.4.2.1",No="2.16.840.1.101.3.4.2.2",Io="2.16.840.1.101.3.4.2.3",To=`${ho}.8`;function jo(e){return new nn({algorithm:e,parameters:null})}jo("1.2.840.113549.2.2"),jo("1.2.840.113549.2.5");const Uo=jo(Oo),Vo=(jo(Eo),jo(Co),jo(No),jo(Io),jo("2.16.840.1.101.3.4.2.5"),jo("2.16.840.1.101.3.4.2.6"),new nn({algorithm:To,parameters:fr.serialize(Uo)})),Po=new nn({algorithm:yo,parameters:fr.serialize(Dt.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});jo(po),jo(vo),jo(mo),jo(bo),jo(xo),jo(ko),jo(So),jo(Bo),jo(xo),jo(ko);class Lo{constructor(e={}){this.hashAlgorithm=new nn(Uo),this.maskGenAlgorithm=new nn({algorithm:To,parameters:fr.serialize(Uo)}),this.pSourceAlgorithm=new nn(Po),Object.assign(this,e)}}yr([cr({type:nn,context:0,defaultValue:Uo})],Lo.prototype,"hashAlgorithm",void 0),yr([cr({type:nn,context:1,defaultValue:Vo})],Lo.prototype,"maskGenAlgorithm",void 0),yr([cr({type:nn,context:2,defaultValue:Po})],Lo.prototype,"pSourceAlgorithm",void 0),new nn({algorithm:fo,parameters:fr.serialize(new Lo)});class Ho{constructor(e={}){this.hashAlgorithm=new nn(Uo),this.maskGenAlgorithm=new nn({algorithm:To,parameters:fr.serialize(Uo)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}yr([cr({type:nn,context:0,defaultValue:Uo})],Ho.prototype,"hashAlgorithm",void 0),yr([cr({type:nn,context:1,defaultValue:Vo})],Ho.prototype,"maskGenAlgorithm",void 0),yr([cr({type:Se.Integer,context:2,defaultValue:20})],Ho.prototype,"saltLength",void 0),yr([cr({type:Se.Integer,context:3,defaultValue:1})],Ho.prototype,"trailerField",void 0),new nn({algorithm:go,parameters:fr.serialize(new Ho)});class Do{constructor(e={}){this.digestAlgorithm=new nn,this.digest=new It,Object.assign(this,e)}}var Ro;yr([cr({type:nn})],Do.prototype,"digestAlgorithm",void 0),yr([cr({type:It})],Do.prototype,"digest",void 0);class Mo{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.Integer,converter:Vt})],Mo.prototype,"prime",void 0),yr([cr({type:Se.Integer,converter:Vt})],Mo.prototype,"exponent",void 0),yr([cr({type:Se.Integer,converter:Vt})],Mo.prototype,"coefficient",void 0);let $o=Ro=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Ro.prototype)}};$o=Ro=yr([ar({type:Ae.Sequence,itemType:Mo})],$o);class Fo{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.Integer})],Fo.prototype,"version",void 0),yr([cr({type:Se.Integer,converter:Vt})],Fo.prototype,"modulus",void 0),yr([cr({type:Se.Integer,converter:Vt})],Fo.prototype,"publicExponent",void 0),yr([cr({type:Se.Integer,converter:Vt})],Fo.prototype,"privateExponent",void 0),yr([cr({type:Se.Integer,converter:Vt})],Fo.prototype,"prime1",void 0),yr([cr({type:Se.Integer,converter:Vt})],Fo.prototype,"prime2",void 0),yr([cr({type:Se.Integer,converter:Vt})],Fo.prototype,"exponent1",void 0),yr([cr({type:Se.Integer,converter:Vt})],Fo.prototype,"exponent2",void 0),yr([cr({type:Se.Integer,converter:Vt})],Fo.prototype,"coefficient",void 0),yr([cr({type:$o,optional:!0})],Fo.prototype,"otherPrimeInfos",void 0);class Jo{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.Integer,converter:Vt})],Jo.prototype,"modulus",void 0),yr([cr({type:Se.Integer,converter:Vt})],Jo.prototype,"publicExponent",void 0);var _o,zo=r(53266);class Ko{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}yr([cr({type:Se.ObjectIdentifier})],Ko.prototype,"attrId",void 0),yr([cr({type:Se.Any,repeated:"set"})],Ko.prototype,"attrValues",void 0);let qo=_o=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,_o.prototype)}};var Wo;qo=_o=yr([ar({type:Ae.Sequence,itemType:Ko})],qo);let Go=Wo=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Wo.prototype)}};Go=Wo=yr([ar({type:Ae.Sequence,itemType:us})],Go);class Zo{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],Zo.prototype,"certId",void 0),yr([cr({type:Se.Any,context:0})],Zo.prototype,"certValue",void 0);class Yo{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],Yo.prototype,"crlId",void 0),yr([cr({type:Se.Any,context:0})],Yo.prototype,"crltValue",void 0);class Xo extends It{}class Qo{constructor(e={}){this.encryptionAlgorithm=new nn,this.encryptedData=new Xo,Object.assign(this,e)}}var ea,ta;yr([cr({type:nn})],Qo.prototype,"encryptionAlgorithm",void 0),yr([cr({type:Xo})],Qo.prototype,"encryptedData",void 0),function(e){e[e.v1=0]="v1"}(ta||(ta={}));class ra extends It{}let ia=ea=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,ea.prototype)}};ia=ea=yr([ar({type:Ae.Sequence,itemType:Ki})],ia);class na{constructor(e={}){this.version=ta.v1,this.privateKeyAlgorithm=new nn,this.privateKey=new ra,Object.assign(this,e)}}yr([cr({type:Se.Integer})],na.prototype,"version",void 0),yr([cr({type:nn})],na.prototype,"privateKeyAlgorithm",void 0),yr([cr({type:ra})],na.prototype,"privateKey",void 0),yr([cr({type:ia,implicit:!0,context:0,optional:!0})],na.prototype,"attributes",void 0);let sa=class extends na{};sa=yr([ar({type:Ae.Sequence})],sa);let oa=class extends Qo{};oa=yr([ar({type:Ae.Sequence})],oa);class aa{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],aa.prototype,"secretTypeId",void 0),yr([cr({type:Se.Any,context:0})],aa.prototype,"secretValue",void 0);class ca{constructor(e={}){this.mac=new Do,this.macSalt=new It,this.iterations=1,Object.assign(this,e)}}yr([cr({type:Do})],ca.prototype,"mac",void 0),yr([cr({type:It})],ca.prototype,"macSalt",void 0),yr([cr({type:Se.Integer,defaultValue:1})],ca.prototype,"iterations",void 0);class la{constructor(e={}){this.version=3,this.authSafe=new us,this.macData=new ca,Object.assign(this,e)}}var ua;yr([cr({type:Se.Integer})],la.prototype,"version",void 0),yr([cr({type:us})],la.prototype,"authSafe",void 0),yr([cr({type:ca,optional:!0})],la.prototype,"macData",void 0);class ha{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:Se.ObjectIdentifier})],ha.prototype,"bagId",void 0),yr([cr({type:Se.Any,context:0})],ha.prototype,"bagValue",void 0),yr([cr({type:Ko,repeated:"set",optional:!0})],ha.prototype,"bagAttributes",void 0);let pa=ua=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,ua.prototype)}};var fa,ya,da;pa=ua=yr([ar({type:Ae.Sequence,itemType:ha})],pa);const ga="1.2.840.113549.1.9",va=`${ga}.7`,ma=`${ga}.14`;let ba=class extends br{constructor(e={}){super(e)}toString(){return{}.toString(),this.ia5String||super.toString()}};yr([cr({type:Se.IA5String})],ba.prototype,"ia5String",void 0),ba=yr([ar({type:Ae.Choice})],ba);let wa=class extends us{};wa=yr([ar({type:Ae.Sequence})],wa);let Aa=class extends la{};Aa=yr([ar({type:Ae.Sequence})],Aa);let Sa=class extends Qo{};Sa=yr([ar({type:Ae.Sequence})],Sa);let Ba=class{constructor(e=""){this.value=e}toString(){return this.value}};yr([cr({type:Se.IA5String})],Ba.prototype,"value",void 0),Ba=yr([ar({type:Ae.Choice})],Ba);let xa=class extends ba{};xa=yr([ar({type:Ae.Choice})],xa);let ka=class extends br{};ka=yr([ar({type:Ae.Choice})],ka);let Oa=class{constructor(e=new Date){this.value=e}};yr([cr({type:Se.GeneralizedTime})],Oa.prototype,"value",void 0),Oa=yr([ar({type:Ae.Choice})],Oa);let Ea=class extends br{};Ea=yr([ar({type:Ae.Choice})],Ea);let Ca=class{constructor(e="M"){this.value=e}toString(){return this.value}};yr([cr({type:Se.PrintableString})],Ca.prototype,"value",void 0),Ca=yr([ar({type:Ae.Choice})],Ca);let Na=class{constructor(e=""){this.value=e}toString(){return this.value}};yr([cr({type:Se.PrintableString})],Na.prototype,"value",void 0),Na=yr([ar({type:Ae.Choice})],Na);let Ia=class extends Na{};Ia=yr([ar({type:Ae.Choice})],Ia);let Ta=class extends br{};Ta=yr([ar({type:Ae.Choice})],Ta);let ja=class{constructor(e=""){this.value=e}toString(){return this.value}};yr([cr({type:Se.ObjectIdentifier})],ja.prototype,"value",void 0),ja=yr([ar({type:Ae.Choice})],ja);let Ua=class extends on{};Ua=yr([ar({type:Ae.Choice})],Ua);let Va=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};yr([cr({type:Se.Integer})],Va.prototype,"value",void 0),Va=yr([ar({type:Ae.Choice})],Va);let Pa=class extends Cn{};Pa=yr([ar({type:Ae.Sequence})],Pa);let La=class extends br{};La=yr([ar({type:Ae.Choice})],La);let Ha=fa=class extends un{constructor(e){super(e),Object.setPrototypeOf(this,fa.prototype)}};Ha=fa=yr([ar({type:Ae.Sequence})],Ha);let Da=ya=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,ya.prototype)}};Da=ya=yr([ar({type:Ae.Set,itemType:On})],Da);let Ra=class{constructor(e=""){this.value=e}toString(){return this.value}};yr([cr({type:Se.BmpString})],Ra.prototype,"value",void 0),Ra=yr([ar({type:Ae.Choice})],Ra);let Ma=class extends nn{};Ma=yr([ar({type:Ae.Sequence})],Ma);let $a=da=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,da.prototype)}};var Fa;$a=da=yr([ar({type:Ae.Sequence,itemType:Ma})],$a);let Ja=Fa=class extends pr{constructor(e){super(e),Object.setPrototypeOf(this,Fa.prototype)}};Ja=Fa=yr([ar({type:Ae.Sequence,itemType:Ki})],Ja);class _a{constructor(e={}){this.version=0,this.subject=new xr,this.subjectPKInfo=new sn,this.attributes=new Ja,Object.assign(this,e)}}yr([cr({type:Se.Integer})],_a.prototype,"version",void 0),yr([cr({type:xr})],_a.prototype,"subject",void 0),yr([cr({type:sn})],_a.prototype,"subjectPKInfo",void 0),yr([cr({type:Ja,implicit:!0,context:0})],_a.prototype,"attributes",void 0);class za{constructor(e={}){this.certificationRequestInfo=new _a,this.signatureAlgorithm=new nn,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}yr([cr({type:_a})],za.prototype,"certificationRequestInfo",void 0),yr([cr({type:nn})],za.prototype,"signatureAlgorithm",void 0),yr([cr({type:Se.BitString})],za.prototype,"signature",void 0);const Ka="crypto.algorithm",qa="crypto.algorithmProvider";var Wa;zo.nC.registerSingleton(qa,class{getAlgorithms(){return zo.nC.resolveAll(Ka)}toAsnAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toAsnAlgorithm(e);if(r)return r}if(/^[0-9.]+$/.test(e.name)){const t=new nn({algorithm:e.name});if("parameters"in e){const r=e;t.parameters=r.parameters}return t}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}});const Ga="1.3.36.3.3.2.8.1.1",Za=`${Ga}.1`,Ya=`${Ga}.2`,Xa=`${Ga}.3`,Qa=`${Ga}.4`,ec=`${Ga}.5`,tc=`${Ga}.6`,rc=`${Ga}.7`,ic=`${Ga}.8`,nc=`${Ga}.9`,sc=`${Ga}.10`,oc=`${Ga}.11`,ac=`${Ga}.12`,cc=`${Ga}.13`,lc=`${Ga}.14`,uc="brainpoolP160r1",hc="brainpoolP160t1",pc="brainpoolP192r1",fc="brainpoolP192t1",yc="brainpoolP224r1",dc="brainpoolP224t1",gc="brainpoolP256r1",vc="brainpoolP256t1",mc="brainpoolP320r1",bc="brainpoolP320t1",wc="brainpoolP384r1",Ac="brainpoolP384t1",Sc="brainpoolP512r1",Bc="brainpoolP512t1",xc="ECDSA";let kc=Wa=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===xc.toLowerCase())if("hash"in e)switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return eo;case"sha-256":return to;case"sha-384":return ro;case"sha-512":return io}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=Zs;break;case"K-256":t=Wa.SECP256K1;break;case"P-384":t=Ys;break;case"P-521":t=Xs;break;case uc:t=Za;break;case hc:t=Ya;break;case pc:t=Xa;break;case fc:t=Qa;break;case yc:t=ec;break;case dc:t=tc;break;case gc:t=rc;break;case vc:t=ic;break;case mc:t=nc;break;case bc:t=sc;break;case wc:t=oc;break;case Ac:t=ac;break;case Sc:t=cc;break;case Bc:t=lc}if(t)return new nn({algorithm:_s,parameters:fr.serialize(new co({namedCurve:t}))})}return null}toWebAlgorithm(e){switch(e.algorithm){case zs:return{name:xc,hash:{name:"SHA-1"}};case qs:return{name:xc,hash:{name:"SHA-256"}};case Ws:return{name:xc,hash:{name:"SHA-384"}};case Gs:return{name:xc,hash:{name:"SHA-512"}};case _s:if(!e.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(fr.parse(e.parameters,co).namedCurve){case Zs:return{name:xc,namedCurve:"P-256"};case Wa.SECP256K1:return{name:xc,namedCurve:"K-256"};case Ys:return{name:xc,namedCurve:"P-384"};case Xs:return{name:xc,namedCurve:"P-521"};case Za:return{name:xc,namedCurve:uc};case Ya:return{name:xc,namedCurve:hc};case Xa:return{name:xc,namedCurve:pc};case Qa:return{name:xc,namedCurve:fc};case ec:return{name:xc,namedCurve:yc};case tc:return{name:xc,namedCurve:dc};case rc:return{name:xc,namedCurve:gc};case ic:return{name:xc,namedCurve:vc};case nc:return{name:xc,namedCurve:mc};case sc:return{name:xc,namedCurve:bc};case oc:return{name:xc,namedCurve:wc};case ac:return{name:xc,namedCurve:Ac};case cc:return{name:xc,namedCurve:Sc};case lc:return{name:xc,namedCurve:Bc}}}return null}};kc.SECP256K1="1.3.132.0.10",kc=Wa=yr([(0,zo.b2)()],kc),zo.nC.registerSingleton(Ka,kc);const Oc=Symbol("name"),Ec=Symbol("value");class Cc{constructor(e,t={},r=""){this[Oc]=e,this[Ec]=r;for(const e in t)this[e]=t[e]}}Cc.NAME=Oc,Cc.VALUE=Ec;class Nc{static toString(e){return this.items[e]||e}}Nc.items={[Oo]:"sha1",[Eo]:"sha224",[Co]:"sha256",[No]:"sha384",[Io]:"sha512",[po]:"rsaEncryption",[bo]:"sha1WithRSAEncryption",[wo]:"sha224WithRSAEncryption",[Ao]:"sha256WithRSAEncryption",[So]:"sha384WithRSAEncryption",[Bo]:"sha512WithRSAEncryption",[_s]:"ecPublicKey",[zs]:"ecdsaWithSHA1",[Ks]:"ecdsaWithSHA224",[qs]:"ecdsaWithSHA256",[Ws]:"ecdsaWithSHA384",[Gs]:"ecdsaWithSHA512",[Si]:"TLS WWW server authentication",[Bi]:"TLS WWW client authentication",[xi]:"Code Signing",[ki]:"E-mail Protection",[Oi]:"Time Stamping",[Ei]:"OCSP Signing","1.2.840.113549.1.7.2":"Signed Data"};class Ic{static serialize(e){return this.serializeObj(e).join("\n")}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,t=0){const r=[];let i=this.pad(t++),s="";const o=e[Cc.VALUE];o&&(s=` ${o}`),r.push(`${i}${e[Cc.NAME]}:${s}`),i=this.pad(t);for(const s in e){if("symbol"==typeof s)continue;const o=e[s],a=s?`${s}: `:"";if("string"==typeof o||"number"==typeof o||"boolean"==typeof o)r.push(`${i}${a}${o}`);else if(o instanceof Date)r.push(`${i}${a}${o.toUTCString()}`);else if(Array.isArray(o))for(const e of o)e[Cc.NAME]=s,r.push(...this.serializeObj(e,t));else if(o instanceof Cc)o[Cc.NAME]=s,r.push(...this.serializeObj(o,t));else if(n.vJ.isBufferSource(o))s?(r.push(`${i}${a}`),r.push(...this.serializeBufferSource(o,t+1))):r.push(...this.serializeBufferSource(o,t));else{if(!("toTextObject"in o))throw new TypeError("Cannot serialize data in text format. Unsupported type.");{const e=o.toTextObject();e[Cc.NAME]=s,r.push(...this.serializeObj(e,t))}}}return r}static serializeBufferSource(e,t=0){const r=this.pad(t),i=n.vJ.toUint8Array(e),s=[];for(let e=0;e<i.length;){const t=[];for(let r=0;r<16&&e<i.length;r++){8===r&&t.push("");const n=i[e++].toString(16).padStart(2,"0");t.push(n)}s.push(`${r}${t.join(" ")}`)}return s}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}}Ic.oidSerializer=Nc,Ic.algorithmSerializer=class{static toTextObject(e){const t=new Cc("Algorithm Identifier",{},Nc.toString(e.algorithm));if(e.parameters)switch(e.algorithm){case _s:{const r=(new kc).toWebAlgorithm(e);r&&"namedCurve"in r?t["Named Curve"]=r.namedCurve:t.Parameters=e.parameters;break}default:t.Parameters=e.parameters}return t}};class Tc{constructor(...e){if(1===e.length){const t=e[0];this.rawData=fr.serialize(t),this.onInit(t)}else{const t=fr.parse(e[0],e[1]);this.rawData=n.vJ.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof Tc&&(0,n.Xy)(e.rawData,this.rawData)}toString(e="text"){switch(e){case"asn":return fr.toString(this.rawData);case"text":return Ic.serialize(this.toTextObject());case"hex":return n.ep.ToHex(this.rawData);case"base64":return n.ep.ToBase64(this.rawData);case"base64url":return n.ep.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){const e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new Cc(this.getTextName(),{},e)}}Tc.NAME="ASN";class jc extends Tc{constructor(...e){let t;t=n.vJ.isBufferSource(e[0])?n.vJ.toArrayBuffer(e[0]):fr.serialize(new ln({extnID:e[0],critical:e[1],extnValue:new It(n.vJ.toArrayBuffer(e[2]))})),super(t,ln)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){const e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){const e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[Cc.NAME]===jc.NAME&&(e[Cc.NAME]=Nc.toString(this.type)),e}}var Uc;class Vc{static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}constructor(){this.items=new Map,this[Uc]="CryptoProvider","undefined"!=typeof self&&"undefined"!=typeof crypto?this.set(Vc.DEFAULT,crypto):void 0!==r.g&&r.g.crypto&&r.g.crypto.subtle&&this.set(Vc.DEFAULT,r.g.crypto)}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=Vc.DEFAULT){const t=this.items.get(e.toLowerCase());if(!t)throw new Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw new TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(Vc.DEFAULT,e);return this}}Uc=Symbol.toStringTag,Vc.DEFAULT="default";const Pc=new Vc,Lc=/^[0-2](?:\.[1-9][0-9]*)+$/;class Hc{constructor(e={}){this.items={};for(const t in e)this.register(t,e[t])}get(e){return this.items[e]||null}findId(e){return t=e,new RegExp(Lc).test(t)?e:this.get(e);var t}register(e,t){this.items[e]=t,this.items[t]=e}}const Dc=new Hc;function Rc(e,t){return`\\${n.ep.ToHex(n.ep.FromUtf8String(t)).toUpperCase()}`}Dc.register("CN","2.5.4.3"),Dc.register("L","2.5.4.7"),Dc.register("ST","2.5.4.8"),Dc.register("O","2.5.4.10"),Dc.register("OU","2.5.4.11"),Dc.register("C","2.5.4.6"),Dc.register("DC","0.9.2342.19200300.100.1.25"),Dc.register("E","1.2.840.113549.1.9.1"),Dc.register("G","2.5.4.42"),Dc.register("I","2.5.4.43"),Dc.register("SN","2.5.4.4"),Dc.register("T","2.5.4.12");class Mc{static isASCII(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0}static isPrintableString(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(e)}constructor(e,t={}){this.extraNames=new Hc,this.asn=new xr;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof xr?this.asn=e:n.vJ.isBufferSource(e)?this.asn=fr.parse(e,xr):this.asn=this.fromJSON(e)}getField(e){const t=this.extraNames.findId(e)||Dc.findId(e),r=[];for(const e of this.asn)for(const i of e)i.type===t&&r.push(i.value.toString());return r}getName(e){return this.extraNames.get(e)||Dc.get(e)}toString(){return this.asn.map((e=>e.map((e=>`${this.getName(e.type)||e.type}=${e.value.anyValue?`#${n.ep.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,Rc)}`)).join("+"))).join(", ")}toJSON(){var e;const t=[];for(const r of this.asn){const i={};for(const t of r){const r=this.getName(t.type)||t.type;null!==(e=i[r])&&void 0!==e||(i[r]=[]),i[r].push(t.value.anyValue?`#${n.ep.ToHex(t.value.anyValue)}`:t.value.toString())}t.push(i)}return t}fromString(e){const t=new xr,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+"\\](?=[,+]|$))|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let i=null,n=",";for(;i=r.exec(`${e},`);){let[,e,r]=i;const s=r[r.length-1];","!==s&&"+"!==s||(r=r.slice(0,r.length-1),i[3]=s);const o=i[3];e=this.getTypeOid(e);const a=this.createAttribute(e,r);"+"===n?t[t.length-1].push(a):t.push(new Sr([a])),n=o}return t}fromJSON(e){const t=new xr;for(const r of e){const e=new Sr;for(const t in r){const i=this.getTypeOid(t),n=r[t];for(const t of n){const r=this.createAttribute(i,t);e.push(r)}}t.push(e)}return t}getTypeOid(e){if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw new Error(`Cannot get OID for name type '${e}'`);return e}createAttribute(e,t){const r=new Ar({type:e});if("object"==typeof t)for(const e in t)switch(e){case"ia5String":r.value.ia5String=t[e];break;case"utf8String":r.value.utf8String=t[e];break;case"universalString":r.value.universalString=t[e];break;case"bmpString":r.value.bmpString=t[e];break;case"printableString":r.value.printableString=t[e]}else if("#"===t[0])r.value.anyValue=n.ep.FromHex(t.slice(1));else{const i=this.processStringValue(t);e===this.getName("E")||e===this.getName("DC")?r.value.ia5String=i:Mc.isPrintableString(i)?r.value.printableString=i:r.value.utf8String=i}return r}processStringValue(e){const t=/"(.*?[^\\])?"/.exec(e);return t&&(e=t[1]),e.replace(/\\0a/gi,"\n").replace(/\\0d/gi,"\r").replace(/\\0g/gi,"\t").replace(/\\(.)/g,"$1")}toArrayBuffer(){return fr.serialize(this.asn)}async getThumbprint(...e){var t;let r,i="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(i=e[0]||i,r=e[1]||Pc.get()):r=e[0]||Pc.get(),await r.subtle.digest(i,this.toArrayBuffer())}}const $c="Cannot initialize GeneralName from ASN.1 data.",Fc=`${$c} Unsupported string format in use.`,Jc=`${$c} Value doesn't match to GUID regular expression.`,_c=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,zc="1.3.6.1.4.1.311.25.1",Kc="1.3.6.1.4.1.311.20.2.3",qc="dns",Wc="dn",Gc="email",Zc="ip",Yc="url",Xc="guid",Qc="upn",el="id";class tl extends Tc{constructor(...e){let t;if(2===e.length)switch(e[0]){case Wc:{const r=new Mc(e[1]).toArrayBuffer(),i=fr.parse(r,xr);t=new Cr({directoryName:i});break}case qc:t=new Cr({dNSName:e[1]});break;case Gc:t=new Cr({rfc822Name:e[1]});break;case Xc:{const r=new RegExp(_c,"i").exec(e[1]);if(!r)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const i=r.slice(1).map(((e,t)=>t<3?n.ep.ToHex(new Uint8Array(n.ep.FromHex(e)).reverse()):e)).join("");t=new Cr({otherName:new Or({typeId:zc,value:fr.serialize(new It(n.ep.FromHex(i)))})});break}case Zc:t=new Cr({iPAddress:e[1]});break;case el:t=new Cr({registeredID:e[1]});break;case Qc:t=new Cr({otherName:new Or({typeId:Kc,value:fr.serialize($t.toASN(e[1]))})});break;case Yc:t=new Cr({uniformResourceIdentifier:e[1]});break;default:throw new Error("Cannot create GeneralName. Unsupported type of the name")}else t=n.vJ.isBufferSource(e[0])?fr.parse(e[0],Cr):e[0];super(t)}onInit(e){if(null!=e.dNSName)this.type=qc,this.value=e.dNSName;else if(null!=e.rfc822Name)this.type=Gc,this.value=e.rfc822Name;else if(null!=e.iPAddress)this.type=Zc,this.value=e.iPAddress;else if(null!=e.uniformResourceIdentifier)this.type=Yc,this.value=e.uniformResourceIdentifier;else if(null!=e.registeredID)this.type=el,this.value=e.registeredID;else if(null!=e.directoryName)this.type=Wc,this.value=new Mc(e.directoryName).toString();else{if(null==e.otherName)throw new Error(Fc);if(e.otherName.typeId===zc){this.type=Xc;const t=fr.parse(e.otherName.value,It),r=new RegExp(_c,"i").exec(n.ep.ToHex(t));if(!r)throw new Error(Jc);this.value=r.slice(1).map(((e,t)=>t<3?n.ep.ToHex(new Uint8Array(n.ep.FromHex(e)).reverse()):e)).join("-")}else{if(e.otherName.typeId!==Kc)throw new Error(Fc);this.type=Qc,this.value=fr.parse(e.otherName.value,br).toString()}}}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case Wc:case qc:case Xc:case Zc:case el:case Qc:case Yc:e=this.type.toUpperCase();break;case Gc:e="Email";break;default:throw new Error("Unsupported GeneralName type")}let t=this.value;return this.type===el&&(t=Nc.toString(t)),new Cc(e,void 0,t)}}class rl extends Tc{constructor(e){let t;if(e instanceof qr)t=e;else if(Array.isArray(e)){const r=[];for(const t of e)if(t instanceof Cr)r.push(t);else{const e=fr.parse(new tl(t.type,t.value).rawData,Cr);r.push(e)}t=new qr(r)}else{if(!n.vJ.isBufferSource(e))throw new Error("Cannot initialize GeneralNames. Incorrect incoming arguments");t=fr.parse(e,qr)}super(t)}onInit(e){const t=[];for(const r of e){let e=null;try{e=new tl(r)}catch{continue}t.push(e)}this.items=t}toJSON(){return this.items.map((e=>e.toJSON()))}toTextObject(){const e=super.toTextObjectEmpty();for(const t of this.items){const r=t.toTextObject();let i=e[r[Cc.NAME]];Array.isArray(i)||(i=[],e[r[Cc.NAME]]=i),i.push(r)}return e}}rl.NAME="GeneralNames";const il="-{5}",nl="\\n",sl="\\n",ol=`${il}BEGIN ([^${nl}]+(?=${il}))${il}${sl}(?:((?:[^:${nl}]+: (?:[^${nl}]+${sl}(?: +[^${nl}]+${sl})*))+))?${sl}?((?:[a-zA-Z0-9=+/]+${sl})+)${il}END \\1${il}`;class al{static isPem(e){return"string"==typeof e&&new RegExp(ol,"g").test(e.replace(/\r/g,""))}static decodeWithHeaders(e){e=e.replace(/\r/g,"");const t=new RegExp(ol,"g"),r=[];let i=null;for(;i=t.exec(e);){const e=i[3].replace(new RegExp(`[${nl}]+`,"g"),""),t={type:i[1],headers:[],rawData:n.ep.FromBase64(e)},s=i[2];if(s){const e=s.split(new RegExp(sl,"g"));let r=null;for(const i of e){const[e,n]=i.split(/:(.*)/);if(void 0===n){if(!r)throw new Error("Cannot parse PEM string. Incorrect header value");r.value+=e.trim()}else r&&t.headers.push(r),r={key:e,value:n.trim()}}r&&t.headers.push(r)}r.push(t)}return r}static decode(e){return this.decodeWithHeaders(e).map((e=>e.rawData))}static decodeFirst(e){const t=this.decode(e);if(!t.length)throw new RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){const r=new Array;return t?e.forEach((e=>{if(!n.vJ.isBufferSource(e))throw new TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");r.push(this.encodeStruct({type:t,rawData:n.vJ.toArrayBuffer(e)}))})):e.forEach((e=>{if(!("type"in e))throw new TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");r.push(this.encodeStruct(e))})),r.join("\n")}if(!t)throw new Error("Required argument 'tag' is missed");return this.encodeStruct({type:t,rawData:n.vJ.toArrayBuffer(e)})}static encodeStruct(e){var t;const r=e.type.toLocaleUpperCase(),i=[];if(i.push(`-----BEGIN ${r}-----`),null===(t=e.headers)||void 0===t?void 0:t.length){for(const t of e.headers)i.push(`${t.key}: ${t.value}`);i.push("")}const s=n.ep.ToBase64(e.rawData);let o,a=0;const c=Array();for(;a<s.length&&(s.length-a<64?o=s.substring(a):(o=s.substring(a,a+64),a+=64),0!==o.length)&&(c.push(o),!(o.length<64)););return i.push(...c),i.push(`-----END ${r}-----`),i.join("\n")}}al.CertificateTag="CERTIFICATE",al.CrlTag="CRL",al.CertificateRequestTag="CERTIFICATE REQUEST",al.PublicKeyTag="PUBLIC KEY",al.PrivateKeyTag="PRIVATE KEY";class cl extends Tc{static isAsnEncoded(e){return n.vJ.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e){if(al.isPem(e))return al.decode(e)[0];if(n.ep.isHex(e))return n.ep.FromHex(e);if(n.ep.isBase64(e))return n.ep.FromBase64(e);if(n.ep.isBase64Url(e))return n.ep.FromBase64Url(e);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}{const t=n.ep.ToBinary(e);return al.isPem(t)?al.decode(t)[0]:n.ep.isHex(t)?n.ep.FromHex(t):n.ep.isBase64(t)?n.ep.FromBase64(t):n.ep.isBase64Url(t)?n.ep.FromBase64Url(t):n.vJ.toArrayBuffer(e)}}constructor(...e){cl.isAsnEncoded(e[0])?super(cl.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){return"pem"===e?al.encode(this.rawData,this.tag):super.toString(e)}}class ll extends cl{static async create(e,t=Pc.get()){if(e instanceof ll)return e;if(Vc.isCryptoKey(e)){if("public"!==e.type)throw new TypeError("Public key is required");const r=await t.subtle.exportKey("spki",e);return new ll(r)}if(e.publicKey)return e.publicKey;if(n.vJ.isBufferSource(e))return new ll(e);throw new TypeError("Unsupported PublicKeyType")}constructor(e){cl.isAsnEncoded(e)?super(e,sn):super(e),this.tag=al.PublicKeyTag}async export(...e){let t,r=["verify"],i={hash:"SHA-256",...this.algorithm};e.length>1?(i=e[0]||i,r=e[1]||r,t=e[2]||Pc.get()):t=e[0]||Pc.get();let n=this.rawData;const s=fr.parse(this.rawData,sn);return s.algorithm.algorithm===go&&(n=function(e,t){return e.algorithm=new nn({algorithm:po,parameters:null}),fr.serialize(e)}(s)),t.subtle.importKey("spki",n,i,!0,r)}onInit(e){const t=zo.nC.resolve(qa),r=this.algorithm=t.toWebAlgorithm(e.algorithm);switch(e.algorithm.algorithm){case po:{const t=fr.parse(e.subjectPublicKey,Jo),i=n.vJ.toUint8Array(t.modulus);r.publicExponent=n.vJ.toUint8Array(t.publicExponent),r.modulusLength=(i[0]?i:i.slice(1)).byteLength<<3;break}}}async getThumbprint(...e){var t;let r,i="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(i=e[0]||i,r=e[1]||Pc.get()):r=e[0]||Pc.get(),await r.subtle.digest(i,this.rawData)}async getKeyIdentifier(...e){let t,r="SHA-1";1===e.length?"string"==typeof e[0]?(r=e[0],t=Pc.get()):t=e[0]:2===e.length?(r=e[0],t=e[1]):t=Pc.get();const i=fr.parse(this.rawData,sn);return await t.subtle.digest(r,i.subjectPublicKey)}toTextObject(){const e=this.toTextObjectEmpty(),t=fr.parse(this.rawData,sn);return e.Algorithm=Ic.serializeAlgorithm(t.algorithm),t.algorithm.algorithm===_s?e["EC Point"]=t.subjectPublicKey:e["Raw Data"]=t.subjectPublicKey,e}}class ul extends jc{static async create(e,t=!1,r=Pc.get()){if("name"in e&&"serialNumber"in e)return new ul(e,t);const i=await ll.create(e,r),s=await i.getKeyIdentifier(r);return new ul(n.ep.ToHex(s),t)}constructor(...e){if(n.vJ.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0]){const t=new Jr({keyIdentifier:new Fr(n.ep.FromHex(e[0]))});super($r,e[1],fr.serialize(t))}else{const t=e[0],r=t.name instanceof rl?fr.parse(t.name.rawData,qr):t.name,i=new Jr({authorityCertIssuer:r,authorityCertSerialNumber:n.ep.FromHex(t.serialNumber)});super($r,e[1],fr.serialize(i))}}onInit(e){super.onInit(e);const t=fr.parse(e.extnValue,Jr);t.keyIdentifier&&(this.keyId=n.ep.ToHex(t.keyIdentifier)),(t.authorityCertIssuer||t.authorityCertSerialNumber)&&(this.certId={name:t.authorityCertIssuer||[],serialNumber:t.authorityCertSerialNumber?n.ep.ToHex(t.authorityCertSerialNumber):""})}toTextObject(){const e=this.toTextObjectWithoutValue(),t=fr.parse(this.value,Jr);return t.authorityCertIssuer&&(e["Authority Issuer"]=new rl(t.authorityCertIssuer).toTextObject()),t.authorityCertSerialNumber&&(e["Authority Serial Number"]=t.authorityCertSerialNumber),t.keyIdentifier&&(e[""]=t.keyIdentifier),e}}ul.NAME="Authority Key Identifier";class hl extends jc{constructor(...e){if(n.vJ.isBufferSource(e[0])){super(e[0]);const t=fr.parse(this.value,zr);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new zr({cA:e[0],pathLenConstraint:e[1]});super(_r,e[2],fr.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}toTextObject(){const e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),void 0!==this.pathLength&&(e["Path Length"]=this.pathLength),e}}var pl,fl;hl.NAME="Basic Constraints",function(e){e.serverAuth="1.3.6.1.5.5.7.3.1",e.clientAuth="1.3.6.1.5.5.7.3.2",e.codeSigning="1.3.6.1.5.5.7.3.3",e.emailProtection="1.3.6.1.5.5.7.3.4",e.timeStamping="1.3.6.1.5.5.7.3.8",e.ocspSigning="1.3.6.1.5.5.7.3.9"}(pl||(pl={}));class yl extends jc{constructor(...e){if(n.vJ.isBufferSource(e[0])){super(e[0]);const t=fr.parse(this.value,Ai);this.usages=t.map((e=>e))}else{const t=new Ai(e[0]);super(wi,e[1],fr.serialize(t)),this.usages=e[0]}}toTextObject(){const e=this.toTextObjectWithoutValue();return e[""]=this.usages.map((e=>Nc.toString(e))).join(", "),e}}yl.NAME="Extended Key Usages",function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(fl||(fl={}));class dl extends jc{constructor(...e){if(n.vJ.isBufferSource(e[0])){super(e[0]);const t=fr.parse(this.value,Pi);this.usages=t.toNumber()}else{const t=new Pi(e[0]);super(ji,e[1],fr.serialize(t)),this.usages=e[0]}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=fr.parse(this.value,Pi);return e[""]=t.toJSON().join(", "),e}}dl.NAME="Key Usages";class gl extends jc{static async create(e,t=!1,r=Pc.get()){const i=await ll.create(e,r),s=await i.getKeyIdentifier(r);return new gl(n.ep.ToHex(s),t)}constructor(...e){if(n.vJ.isBufferSource(e[0])){super(e[0]);const t=fr.parse(this.value,Zi);this.keyId=n.ep.ToHex(t)}else{const t="string"==typeof e[0]?n.ep.FromHex(e[0]):e[0],r=new Zi(t);super(Gi,e[1],fr.serialize(r)),this.keyId=n.ep.ToHex(t)}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=fr.parse(this.value,Zi);return e[""]=t,e}}gl.NAME="Subject Key Identifier";class vl extends jc{constructor(...e){n.vJ.isBufferSource(e[0])?super(e[0]):super(_i,e[1],new rl(e[0]||[]).rawData)}onInit(e){super.onInit(e);const t=fr.parse(e.extnValue,zi);this.names=new rl(t)}toTextObject(){const e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(const r in t)e[r]=t[r];return e}}vl.NAME="Subject Alternative Name";class ml{static register(e,t){this.items.set(e,t)}static create(e){const t=new jc(e),r=this.items.get(t.type);return r?new r(e):t}}ml.items=new Map;class bl extends jc{constructor(...e){var t;if(n.vJ.isBufferSource(e[0])){super(e[0]);const t=fr.parse(this.value,ni);this.policies=t.map((e=>e.policyIdentifier))}else{const r=e[0],i=null!==(t=e[1])&&void 0!==t&&t,n=new ni(r.map((e=>new ii({policyIdentifier:e}))));super(Yr,i,fr.serialize(n)),this.policies=r}}toTextObject(){const e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map((e=>new Cc("",{},Nc.toString(e)))),e}}bl.NAME="Certificate Policies",ml.register(Yr,bl);class wl extends jc{constructor(...e){var t;if(n.vJ.isBufferSource(e[0]))super(e[0]);else if(Array.isArray(e[0])&&"string"==typeof e[0][0]){const t=e[0].map((e=>new pi({distributionPoint:new hi({fullName:[new Cr({uniformResourceIdentifier:e})]})}))),r=new fi(t);super(ci,e[1],fr.serialize(r))}else{const t=new fi(e[0]);super(ci,e[1],fr.serialize(t))}null!==(t=this.distributionPoints)&&void 0!==t||(this.distributionPoints=[])}onInit(e){super.onInit(e);const t=fr.parse(e.extnValue,fi);this.distributionPoints=t}toTextObject(){const e=this.toTextObjectWithoutValue();return e["Distribution Point"]=this.distributionPoints.map((e=>{var t;const r={};return e.distributionPoint&&(r[""]=null===(t=e.distributionPoint.fullName)||void 0===t?void 0:t.map((e=>new tl(e).toString())).join(", ")),e.reasons&&(r.Reasons=e.reasons.toString()),e.cRLIssuer&&(r["CRL Issuer"]=e.cRLIssuer.map((e=>e.toString())).join(", ")),r})),e}}wl.NAME="CRL Distribution Points";class Al extends jc{constructor(...e){var t,r,i,s;if(n.vJ.isBufferSource(e[0]))super(e[0]);else if(e[0]instanceof Mr){const t=new Mr(e[0]);super(Dr,e[1],fr.serialize(t))}else{const t=e[0],r=new Mr;Bl(r,t,jr,"ocsp"),Bl(r,t,Ur,"caIssuers"),Bl(r,t,Vr,"timeStamping"),Bl(r,t,Pr,"caRepository"),super(Dr,e[1],fr.serialize(r))}null!==(t=this.ocsp)&&void 0!==t||(this.ocsp=[]),null!==(r=this.caIssuers)&&void 0!==r||(this.caIssuers=[]),null!==(i=this.timeStamping)&&void 0!==i||(this.timeStamping=[]),null!==(s=this.caRepository)&&void 0!==s||(this.caRepository=[])}onInit(e){super.onInit(e),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],fr.parse(e.extnValue,Mr).forEach((e=>{switch(e.accessMethod){case jr:this.ocsp.push(new tl(e.accessLocation));break;case Ur:this.caIssuers.push(new tl(e.accessLocation));break;case Vr:this.timeStamping.push(new tl(e.accessLocation));break;case Pr:this.caRepository.push(new tl(e.accessLocation))}}))}toTextObject(){const e=this.toTextObjectWithoutValue();return this.ocsp.length&&Sl(e,"OCSP",this.ocsp),this.caIssuers.length&&Sl(e,"CA Issuers",this.caIssuers),this.timeStamping.length&&Sl(e,"Time Stamping",this.timeStamping),this.caRepository.length&&Sl(e,"CA Repository",this.caRepository),e}}function Sl(e,t,r){if(1===r.length)e[t]=r[0].toTextObject();else{const i=new Cc("");r.forEach(((e,t)=>{const r=e.toTextObject(),n=`${r[Cc.NAME]} ${t+1}`;let s=i[n];Array.isArray(s)||(s=[],i[n]=s),s.push(r)})),e[t]=i}}function Bl(e,t,r,i){const n=t[i];n&&(Array.isArray(n)?n:[n]).forEach((t=>{"string"==typeof t&&(t=new tl("url",t)),e.push(new Rr({accessMethod:r,accessLocation:fr.parse(t.rawData,Cr)}))}))}Al.NAME="Authority Info Access";class xl extends Tc{constructor(...e){let t;if(n.vJ.isBufferSource(e[0]))t=n.vJ.toArrayBuffer(e[0]);else{const r=e[0],i=Array.isArray(e[1])?e[1].map((e=>n.vJ.toArrayBuffer(e))):[];t=fr.serialize(new Ki({type:r,values:i}))}super(t,Ki)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){const e=this.toTextObjectWithoutValue();return e.Value=this.values.map((e=>new Cc("",{"":e}))),e}toTextObjectWithoutValue(){const e=this.toTextObjectEmpty();return e[Cc.NAME]===xl.NAME&&(e[Cc.NAME]=Nc.toString(this.type)),e}}xl.NAME="Attribute";class kl extends xl{constructor(...e){var t;if(n.vJ.isBufferSource(e[0]))super(e[0]);else{const t=new La({printableString:e[0]});super(va,[fr.serialize(t)])}null!==(t=this.password)&&void 0!==t||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){const e=fr.parse(this.values[0],La);this.password=e.toString()}}toTextObject(){const e=this.toTextObjectWithoutValue();return e[Cc.VALUE]=this.password,e}}kl.NAME="Challenge Password";class Ol extends xl{constructor(...e){var t;if(n.vJ.isBufferSource(e[0]))super(e[0]);else{const t=e[0],r=new un;for(const e of t)r.push(fr.parse(e.rawData,ln));super(ma,[fr.serialize(r)])}null!==(t=this.items)&&void 0!==t||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){const e=fr.parse(this.values[0],un);this.items=e.map((e=>ml.create(fr.serialize(e))))}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=this.items.map((e=>e.toTextObject()));for(const r of t)e[r[Cc.NAME]]=r;return e}}Ol.NAME="Extensions";class El{static register(e,t){this.items.set(e,t)}static create(e){const t=new xl(e),r=this.items.get(t.type);return r?new r(e):t}}El.items=new Map;const Cl="crypto.signatureFormatter";var Nl;let Il=Nl=class{static createPssParams(e,t){const r=Nl.getHashAlgorithm(e);return r?new Ho({hashAlgorithm:r,maskGenAlgorithm:new nn({algorithm:To,parameters:fr.serialize(r)}),saltLength:t}):null}static getHashAlgorithm(e){const t=zo.nC.resolve(qa);return"string"==typeof e?t.toAsnAlgorithm({name:e}):"object"==typeof e&&e&&"name"in e?t.toAsnAlgorithm(e):null}toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if(!("hash"in e))return new nn({algorithm:po,parameters:null});{let t;if("string"==typeof e.hash)t=e.hash;else{if(!e.hash||"object"!=typeof e.hash||!("name"in e.hash)||"string"!=typeof e.hash.name)throw new Error("Cannot get hash algorithm name");t=e.hash.name.toUpperCase()}switch(t.toLowerCase()){case"sha-1":return new nn({algorithm:bo,parameters:null});case"sha-256":return new nn({algorithm:Ao,parameters:null});case"sha-384":return new nn({algorithm:So,parameters:null});case"sha-512":return new nn({algorithm:Bo,parameters:null})}}break;case"rsa-pss":if("hash"in e){if(!("saltLength"in e)||"number"!=typeof e.saltLength)throw new Error("Cannot get 'saltLength' from 'alg' argument");const t=Nl.createPssParams(e.hash,e.saltLength);if(!t)throw new Error("Cannot create PSS parameters");return new nn({algorithm:go,parameters:fr.serialize(t)})}return new nn({algorithm:go,parameters:null})}return null}toWebAlgorithm(e){switch(e.algorithm){case po:return{name:"RSASSA-PKCS1-v1_5"};case bo:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case Ao:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case So:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case Bo:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case go:if(e.parameters){const t=fr.parse(e.parameters,Ho);return{name:"RSA-PSS",hash:zo.nC.resolve(qa).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}return{name:"RSA-PSS"}}return null}};Il=Nl=yr([(0,zo.b2)()],Il),zo.nC.registerSingleton(Ka,Il);let Tl=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"sha-1":return new nn({algorithm:Oo});case"sha-256":return new nn({algorithm:Co});case"sha-384":return new nn({algorithm:No});case"sha-512":return new nn({algorithm:Io})}return null}toWebAlgorithm(e){switch(e.algorithm){case Oo:return{name:"SHA-1"};case Co:return{name:"SHA-256"};case No:return{name:"SHA-384"};case Io:return{name:"SHA-512"}}return null}};Tl=yr([(0,zo.b2)()],Tl),zo.nC.registerSingleton(Ka,Tl);class jl{addPadding(e,t){const r=n.vJ.toUint8Array(t),i=new Uint8Array(e);return i.set(r,e-r.length),i}removePadding(e,t=!1){let r=n.vJ.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){const e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){const r=e.namedCurve,i=jl.namedCurveSize.get(r)||jl.defaultNamedCurveSize,s=new uo,o=n.vJ.toUint8Array(t);return s.r=this.removePadding(o.slice(0,i),!0),s.s=this.removePadding(o.slice(i,i+i),!0),fr.serialize(s)}return null}toWebSignature(e,t){if("ECDSA"===e.name){const r=fr.parse(t,uo),i=e.namedCurve,s=jl.namedCurveSize.get(i)||jl.defaultNamedCurveSize,o=this.addPadding(s,this.removePadding(r.r)),a=this.addPadding(s,this.removePadding(r.s));return(0,n.$e)(o,a)}return null}}jl.namedCurveSize=new Map,jl.defaultNamedCurveSize=32;const Ul="1.3.101.110",Vl="1.3.101.111",Pl="1.3.101.112",Ll="1.3.101.113";let Hl=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"ed25519":t=Pl;break;case"x25519":t=Ul;break;case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=Pl;break;case"ed448":t=Ll}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=Ul;break;case"x448":t=Vl}}return t?new nn({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case Pl:return{name:"Ed25519"};case Ll:return{name:"EdDSA",namedCurve:"Ed448"};case Ul:return{name:"X25519"};case Vl:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};Hl=yr([(0,zo.b2)()],Hl),zo.nC.registerSingleton(Ka,Hl);(class extends cl{constructor(e){cl.isAsnEncoded(e)?super(e,za):super(e),this.tag=al.CertificateRequestTag}onInit(e){this.tbs=fr.serialize(e.certificationRequestInfo),this.publicKey=new ll(e.certificationRequestInfo.subjectPKInfo);const t=zo.nC.resolve(qa);this.signatureAlgorithm=t.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signature,this.attributes=e.certificationRequestInfo.attributes.map((e=>El.create(fr.serialize(e))));const r=this.getAttribute(ma);this.extensions=[],r instanceof Ol&&(this.extensions=r.items),this.subjectName=new Mc(e.certificationRequestInfo.subject),this.subject=this.subjectName.toString()}getAttribute(e){for(const t of this.attributes)if(t.type===e)return t;return null}getAttributes(e){return this.attributes.filter((t=>t.type===e))}getExtension(e){for(const t of this.extensions)if(t.type===e)return t;return null}getExtensions(e){return this.extensions.filter((t=>t.type===e))}async verify(e=Pc.get()){const t={...this.publicKey.algorithm,...this.signatureAlgorithm},r=await this.publicKey.export(t,["verify"],e),i=zo.nC.resolveAll(Cl).reverse();let n=null;for(const e of i)if(n=e.toWebSignature(t,this.signature),n)break;if(!n)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await e.subtle.verify(this.signatureAlgorithm,r,n,this.tbs)}toTextObject(){const e=this.toTextObjectEmpty(),t=fr.parse(this.rawData,za),r=t.certificationRequestInfo,i=new Cc("",{Version:`${hn[r.version]} (${r.version})`,Subject:this.subject,"Subject Public Key Info":this.publicKey});if(this.attributes.length){const e=new Cc("");for(const t of this.attributes){const r=t.toTextObject();e[r[Cc.NAME]]=r}i.Attributes=e}return e.Data=i,e.Signature=new Cc("",{Algorithm:Ic.serializeAlgorithm(t.signatureAlgorithm),"":t.signature}),e}}).NAME="PKCS#10 Certificate Request";class Dl extends cl{constructor(e){cl.isAsnEncoded(e)?super(e,fn):super(e),this.tag=al.CertificateTag}onInit(e){const t=e.tbsCertificate;this.tbs=fr.serialize(t);let r=new Uint8Array(t.serialNumber);r.length>1&&0===r[0]&&r[1]>127&&(r=r.slice(1)),this.serialNumber=n.ep.ToHex(r),this.subjectName=new Mc(t.subject),this.subject=new Mc(t.subject).toString(),this.issuerName=new Mc(t.issuer),this.issuer=this.issuerName.toString();const i=zo.nC.resolve(qa);this.signatureAlgorithm=i.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;const s=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!s)throw new Error("Cannot get 'notBefore' value");this.notBefore=s;const o=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!o)throw new Error("Cannot get 'notAfter' value");this.notAfter=o,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map((e=>ml.create(fr.serialize(e))))),this.publicKey=new ll(t.subjectPublicKeyInfo)}getExtension(e){for(const t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter((t=>"string"==typeof e?t.type===e:t instanceof e))}async verify(e={},t=Pc.get()){let r,i;const s=e.publicKey;try{if(s)if("publicKey"in s)r={...s.publicKey.algorithm,...this.signatureAlgorithm},i=await s.publicKey.export(r,["verify"],t);else if(s instanceof ll)r={...s.algorithm,...this.signatureAlgorithm},i=await s.export(r,["verify"],t);else if(n.vJ.isBufferSource(s)){const e=new ll(s);r={...e.algorithm,...this.signatureAlgorithm},i=await e.export(r,["verify"],t)}else r={...s.algorithm,...this.signatureAlgorithm},i=s;else r={...this.publicKey.algorithm,...this.signatureAlgorithm},i=await this.publicKey.export(r,["verify"],t)}catch(e){return!1}const o=zo.nC.resolveAll(Cl).reverse();let a=null;for(const e of o)if(a=e.toWebSignature(r,this.signature),a)break;if(!a)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const c=await t.subtle.verify(this.signatureAlgorithm,i,a,this.tbs);if(e.signatureOnly)return c;{const t=(e.date||new Date).getTime();return c&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=Pc.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(e=Pc.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){const e=this.toTextObjectEmpty(),t=fr.parse(this.rawData,fn),r=t.tbsCertificate,i=new Cc("",{Version:`${hn[r.version]} (${r.version})`,"Serial Number":r.serialNumber,"Signature Algorithm":Ic.serializeAlgorithm(r.signature),Issuer:this.issuer,Validity:new Cc("",{"Not Before":r.validity.notBefore.getTime(),"Not After":r.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(r.issuerUniqueID&&(i["Issuer Unique ID"]=r.issuerUniqueID),r.subjectUniqueID&&(i["Subject Unique ID"]=r.subjectUniqueID),this.extensions.length){const e=new Cc("");for(const t of this.extensions){const r=t.toTextObject();e[r[Cc.NAME]]=r}i.Extensions=e}return e.Data=i,e.Signature=new Cc("",{Algorithm:Ic.serializeAlgorithm(t.signatureAlgorithm),"":t.signatureValue}),e}}var Rl;Dl.NAME="Certificate",function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(Rl||(Rl={})),ml.register(_r,hl),ml.register(wi,yl),ml.register(ji,dl),ml.register(Gi,gl),ml.register($r,ul),ml.register(_i,vl),ml.register(ci,wl),ml.register(Dr,Al),El.register(va,kl),El.register(ma,Ol),zo.nC.registerSingleton(Cl,class{toAsnSignature(e,t){return n.vJ.toArrayBuffer(t)}toWebSignature(e,t){return n.vJ.toArrayBuffer(t)}}),zo.nC.registerSingleton(Cl,jl),jl.namedCurveSize.set("P-256",32),jl.namedCurveSize.set("K-256",32),jl.namedCurveSize.set("P-384",48),jl.namedCurveSize.set("P-521",66)},53738:(e,t)=>{"use strict";class r{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const i=r.toUint8Array(e),n=r.toUint8Array(t);if(i.length!==n.byteLength)return!1;for(let e=0;e<i.length;e++)if(i[e]!==n[e])return!1;return!0}static concat(...e){let t;t=!Array.isArray(e[0])||e[1]instanceof Function?Array.isArray(e[0])&&e[1]instanceof Function?e[0]:e[e.length-1]instanceof Function?e.slice(0,e.length-1):e:e[0];let r=0;for(const e of t)r+=e.byteLength;const i=new Uint8Array(r);let n=0;for(const e of t){const t=this.toUint8Array(e);i.set(t,n),n+=t.length}return e[e.length-1]instanceof Function?this.toView(i,e[e.length-1]):i.buffer}}const i="string",n=/^[0-9a-f\s]+$/i,s=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,o=/^[a-zA-Z0-9-_]+$/;class a{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){const t=r.toUint8Array(e);let i="";for(let e=0;e<t.length;e++)i+=String.fromCharCode(t[e]);return decodeURIComponent(escape(i))}}class c{static toString(e,t=!1){const i=r.toArrayBuffer(e),n=new DataView(i);let s="";for(let e=0;e<i.byteLength;e+=2){const r=n.getUint16(e,t);s+=String.fromCharCode(r)}return s}static fromString(e,t=!1){const r=new ArrayBuffer(2*e.length),i=new DataView(r);for(let r=0;r<e.length;r++)i.setUint16(2*r,e.charCodeAt(r),t);return r}}class l{static isHex(e){return typeof e===i&&n.test(e)}static isBase64(e){return typeof e===i&&s.test(e)}static isBase64Url(e){return typeof e===i&&o.test(e)}static ToString(e,t="utf8"){const i=r.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(i);case"binary":return this.ToBinary(i);case"hex":return this.ToHex(i);case"base64":return this.ToBase64(i);case"base64url":return this.ToBase64Url(i);case"utf16le":return c.toString(i,!0);case"utf16":case"utf16be":return c.toString(i);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return c.fromString(e,!0);case"utf16":case"utf16be":return c.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=r.toUint8Array(e);if("undefined"!=typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!l.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!l.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=l.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return a.fromString(e);case"utf16":case"utf16be":return c.fromString(e);case"utf16le":case"usc2":return c.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=l.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return a.toString(e);case"utf16":case"utf16be":return c.toString(e);case"utf16le":case"usc2":return c.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);return r.buffer}static ToBinary(e){const t=r.toUint8Array(e);let i="";for(let e=0;e<t.length;e++)i+=String.fromCharCode(t[e]);return i}static ToHex(e){const t=r.toUint8Array(e);let i="";const n=t.length;for(let e=0;e<n;e++){const r=t[e];r<16&&(i+="0"),i+=r.toString(16)}return i}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!l.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const i=t.slice(e,e+2);r[e/2]=parseInt(i,16)}return r.buffer}static ToUtf16String(e,t=!1){return c.toString(e,t)}static FromUtf16String(e,t=!1){return c.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}l.DEFAULT_UTF8_ENCODING="utf8",t.vJ=r,t.ep=l,t.$e=function(...e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),r=new Uint8Array(t);let i=0;return e.map((e=>new Uint8Array(e))).forEach((e=>{for(const t of e)r[i++]=t})),r.buffer},t.Xy=function(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}},87308:(e,t,r)=>{var i;!function(e){!function(t){var i="object"==typeof globalThis?globalThis:"object"==typeof r.g?r.g:"object"==typeof self?self:"object"==typeof this?this:function(){try{return Function("return this;")()}catch(e){}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch(e){}}(),n=s(e);function s(e,t){return function(r,i){Object.defineProperty(e,r,{configurable:!0,writable:!0,value:i}),t&&t(r,i)}}void 0!==i.Reflect&&(n=s(i.Reflect,n)),function(e,t){var r=Object.prototype.hasOwnProperty,i="function"==typeof Symbol,n=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=i&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,c=!o&&!a,l={create:o?function(){return F(Object.create(null))}:a?function(){return F({__proto__:null})}:function(){return F({})},has:c?function(e,t){return r.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return r.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),h="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:function(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var i=this._keys.length,n=r+1;n<i;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,V(t,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,i)},t.prototype.values=function(){return new r(this._keys,this._values,n)},t.prototype.entries=function(){return new r(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[s]=function(){return this.entries()},t.prototype._find=function(e,t){if(!V(this._cacheKey,e)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(V(this._keys[r],e)){this._cacheIndex=r;break}}return this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function n(e,t){return t}function o(e,t){return[e,t]}}(),p="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}(),f="function"==typeof WeakMap?WeakMap:function(){var e=16,t=l.create(),i=n();return function(){function e(){this._key=n()}return e.prototype.has=function(e){var t=s(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=s(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return s(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=s(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=n()},e}();function n(){var e;do{e="@@WeakMap@@"+a()}while(l.has(t,e));return t[e]=!0,e}function s(e,t){if(!r.call(e,i)){if(!t)return;Object.defineProperty(e,i,{value:l.create()})}return e[i]}function o(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(){var t=function(e){if("function"==typeof Uint8Array){var t=new Uint8Array(e);return"undefined"!=typeof crypto?crypto.getRandomValues(t):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(t):o(t,e),t}return o(new Array(e),e)}(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",i=0;i<e;++i){var n=t[i];4!==i&&6!==i&&8!==i||(r+="-"),n<16&&(r+="0"),r+=n.toString(16).toLowerCase()}return r}}(),y=i?Symbol.for("@reflect-metadata:registry"):void 0,d=function(){var e;return!k(y)&&E(t.Reflect)&&Object.isExtensible(t.Reflect)&&(e=t.Reflect[y]),k(e)&&(e=function(){var e,r,i,n;k(y)||void 0===t.Reflect||y in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(e=function(e){var t=e.defineMetadata,r=e.hasOwnMetadata,i=e.getOwnMetadata,n=e.getOwnMetadataKeys,s=e.deleteMetadata,o=new f;return{isProviderFor:function(e,t){var r=o.get(e);return!(k(r)||!r.has(t))||!!n(e,t).length&&(k(r)&&(r=new p,o.set(e,r)),r.add(t),!0)},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:r,OrdinaryGetOwnMetadata:i,OrdinaryOwnMetadataKeys:n,OrdinaryDeleteMetadata:s}}(t.Reflect));var s=new f,o={registerProvider:a,getProvider:l,setProvider:d};return o;function a(t){if(!Object.isExtensible(o))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===t:break;case k(r):r=t;break;case r===t:break;case k(i):i=t;break;case i===t:break;default:void 0===n&&(n=new p),n.add(t)}}function c(t,s){if(!k(r)){if(r.isProviderFor(t,s))return r;if(!k(i)){if(i.isProviderFor(t,s))return r;if(!k(n))for(var o=L(n);;){var a=D(o);if(!a)return;var c=H(a);if(c.isProviderFor(t,s))return R(o),c}}}if(!k(e)&&e.isProviderFor(t,s))return e}function l(e,t){var r,i=s.get(e);return k(i)||(r=i.get(t)),k(r)?(k(r=c(e,t))||(k(i)&&(i=new h,s.set(e,i)),i.set(t,r)),r):r}function u(e){if(k(e))throw new TypeError;return r===e||i===e||!k(n)&&n.has(e)}function d(e,t,r){if(!u(r))throw new Error("Metadata provider not registered.");var i=l(e,t);if(i!==r){if(!k(i))return!1;var n=s.get(e);k(n)&&(n=new h,s.set(e,n)),n.set(t,r)}return!0}}()),!k(y)&&E(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,y,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}(),g=function(e){var t=new f,r={isProviderFor:function(e,r){var i=t.get(e);return!k(i)&&i.has(r)},OrdinaryDefineOwnMetadata:function(e,t,r,n){i(r,n,!0).set(e,t)},OrdinaryHasOwnMetadata:function(e,t,r){var n=i(t,r,!1);return!k(n)&&N(n.has(e))},OrdinaryGetOwnMetadata:function(e,t,r){var n=i(t,r,!1);if(!k(n))return n.get(e)},OrdinaryOwnMetadataKeys:function(e,t){var r=[],n=i(e,t,!1);if(k(n))return r;for(var s=L(n.keys()),o=0;;){var a=D(s);if(!a)return r.length=o,r;var c=H(a);try{r[o]=c}catch(e){try{R(s)}finally{throw e}}o++}},OrdinaryDeleteMetadata:function(e,r,n){var s=i(r,n,!1);if(k(s))return!1;if(!s.delete(e))return!1;if(0===s.size){var o=t.get(r);k(o)||(o.delete(n),0===o.size&&t.delete(o))}return!0}};return d.registerProvider(r),r;function i(i,n,s){var o=t.get(i),a=!1;if(k(o)){if(!s)return;o=new h,t.set(i,o),a=!0}var c=o.get(n);if(k(c)){if(!s)return;if(c=new h,o.set(n,c),!e.setProvider(i,n,r))throw o.delete(n),a&&t.delete(i),new Error("Wrong provider for target.")}return c}}(d);function v(e,t,r){if(m(e,t,r))return!0;var i=M(t);return!O(i)&&v(e,i,r)}function m(e,t,r){var i=$(t,r,!1);return!k(i)&&N(i.OrdinaryHasOwnMetadata(e,t,r))}function b(e,t,r){if(m(e,t,r))return w(e,t,r);var i=M(t);return O(i)?void 0:b(e,i,r)}function w(e,t,r){var i=$(t,r,!1);if(!k(i))return i.OrdinaryGetOwnMetadata(e,t,r)}function A(e,t,r,i){$(r,i,!0).OrdinaryDefineOwnMetadata(e,t,r,i)}function S(e,t){var r=B(e,t),i=M(e);if(null===i)return r;var n=S(i,t);if(n.length<=0)return r;if(r.length<=0)return n;for(var s=new p,o=[],a=0,c=r;a<c.length;a++){var l=c[a];s.has(l)||(s.add(l),o.push(l))}for(var u=0,h=n;u<h.length;u++)l=h[u],s.has(l)||(s.add(l),o.push(l));return o}function B(e,t){var r=$(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function x(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function k(e){return void 0===e}function O(e){return null===e}function E(e){return"object"==typeof e?null!==e:"function"==typeof e}function C(e,t){switch(x(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=P(e,n);if(void 0!==i){var s=i.call(e,r);if(E(s))throw new TypeError;return s}return function(e,t){if("string"===t){var r=e.toString;if(j(r)&&!E(n=r.call(e)))return n;if(j(i=e.valueOf)&&!E(n=i.call(e)))return n}else{var i;if(j(i=e.valueOf)&&!E(n=i.call(e)))return n;var n,s=e.toString;if(j(s)&&!E(n=s.call(e)))return n}throw new TypeError}(e,"default"===r?"number":r)}function N(e){return!!e}function I(e){var t=C(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function T(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function j(e){return"function"==typeof e}function U(e){return"function"==typeof e}function V(e,t){return e===t||e!=e&&t!=t}function P(e,t){var r=e[t];if(null!=r){if(!j(r))throw new TypeError;return r}}function L(e){var t=P(e,s);if(!j(t))throw new TypeError;var r=t.call(e);if(!E(r))throw new TypeError;return r}function H(e){return e.value}function D(e){var t=e.next();return!t.done&&t}function R(e){var t=e.return;t&&t.call(e)}function M(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var r=e.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return t;var n=i.constructor;return"function"!=typeof n||n===e?t:n}function $(e,t,r){var i=d.getProvider(e,t);if(!k(i))return i;if(r){if(d.setProvider(e,t,g))return g;throw new Error("Illegal state.")}}function F(e){return e.__=void 0,delete e.__,e}e("decorate",(function(e,t,r,i){if(k(r)){if(!T(e))throw new TypeError;if(!U(t))throw new TypeError;return function(e,t){for(var r=e.length-1;r>=0;--r){var i=(0,e[r])(t);if(!k(i)&&!O(i)){if(!U(i))throw new TypeError;t=i}}return t}(e,t)}if(!T(e))throw new TypeError;if(!E(t))throw new TypeError;if(!E(i)&&!k(i)&&!O(i))throw new TypeError;return O(i)&&(i=void 0),function(e,t,r,i){for(var n=e.length-1;n>=0;--n){var s=(0,e[n])(t,r,i);if(!k(s)&&!O(s)){if(!E(s))throw new TypeError;i=s}}return i}(e,t,r=I(r),i)})),e("metadata",(function(e,t){return function(r,i){if(!E(r))throw new TypeError;if(!k(i)&&!function(e){switch(x(e)){case 3:case 4:return!0;default:return!1}}(i))throw new TypeError;A(e,t,r,i)}})),e("defineMetadata",(function(e,t,r,i){if(!E(r))throw new TypeError;return k(i)||(i=I(i)),A(e,t,r,i)})),e("hasMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return k(r)||(r=I(r)),v(e,t,r)})),e("hasOwnMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return k(r)||(r=I(r)),m(e,t,r)})),e("getMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return k(r)||(r=I(r)),b(e,t,r)})),e("getOwnMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return k(r)||(r=I(r)),w(e,t,r)})),e("getMetadataKeys",(function(e,t){if(!E(e))throw new TypeError;return k(t)||(t=I(t)),S(e,t)})),e("getOwnMetadataKeys",(function(e,t){if(!E(e))throw new TypeError;return k(t)||(t=I(t)),B(e,t)})),e("deleteMetadata",(function(e,t,r){if(!E(t))throw new TypeError;if(k(r)||(r=I(r)),!E(t))throw new TypeError;k(r)||(r=I(r));var i=$(t,r,!1);return!k(i)&&i.OrdinaryDeleteMetadata(e,t,r)}))}(n,i),void 0===i.Reflect&&(i.Reflect=e)}()}(i||(i={}))}}]);