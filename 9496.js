"use strict";(self.webpackChunkqcloud_shell=self.webpackChunkqcloud_shell||[]).push([[9496],{2787:(e,n,t)=>{t.d(n,{Z:()=>i});var a=t(1864),s=t.n(a),r=t(352),o=t.n(r)()(s());o.push([e.id,"\n.content-area[data-v-cf47f5d4] {\n    overflow-y: scroll;\n    height: 100%;\n}\n.tables-area[data-v-cf47f5d4] {\n    width: 70%;\n    margin-left: 15%;\n    margin-top: 10px;\n}\n.section-area[data-v-cf47f5d4] {\n    margin-bottom: 25px;\n}\n.header-text[data-v-cf47f5d4] {\n    font-weight: bold;\n    margin-bottom: 5px;\n}\n","",{version:3,sources:["webpack://./src/presentation/vue3/pages/systemuser/listusers.vue"],names:[],mappings:";AAuHA;IACI,kBAAkB;IAClB,YAAY;AAChB;AAEA;IACI,UAAU;IACV,gBAAgB;IAChB,gBAAgB;AACpB;AAEA;IACI,mBAAmB;AACvB;AAEA;IACI,iBAAiB;IACjB,kBAAkB;AACtB",sourcesContent:['<script setup lang="ts">\nimport { CreatePromiseData } from "@stechquick/algae/lib/helpers/createPromiseData";\nimport { IUser } from "@stechquick/algae/lib/qCloudTemp/quickCloud";\nimport { defineAsyncComponent, onBeforeMount, onMounted, ref } from "vue";\nimport { container } from "../../../../domain/core/diContainer";\nimport { ILocalization } from "../../../../domain/infrastructure/ILocalization";\nimport { IDialog } from "../../../../domain/presentation/IDialog";\nimport { IRouter, routeDefinition } from "../../../../domain/presentation/IRouter";\nimport { ISystemUserManagement } from "../../../../domain/useCase/ISystemUserManagement";\nimport { IUseCaseExecutor } from "../../../../domain/useCase/IUseCaseExecutor";\nimport { IUserUseCaseImpl } from "../../../../domain/useCase/IUserUseCaseImpl";\n\nrouteDefinition({ noAuth: true });\n\nconst executor = container.resolve<IUseCaseExecutor>(IUseCaseExecutor);\nconst userUseCaseImpl = container.resolve<IUserUseCaseImpl>(IUserUseCaseImpl);\nconst localization = container.resolve<ILocalization>(ILocalization);\nconst router = container.resolve<IRouter>(IRouter);\nconst systemUserManagement = container.resolve<ISystemUserManagement>(ISystemUserManagement);\nconst dialog = container.resolve<IDialog>(IDialog);\n\nconst routerParams = router.getRouteParams<{ dbName?: string }>();\nconst users = ref<Array<IUser>>([]);\n\nlet dtOptions: any = { month: \'2-digit\', day: \'2-digit\', year: \'numeric\', hour: \'numeric\', minute: \'numeric\', second: \'numeric\' };\nconst dtBaseOptions = {\n    filterable: false, perPage: 10, perPageValues: [],\n    sortIcon: { base: \'mdi\', is: \'mdi mdi-unfold-less-horizontal\', up: \'mdi mdi-arrow-up\', down: \'mdi mdi-arrow-down\' },\n};\nconst userDtOptions = {\n    ...dtBaseOptions,\n    headings: {\n        ID: "User ID",\n        name: "User Name",\n        mailAddress: "E-Mail",\n        createdBy: localization.get(\'applicationListcreatedByHeader\'),\n        createDate: localization.get(\'applicationListcreatedDateHeader\'),\n    }\n};\nconst usersDatatableColumns = ref([\'ID\', \'name\', \'mailAddress\', \'createdBy\', \'createDate\', "actions"]);\nconst usersDataTable = ref(userDtOptions);\n\nasync function listUsers() {\n    await executor.execute(async () => {\n        users.value = await userUseCaseImpl.listUsers(routerParams.dbName);\n    }, { loading: true });\n}\n\nasync function deleteUser(userID: string, userName: string) {\n    await executor.execute(async () => {\n        await userUseCaseImpl.deleteUser(userID, userName, routerParams.dbName);\n        await listUsers();\n    }, { loading: true });\n}\n\nconst checkUserProm = CreatePromiseData<void>();\n\nonBeforeMount(async () => {\n    await executor.execute(async () => {\n        await systemUserManagement.checkUser();\n        checkUserProm.resolver();\n    }, { loading: true });\n});\n\nonMounted(async () => {\n    await checkUserProm.promise;\n    await listUsers();\n});\n\nasync function createNewUser() {\n    const closeCb = async (reason: "close" | "outclick" | "component") => {\n        if (reason != "component") { return; }\n        await listUsers();\n    };\n\n    dialog.showDialog(defineAsyncComponent(\n        () => import(`../../components/user/createUser.vue`)),\n        { closable: true, title: "Create User", closeCb },\n        { dbName: routerParams.dbName }\n    );\n}\n\nfunction gotoMainPage() {\n    router.back();\n}\n\n<\/script>\n<template>\n    <div class="content-area">\n        <div class="tables-area">\n            <div class="section-area">\n                <div>\n                    <button @click="gotoMainPage()">Back</button>\n                </div>\n            </div>\n            <div class="section-area">\n                <div class="header-text">\n                    <button @click="createNewUser()" class="btn-new-item">Create New User</button>\n                </div>\n                <div>\n                    <v-client-table ref=\'table\' :data="users" :columns="usersDatatableColumns"\n                        :options="usersDataTable">\n                        <template #createdDate="props">\n                            <span>{{ new Intl.DateTimeFormat("tr-TR", dtOptions).format(new Date(props.row.createDate))\n                            }}</span>\n                        </template>\n                        <template #actions="props">\n                            <div>\n                                <button @click="deleteUser(props.row.ID, props.row.mailAddress)">Delete</button>\n                            </div>\n                        </template>\n                    </v-client-table>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<style scoped>\n.content-area {\n    overflow-y: scroll;\n    height: 100%;\n}\n\n.tables-area {\n    width: 70%;\n    margin-left: 15%;\n    margin-top: 10px;\n}\n\n.section-area {\n    margin-bottom: 25px;\n}\n\n.header-text {\n    font-weight: bold;\n    margin-bottom: 5px;\n}\n</style>'],sourceRoot:""}]);const i=o},9496:(e,n,t)=>{t.r(n),t.d(n,{default:()=>z});var a=t(2068),s=t(9045),r=t(1407),o=t(9185),i=t(3734),c=t(6595),l=t(2455),m=t(5078),d=t(1145),u=t(664),p=t(9690);const g={class:"content-area"},v={class:"tables-area"},I={class:"section-area"},w={class:"section-area"},b={class:"header-text"},f=["onClick"],A=(0,a.aZ)({__name:"listusers",setup(e){(0,m.A)({noAuth:!0});const n=i.nC.resolve(u.y),A=i.nC.resolve(p.h),C=i.nC.resolve(c.w),U=i.nC.resolve(m.v),y=i.nC.resolve(d.H),D=i.nC.resolve(l.u),h=U.getRouteParams(),B=(0,r.iH)([]);let k={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"};const x={filterable:!1,perPage:10,perPageValues:[],sortIcon:{base:"mdi",is:"mdi mdi-unfold-less-horizontal",up:"mdi mdi-arrow-up",down:"mdi mdi-arrow-down"},headings:{ID:"User ID",name:"User Name",mailAddress:"E-Mail",createdBy:C.get("applicationListcreatedByHeader"),createDate:C.get("applicationListcreatedDateHeader")}},P=(0,r.iH)(["ID","name","mailAddress","createdBy","createDate","actions"]),_=(0,r.iH)(x);async function N(){await n.execute((async()=>{B.value=await A.listUsers(h.dbName)}),{loading:!0})}const M=(0,o.X)();return(0,a.wF)((async()=>{await n.execute((async()=>{await y.checkUser(),M.resolver()}),{loading:!0})})),(0,a.bv)((async()=>{await M.promise,await N()})),(e,o)=>{const i=(0,a.up)("v-client-table");return(0,a.wg)(),(0,a.iD)("div",g,[(0,a._)("div",v,[(0,a._)("div",I,[(0,a._)("div",null,[(0,a._)("button",{onClick:o[0]||(o[0]=e=>{U.back()})},"Back")])]),(0,a._)("div",w,[(0,a._)("div",b,[(0,a._)("button",{onClick:o[1]||(o[1]=e=>async function(){D.showDialog((0,a.RC)((()=>t.e(3398).then(t.bind(t,3398)))),{closable:!0,title:"Create User",closeCb:async e=>{"component"==e&&await N()}},{dbName:h.dbName})}()),class:"btn-new-item"},"Create New User")]),(0,a._)("div",null,[(0,a.Wm)(i,{ref:"table",data:B.value,columns:P.value,options:_.value},{createdDate:(0,a.w5)((e=>[(0,a._)("span",null,(0,s.toDisplayString)(new Intl.DateTimeFormat("tr-TR",(0,r.SU)(k)).format(new Date(e.row.createDate))),1)])),actions:(0,a.w5)((e=>[(0,a._)("div",null,[(0,a._)("button",{onClick:t=>async function(e,t){await n.execute((async()=>{await A.deleteUser(e,t,h.dbName),await N()}),{loading:!0})}(e.row.ID,e.row.mailAddress)},"Delete",8,f)])])),_:1},8,["data","columns","options"])])])])])}}});var C=t(5701),U=t.n(C),y=t(8236),D=t.n(y),h=t(6080),B=t.n(h),k=t(6850),x=t.n(k),P=t(7182),_=t.n(P),N=t(9213),M=t.n(N),E=t(2787),R={};R.styleTagTransform=M(),R.setAttributes=x(),R.insert=B().bind(null,"head"),R.domAPI=D(),R.insertStyleElement=_(),U()(E.Z,R),E.Z&&E.Z.locals&&E.Z.locals;const z=(0,t(1419).Z)(A,[["__scopeId","data-v-cf47f5d4"]])}}]);
//# sourceMappingURL=9496.js.map