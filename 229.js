"use strict";(this.webpackChunkqcloud_shell=this.webpackChunkqcloud_shell||[]).push([[229],{17207:(e,t,l)=>{l.d(t,{Z:()=>d});var o=l(8375),n=l.n(o),a=l(7638),s=l.n(a)()(n());s.push([e.id,"\n.disabled[data-v-a6d53568] {\n  opacity: 0.6;\n}\n",""]);const d=s},229:(e,t,l)=>{l.r(t),l.d(t,{default:()=>M});var o=l(71093),n=l(66190),a=l(73843),s=l(5627),d=l(88613),i=l(69700),c=l(38221);const u=(0,o.aZ)({__name:"monacoEditor",props:{lang:String,width:{type:[String,Number],default:"98%"},height:{type:[String,Number],default:"90%"},isReadOnly:{type:Boolean,default:!1}},emits:["onCodePasted","updateUndoRedoState"],setup(e,{expose:t,emit:l}){const s=e;let d;(0,o.bv)((()=>{c.Z.init().then((e=>{const t={automaticLayout:!0,readOnly:s.isReadOnly},o=e.editor.create(document.getElementById("editor"),t);e.editor.EditorOptions,d=()=>o,e.languages.typescript.typescriptDefaults.setCompilerOptions({moduleResolution:e.languages.typescript.ModuleResolutionKind.NodeJs,module:e.languages.typescript.ModuleKind.CommonJS}),o.onDidChangeModelContent((()=>{l("updateUndoRedoState",r(),v())}))}))}));const u=()=>{d().onDidPaste((function(e){l("onCodePasted")}))},r=()=>{var e;return null!==(e=d().getModel().canUndo())&&void 0!==e&&e},v=()=>{var e;return null!==(e=d().getModel().canRedo())&&void 0!==e&&e};(0,o.ic)((()=>{u()}));const g=(0,o.Fl)((()=>{let{width:e,height:t}=s;return{width:e,height:t}}));return t({setMonacoLang:e=>{d()._modelData.model.setLanguage(e)},getCodeValue:()=>d().getValue(),setCodeValue:e=>{d().setValue(e)},setSelections:e=>{d().setSelections(e)},getSelections:()=>d().getSelections(),setScrollTop:e=>{d().setScrollTop(e)},getScrollTop:()=>d().getScrollTop(),insertText:e=>{const t=d();if(!t)return;var l=t.getPosition();const o=l.column,n=l.lineNumber;var a={identifier:{major:1,minor:1},range:new i.e6(n,o,n,o),text:e.text,forceMoveMarkers:!0};t.executeEdits("my-source",[a])},onPasteCode:u,style:g,undo:()=>{d().trigger("keyboard","undo",null)},redo:()=>{d().trigger("keyboard","redo",null)},canUndo:r,canRedo:v}),(0,o.YP)((()=>s.isReadOnly),(e=>{console.log("Watch props.isReadOnly function called with args:",e),d().updateOptions({readOnly:s.isReadOnly})})),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{id:"editor",style:(0,n.normalizeStyle)((0,a.SU)(g))},null,4))}}),r=u,v=(0,o.aZ)({__name:"fileEditor",props:{functions:null,callbacks:null},setup(e){const t=e,l=(0,a.iH)(),i=(0,a.iH)(!0),c=s.nC.resolve(d.J);t.functions.getModel=async()=>{const e=l.value.getScrollTop(),t=l.value.getSelections(),o=l.value.style.width,n=l.value.style.height;return{model:l.value.getCodeValue(),state:{scrollTop:e,selections:t,width:o,height:n,checkout:i.value}}},t.functions.setModel=async(e,t,o)=>{var n,a,s,d;l.value.setMonacoLang(o),l.value.style.width=t.width?t.width:"98%",l.value.style.height=t.height?t.height:"90%",t.scrollTop&&(null===(a=(n=l.value).setScrollTop)||void 0===a||a.call(n,t.scrollTop)),t.selections&&(null===(d=(s=l.value).setSelections)||void 0===d||d.call(s,t.selections)),i.value=!t.checkout||!t.checkout,l.value.style.resize="none",l.value.style.outline="none",l.value.setCodeValue(e)},t.functions.insertText=async(e,o)=>{l.value.insertText({text:e}),t.callbacks.modified({model:!0})},t.functions.undo=()=>{var e;null===(e=l.value)||void 0===e||e.undo()},t.functions.redo=()=>{var e;null===(e=l.value)||void 0===e||e.redo()};const u=(e,t)=>{c.studio.topMenu.dynamicButtons.find((e=>"undo"==e.ID)).disabled=!e,c.studio.topMenu.dynamicButtons.find((e=>"redo"==e.ID)).disabled=!t},v={select:()=>{t.callbacks.modified({state:!0})},scroll:()=>{t.callbacks.modified({state:!0})},change:()=>{t.callbacks.modified({model:!0})},keydown:e=>{const l=e,o=l.code.toLowerCase();l.shiftKey||l.ctrlKey||o.startsWith("arrow")||t.callbacks.modified({model:!0})},resize:()=>{t.callbacks.modified({state:!0})},input:()=>{t.callbacks.modified({model:!0})}},g=e=>{const t=e?l.value.$el.addEventListener:l.value.$el.removeEventListener;Object.keys(v).forEach((e=>t.call(l.value.$el,e,v[e])))};return(0,o.bv)((()=>{g(!0)})),(0,o.Jd)((()=>{g(!1)})),(e,a)=>((0,o.wg)(),(0,o.j4)(r,{ref_key:"editor",ref:l,class:(0,n.normalizeClass)({disabled:i.value}),onOnCodePasted:a[0]||(a[0]=e=>t.callbacks.modified({model:!0})),onUpdateUndoRedoState:u,isReadOnly:i.value},null,8,["class","isReadOnly"]))}});var g=l(17450),p=l.n(g),h=l(29530),m=l.n(h),y=l(16199),f=l.n(y),b=l(40458),k=l.n(b),S=l(62916),w=l.n(S),C=l(92165),O=l.n(C),R=l(17207),T={};T.styleTagTransform=O(),T.setAttributes=k(),T.insert=f().bind(null,"head"),T.domAPI=m(),T.insertStyleElement=w(),p()(R.Z,T),R.Z&&R.Z.locals&&R.Z.locals;const M=(0,l(32525).Z)(v,[["__scopeId","data-v-a6d53568"]])}}]);