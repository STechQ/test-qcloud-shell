"use strict";(this.webpackChunkqcloud_shell=this.webpackChunkqcloud_shell||[]).push([[2073],{48664:(e,t,o)=>{o.d(t,{Z:()=>i});var M=o(34663),l=o.n(M),n=o(7638),s=o.n(n)()(l());s.push([e.id,"\n.disabled[data-v-028792f9] {\n  pointer-events: none;\n  opacity: 0.6;\n}\n","",{version:3,sources:["webpack://./src/presentation/vue3/editors/fileEditor.vue"],names:[],mappings:";AAyEA;EACE,oBAAoB;EACpB,YAAY;AACd",sourcesContent:['<script setup lang="ts">\nimport { onBeforeMount, onBeforeUnmount, onMounted, onUnmounted, onUpdated, Ref, ref, watch } from "vue";\nimport { IFileEditorProps } from "../../../domain/objects/editors/IFileEditor";\nimport MonacoEditor from "./monacoEditor.vue";\n\ninterface IProps {\n  functions: IFileEditorProps["functions"];\n  callbacks: IFileEditorProps["callbacks"];\n}\nconst props = defineProps<IProps>();\nconst editor = ref();\nlet disabled = ref(true);\n\nprops.functions.getModel = async () => {\n  const scrollTop = editor.value.getScrollTop();\n  const selections = editor.value.getSelections();\n  const width = editor.value.style.width;\n  const height = editor.value.style.height;\n  const modelvalue = editor.value.getCodeValue(); \n  return { model: modelvalue, state: { scrollTop, selections, width, height, checkout: disabled.value } };\n};\nprops.functions.setModel = async (model, state, modelLang) => {\n  //model\n  editor.value.setMonacoLang(modelLang);\n  \n  //state\n  editor.value.style.width = state.width ? state.width : "98%";\n  editor.value.style.height = state.height ? state.height : "90%";\n  if(state.scrollTop) editor.value.setScrollTop?.(state.scrollTop);\n  if(state.selections) editor.value.setSelections?.(state.selections);\n  disabled.value = !state.checkout || false;\n  editor.value.style.resize = "none";\n  editor.value.style.outline = "none";\n  editor.value.setCodeValue(model);\n};\nprops.functions.insertText = async (text, position) => {\n  editor.value.insertText({ text: text });\n  props.callbacks.modified({ model: true });\n};\nconst modified: Record<string, EventListenerOrEventListenerObject> = {\n  select: () => { console.log("select"); props.callbacks.modified({ state: true }) },\n  scroll: () => { console.log("scroll"); props.callbacks.modified({ state: true }) },\n  change: () => { console.log("change"); props.callbacks.modified({ model: true }) },\n  keydown: (e: Event) => {\n    const event = e as KeyboardEvent;\n    const code = event.code.toLowerCase();\n    if (event.shiftKey || event.ctrlKey || code.startsWith("arrow")) {\n      return;\n    }\n    console.log("keydown");\n    props.callbacks.modified({ model: true });\n  },\n  resize: () => { console.log("resize"); props.callbacks.modified({ state: true }) },\n  input: () => { console.log("model change"); props.callbacks.modified({ model: true }) },\n};\n\nconst watchTextArea = (attach: boolean) => {\n  const target = attach ? editor.value.$el.addEventListener : editor.value.$el.removeEventListener;\n  Object.keys(modified).forEach(key => target.call(editor.value.$el, key, modified[key]));\n};\n\nonMounted(() => {\n  watchTextArea(true);\n});\nonBeforeUnmount(() => {\n  watchTextArea(false);\n});\n\n<\/script>\n<template>\n  <MonacoEditor ref="editor" :class="{ disabled: disabled }" @onCodePasted="props.callbacks.modified({ model: true })" />\n</template>\n<style scoped>\n.disabled {\n  pointer-events: none;\n  opacity: 0.6;\n}\n</style>'],sourceRoot:""}]);const i=s},85550:(e,t,o)=>{o.r(t),o.d(t,{default:()=>C});var M=o(71093),l=o(66190),n=o(73843),s=o(69700),i=o(38221);const a=(0,M.aZ)({__name:"monacoEditor",props:{lang:String,width:{type:[String,Number],default:"98%"},height:{type:[String,Number],default:"90%"}},emits:["onCodePasted"],setup(e,{expose:t,emit:o}){const a=e;let c;const d=()=>{c().onDidPaste((function(e){o("onCodePasted")}))};(0,M.bv)((()=>{i.Z.init().then((e=>{const t=e.editor.create(document.getElementById("editor"),{automaticLayout:!0});c=()=>t,e.languages.typescript.typescriptDefaults.setCompilerOptions({moduleResolution:e.languages.typescript.ModuleResolutionKind.NodeJs,module:e.languages.typescript.ModuleKind.CommonJS})}))})),(0,M.ic)((()=>{d()}));const A=(0,M.Fl)((()=>{let{width:e,height:t}=a;return{width:e,height:t}}));return t({setMonacoLang:e=>{c()._modelData.model.setLanguage(e)},getCodeValue:()=>c().getValue(),setCodeValue:e=>{c().setValue(e)},setSelections:e=>{c().setSelections(e)},getSelections:()=>c().getSelections(),setScrollTop:e=>{c().setScrollTop(e)},getScrollTop:()=>c().getScrollTop(),insertText:e=>{const t=c();if(!t)return;var o=t.getPosition();const M=o.column<=1?o.lineNumber:o.lineNumber+1;var l={identifier:{major:1,minor:1},range:new s.e6(M,1,M,1),text:e.text,forceMoveMarkers:!0};t.executeEdits("my-source",[l])},onPasteCode:d,style:A}),(e,t)=>((0,M.wg)(),(0,M.iD)("div",{id:"editor",style:(0,l.normalizeStyle)((0,n.SU)(A))},null,4))}}),c=a,d=(0,M.aZ)({__name:"fileEditor",props:{functions:null,callbacks:null},setup(e){const t=e,o=(0,n.iH)();let s=(0,n.iH)(!0);t.functions.getModel=async()=>{const e=o.value.getScrollTop(),t=o.value.getSelections(),M=o.value.style.width,l=o.value.style.height;return{model:o.value.getCodeValue(),state:{scrollTop:e,selections:t,width:M,height:l,checkout:s.value}}},t.functions.setModel=async(e,t,M)=>{var l,n,i,a;o.value.setMonacoLang(M),o.value.style.width=t.width?t.width:"98%",o.value.style.height=t.height?t.height:"90%",t.scrollTop&&(null===(n=(l=o.value).setScrollTop)||void 0===n||n.call(l,t.scrollTop)),t.selections&&(null===(a=(i=o.value).setSelections)||void 0===a||a.call(i,t.selections)),s.value=!t.checkout||!1,o.value.style.resize="none",o.value.style.outline="none",o.value.setCodeValue(e)},t.functions.insertText=async(e,M)=>{o.value.insertText({text:e}),t.callbacks.modified({model:!0})};const i={select:()=>{console.log("select"),t.callbacks.modified({state:!0})},scroll:()=>{console.log("scroll"),t.callbacks.modified({state:!0})},change:()=>{console.log("change"),t.callbacks.modified({model:!0})},keydown:e=>{const o=e,M=o.code.toLowerCase();o.shiftKey||o.ctrlKey||M.startsWith("arrow")||(console.log("keydown"),t.callbacks.modified({model:!0}))},resize:()=>{console.log("resize"),t.callbacks.modified({state:!0})},input:()=>{console.log("model change"),t.callbacks.modified({model:!0})}},a=e=>{const t=e?o.value.$el.addEventListener:o.value.$el.removeEventListener;Object.keys(i).forEach((e=>t.call(o.value.$el,e,i[e])))};return(0,M.bv)((()=>{a(!0)})),(0,M.Jd)((()=>{a(!1)})),(e,i)=>((0,M.wg)(),(0,M.j4)(c,{ref_key:"editor",ref:o,class:(0,l.normalizeClass)({disabled:(0,n.SU)(s)}),onOnCodePasted:i[0]||(i[0]=e=>t.callbacks.modified({model:!0}))},null,8,["class"]))}});var A=o(17450),u=o.n(A),r=o(29530),g=o.n(r),D=o(16199),j=o.n(D),I=o(40458),w=o.n(I),T=o(62916),N=o.n(T),y=o(92165),p=o.n(y),z=o(48664),m={};m.styleTagTransform=p(),m.setAttributes=w(),m.insert=j().bind(null,"head"),m.domAPI=g(),m.insertStyleElement=N(),u()(z.Z,m),z.Z&&z.Z.locals&&z.Z.locals;const C=(0,o(32525).Z)(d,[["__scopeId","data-v-028792f9"]])},94748:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAHUlEQVQYV2PYvXu3JAi7uLiAMaYAjAGTQBPYLQkAa/0Zef3qRswAAAAASUVORK5CYII="},6161:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCA1MyAzNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwKSI+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNDguMDM2NCA0LjAxMDQySDQuMDA3NzlMNC4wMDc3OSAzMi4wMjg2SDQ4LjAzNjRWNC4wMTA0MlpNNC4wMDc3OSAwLjAwNzgxMjVDMS43OTcyMSAwLjAwNzgxMjUgMC4wMDUxODc5OSAxLjc5OTg0IDAuMDA1MTg3OTkgNC4wMTA0MlYzMi4wMjg2QzAuMDA1MTg3OTkgMzQuMjM5MiAxLjc5NzIxIDM2LjAzMTIgNC4wMDc3OSAzNi4wMzEySDQ4LjAzNjRDNTAuMjQ3IDM2LjAzMTIgNTIuMDM5IDM0LjIzOTIgNTIuMDM5IDMyLjAyODZWNC4wMTA0MkM1Mi4wMzkgMS43OTk4NCA1MC4yNDcgMC4wMDc4MTI1IDQ4LjAzNjQgMC4wMDc4MTI1SDQuMDA3NzlaTTguMDEwNDIgOC4wMTMwMkgxMi4wMTNWMTIuMDE1Nkg4LjAxMDQyVjguMDEzMDJaTTIwLjAxODIgOC4wMTMwMkgxNi4wMTU2VjEyLjAxNTZIMjAuMDE4MlY4LjAxMzAyWk0yNC4wMjA4IDguMDEzMDJIMjguMDIzNFYxMi4wMTU2SDI0LjAyMDhWOC4wMTMwMlpNMzYuMDI4NiA4LjAxMzAySDMyLjAyNlYxMi4wMTU2SDM2LjAyODZWOC4wMTMwMlpNNDAuMDMxMiA4LjAxMzAySDQ0LjAzMzlWMTIuMDE1Nkg0MC4wMzEyVjguMDEzMDJaTTE2LjAxNTYgMTYuMDE4Mkg4LjAxMDQyVjIwLjAyMDhIMTYuMDE1NlYxNi4wMTgyWk0yMC4wMTgyIDE2LjAxODJIMjQuMDIwOFYyMC4wMjA4SDIwLjAxODJWMTYuMDE4MlpNMzIuMDI2IDE2LjAxODJIMjguMDIzNFYyMC4wMjA4SDMyLjAyNlYxNi4wMTgyWk00NC4wMzM5IDE2LjAxODJWMjAuMDIwOEgzNi4wMjg2VjE2LjAxODJINDQuMDMzOVpNMTIuMDEzIDI0LjAyMzRIOC4wMTA0MlYyOC4wMjZIMTIuMDEzVjI0LjAyMzRaTTE2LjAxNTYgMjQuMDIzNEgzNi4wMjg2VjI4LjAyNkgxNi4wMTU2VjI0LjAyMzRaTTQ0LjAzMzkgMjQuMDIzNEg0MC4wMzEyVjI4LjAyNkg0NC4wMzM5VjI0LjAyMzRaIiBmaWxsPSIjNDI0MjQyIi8+CjwvZz4KPGRlZnM+CjxjbGlwUGF0aCBpZD0iY2xpcDAiPgo8cmVjdCB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIGZpbGw9IndoaXRlIi8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+Cg=="},51096:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCA1MyAzNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwKSI+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNDguMDM2NCA0LjAxMDQySDQuMDA3NzlMNC4wMDc3OSAzMi4wMjg2SDQ4LjAzNjRWNC4wMTA0MlpNNC4wMDc3OSAwLjAwNzgxMjVDMS43OTcyMSAwLjAwNzgxMjUgMC4wMDUxODc5OSAxLjc5OTg0IDAuMDA1MTg3OTkgNC4wMTA0MlYzMi4wMjg2QzAuMDA1MTg3OTkgMzQuMjM5MiAxLjc5NzIxIDM2LjAzMTIgNC4wMDc3OSAzNi4wMzEySDQ4LjAzNjRDNTAuMjQ3IDM2LjAzMTIgNTIuMDM5IDM0LjIzOTIgNTIuMDM5IDMyLjAyODZWNC4wMTA0MkM1Mi4wMzkgMS43OTk4NCA1MC4yNDcgMC4wMDc4MTI1IDQ4LjAzNjQgMC4wMDc4MTI1SDQuMDA3NzlaTTguMDEwNDIgOC4wMTMwMkgxMi4wMTNWMTIuMDE1Nkg4LjAxMDQyVjguMDEzMDJaTTIwLjAxODIgOC4wMTMwMkgxNi4wMTU2VjEyLjAxNTZIMjAuMDE4MlY4LjAxMzAyWk0yNC4wMjA4IDguMDEzMDJIMjguMDIzNFYxMi4wMTU2SDI0LjAyMDhWOC4wMTMwMlpNMzYuMDI4NiA4LjAxMzAySDMyLjAyNlYxMi4wMTU2SDM2LjAyODZWOC4wMTMwMlpNNDAuMDMxMiA4LjAxMzAySDQ0LjAzMzlWMTIuMDE1Nkg0MC4wMzEyVjguMDEzMDJaTTE2LjAxNTYgMTYuMDE4Mkg4LjAxMDQyVjIwLjAyMDhIMTYuMDE1NlYxNi4wMTgyWk0yMC4wMTgyIDE2LjAxODJIMjQuMDIwOFYyMC4wMjA4SDIwLjAxODJWMTYuMDE4MlpNMzIuMDI2IDE2LjAxODJIMjguMDIzNFYyMC4wMjA4SDMyLjAyNlYxNi4wMTgyWk00NC4wMzM5IDE2LjAxODJWMjAuMDIwOEgzNi4wMjg2VjE2LjAxODJINDQuMDMzOVpNMTIuMDEzIDI0LjAyMzRIOC4wMTA0MlYyOC4wMjZIMTIuMDEzVjI0LjAyMzRaTTE2LjAxNTYgMjQuMDIzNEgzNi4wMjg2VjI4LjAyNkgxNi4wMTU2VjI0LjAyMzRaTTQ0LjAzMzkgMjQuMDIzNEg0MC4wMzEyVjI4LjAyNkg0NC4wMzM5VjI0LjAyMzRaIiBmaWxsPSIjQzVDNUM1Ii8+CjwvZz4KPGRlZnM+CjxjbGlwUGF0aCBpZD0iY2xpcDAiPgo8cmVjdCB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIGZpbGw9IndoaXRlIi8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+Cg=="}}]);
//# sourceMappingURL=2073.js.map?ver=0.0.293_1704290291513